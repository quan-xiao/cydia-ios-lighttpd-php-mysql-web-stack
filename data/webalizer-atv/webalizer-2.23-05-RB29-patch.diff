diff -Naur webalizer-2.23-05//graphs.c webalizer-2.23-05-RB29//graphs.c
--- webalizer-2.23-05//graphs.c	2011-01-03 05:51:06.000000000 +0100
+++ webalizer-2.23-05-RB29//graphs.c	2011-04-19 18:37:55.000000000 +0200
@@ -53,6 +53,9 @@
 #define KBYTECOLOR kbyte_or_red            /* KBytes              */
 #define PAGECOLOR  page_or_cyan            /* Files               */
 #define VISITCOLOR visit_or_yellow         /* Visits              */
+#define CHLEGENDCOLOR  chartlegend         /* chart legend color  */
+#define CHSHADCOLOR1   chartshadow1        /* chart shadow color1 */
+#define CHSHADCOLOR2   chartshadow2        /* chart shadow color2 */
 
 /* shortcuts to convert ASCII hex color for gdImageColorAllocate() */
 
@@ -94,7 +97,8 @@
 /* colors */
 int             black, white, grey, dkgrey, kbyte_or_red,
                 file_or_blue, site_or_orange, hit_or_green,
-                page_or_cyan, visit_or_yellow, blue;
+                page_or_cyan, visit_or_yellow, blue,
+                chartlegend, chartshadow1, chartshadow2, chartbackground;
 
 /*****************************************************************/
 /*                                                               */
@@ -191,13 +195,13 @@
       if (graph_mths<16)
       {
          gdImageString(im,gdFontSmall,ci+((i-s_mth)*cs)+(((cw+co+co)-18)/2)+1,
-                     236,(unsigned char *)s_month[data[i].month-1],black);
+                     236,(unsigned char *)s_month[data[i].month-1],CHLEGENDCOLOR);
       }
       else if (graph_mths<36)
       {
          gdImageChar(im,gdFontSmall,ci+((i-s_mth)*cs)+(((cw+co+co)-6)/2)+1,
                      236,s_month[data[i].month-1][0],
-                     (data[i].month==1)?blue:black);
+                     (data[i].month==1)?blue:CHLEGENDCOLOR);
       }
       else
       {
@@ -212,7 +216,7 @@
                /* format the year string */
                sprintf(maxvaltxt, "%04d", data[i].year);
                gdImageString(im,gdFontSmall,ci+((i-s_mth)*cs)+(j/2)-12,
-                             236, (unsigned char *)maxvaltxt, black);
+                             236, (unsigned char *)maxvaltxt, CHLEGENDCOLOR);
             }
             s_year=data[i].year;
          }
@@ -225,7 +229,7 @@
    if (maxval <= 0) maxval = 1;
    sprintf(maxvaltxt, "%llu", maxval);
    gdImageStringUp(im,gdFontSmall,6,26+(strlen(maxvaltxt)*6),
-                   (unsigned char *)maxvaltxt,black);
+                   (unsigned char *)maxvaltxt,CHLEGENDCOLOR);
 
    /* hits */
    for (i=s_mth; i<HISTSIZE; i++)
@@ -272,7 +276,7 @@
    if (maxval <= 0) maxval = 1;
    sprintf(maxvaltxt, "%llu", maxval);
    gdImageStringUp(im, gdFontSmall,493,26+(strlen(maxvaltxt)*6),
-                   (unsigned char *)maxvaltxt, black);
+                   (unsigned char *)maxvaltxt, CHLEGENDCOLOR);
 
    cs = 180.0/graph_mths; cw = cs/2;
    co = (48/graph_mths<1)?1:48/graph_mths;
@@ -306,10 +310,13 @@
    for (i=s_mth; i<HISTSIZE; i++)
        if (data[i].xfer > fmaxval) fmaxval = data[i].xfer;
    if (fmaxval <= 0.0) fmaxval = 1.0;
-   sprintf(maxvaltxt, "%.0f", fmaxval);
+   sprintf(maxvaltxt, "%s", hr_size(fmaxval*1024));
+   i=strstr(maxvaltxt,"&")-maxvaltxt; /* search for HTML-tag &nbsp;*/
+   memset(maxvaltxt+i,' ',1); /* add space */
+   memcpy(maxvaltxt+i+1,maxvaltxt+i+6,strlen(maxvaltxt)-i); /* remove &nbsp; */
    gdImageStringUp(im, gdFontSmall,493,130+(strlen(maxvaltxt)*6),
-                   (unsigned char *)maxvaltxt,black);
-
+                   (unsigned char *)maxvaltxt,CHLEGENDCOLOR);
+   
    cs = 180.0/graph_mths; cw = (cs/2)+(co/2);
    ci = 308+((cw-co)/2);
 
@@ -355,7 +362,7 @@
 /*                                                               */
 /*****************************************************************/
 
-#define YSIZE 400
+#define YSIZE 500
 
 int month_graph6(     char  *fname,        /* filename           */
                       char  *title,        /* graph title        */
@@ -365,12 +372,14 @@
                  u_int64_t  data2[31],     /* data2 (files)      */
                  u_int64_t  data3[31],     /* data3 (sites)      */
                  double     data4[31],     /* data4 (kbytes)     */
-                 u_int64_t  data5[31],     /* data5 (views)      */
-                 u_int64_t  data6[31])     /* data6 (visits)     */
+                 double     data5[31],     /* data5 (kbytes)     */
+                 double     data6[31],     /* data6 (kbytes)     */
+                 u_int64_t  data7[31],     /* data7 (views)      */
+                 u_int64_t  data8[31])     /* data8 (visits)     */
 {
 
    /* local variables */
-   int         i,j,s,x1,y1,x2;
+   int         i,j,k,x1,y1,x2;
    u_int64_t   maxval=0;
    double      fmaxval=0.0;
 
@@ -378,35 +387,35 @@
    julday = (jdate(1, month,year) % 7);
 
    /* initalize the graph */
-   init_graph(title,512,400);
+   init_graph(title,512,500);
 
-   gdImageLine(im, 21, 180, 490, 180, black); /* draw section lines */
-   gdImageLine(im, 21, 179, 490, 179, white);
-   gdImageLine(im, 21, 280, 490, 280, black);
-   gdImageLine(im, 21, 279, 490, 279, white);
+   gdImageLine(im, 21, 224, 490, 224, black); /* draw section lines */
+   gdImageLine(im, 21, 223, 490, 223, white);
+   gdImageLine(im, 21, 352, 490, 352, black);
+   gdImageLine(im, 21, 351, 490, 351, white);
 
    /* index lines? */
    if (graph_lines)
    {
-      y1=154/(graph_lines+1);
+      y1=204/(graph_lines+1);
       for (i=0;i<graph_lines;i++)
        gdImageLine(im,21,((i+1)*y1)+25,489,((i+1)*y1)+25,dkgrey);
-      y1=100/(graph_lines+1);
+      y1=128/(graph_lines+1);
       for (i=0;i<graph_lines;i++)
-       gdImageLine(im,21,((i+1)*y1)+180,489,((i+1)*y1)+180,dkgrey);
+       gdImageLine(im,21,((i+1)*y1)+224,489,((i+1)*y1)+224,dkgrey);
       for (i=0;i<graph_lines;i++)
-       gdImageLine(im,21,((i+1)*y1)+280,489,((i+1)*y1)+280,dkgrey);
+       gdImageLine(im,21,((i+1)*y1)+352,489,((i+1)*y1)+352,dkgrey);
    }
 
    /* x-axis legend */
    for (i=0;i<31;i++)
    {
       if ((julday % 7 == 6) || (julday % 7 == 0))
-       gdImageString(im,gdFontSmall,25+(i*15),382,
+       gdImageString(im,gdFontSmall,25+(i*15),482,
                      (unsigned char *)numchar[i+1],HITCOLOR);
       else
-       gdImageString(im,gdFontSmall,25+(i*15),382,
-                     (unsigned char *)numchar[i+1],black);
+       gdImageString(im,gdFontSmall,25+(i*15),482,
+                     (unsigned char *)numchar[i+1],CHLEGENDCOLOR);
       julday++;
    }
 
@@ -415,53 +424,83 @@
    {
        if (data1[i] > maxval) maxval = data1[i];           /* get max val    */
        if (data2[i] > maxval) maxval = data2[i];
-       if (data5[i] > maxval) maxval = data5[i];
+       if (data7[i] > maxval) maxval = data7[i];
    }
    if (maxval <= 0) maxval = 1;
    sprintf(maxvaltxt, "%llu", maxval);
    gdImageStringUp(im, gdFontSmall,8,26+(strlen(maxvaltxt)*6),
-                   (unsigned char *)maxvaltxt,black);
+                   (unsigned char *)maxvaltxt,CHLEGENDCOLOR);
 
    if (graph_legend)                           /* Print color coded legends? */
    {
       /* Kbytes Legend */
-      gdImageStringUp(im,gdFontSmall,494,376,
+      i=(strlen(msg_h_xfer)*6);
+      j=(strlen(msg_h_ixfer)*6);
+      k=(strlen(msg_h_oxfer)*6);
+      if (hide_iovol)
+         j=0,k=0; // reset position
+
+      gdImageStringUp(im,gdFontSmall,494,476,
                       (unsigned char *)msg_h_xfer,dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,375,
+      gdImageStringUp(im,gdFontSmall,493,475,
                       (unsigned char *)msg_h_xfer,KBYTECOLOR);
+      if (!hide_iovol)
+      {
+         gdImageStringUp(im,gdFontSmall,494,476-i-3,(unsigned char *)"/",dkgrey);
+         gdImageStringUp(im,gdFontSmall,493,475-i-3,(unsigned char *)"/",black);
+         gdImageStringUp(im,gdFontSmall,494,476-i-12,
+                         (unsigned char *)msg_h_ixfer,dkgrey);
+         gdImageStringUp(im,gdFontSmall,493,475-i-12,
+                         (unsigned char *)msg_h_ixfer,FILECOLOR);
+         gdImageStringUp(im,gdFontSmall,494,476-i-j-15,(unsigned char *)"/",dkgrey);
+         gdImageStringUp(im,gdFontSmall,493,475-i-j-15,(unsigned char *)"/",black);
+         gdImageStringUp(im,gdFontSmall,494,476-i-j-24,
+                         (unsigned char *)msg_h_oxfer,dkgrey);
+         gdImageStringUp(im,gdFontSmall,493,475-i-j-24,
+                         (unsigned char *)msg_h_oxfer,HITCOLOR);
+      }
 
       /* Sites/Visits Legend */
-      i = (strlen(msg_h_sites)*6);
-      gdImageStringUp(im,gdFontSmall,494,276,
+      i = 476-i-j-24-k; // latest position
+      if (hide_iovol)
+        i+=24; // reset position
+
+      j = (strlen(msg_h_sites)*6);
+      k = (strlen(msg_h_visits)*6);
+      gdImageStringUp(im,gdFontSmall,494,i-3,(unsigned char *)"/",dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,i-4,(unsigned char *)"/",black);
+      gdImageStringUp(im,gdFontSmall,494,i-12,
                       (unsigned char *)msg_h_sites,dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,275,
+      gdImageStringUp(im,gdFontSmall,493,i-13,
                       (unsigned char *)msg_h_sites,SITECOLOR);
-      gdImageStringUp(im,gdFontSmall,494,276-i-3,(unsigned char *)"/",dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,275-i-3,(unsigned char *)"/",black);
-      gdImageStringUp(im,gdFontSmall,494,276-i-12,
+      gdImageStringUp(im,gdFontSmall,494,i-j-15,(unsigned char *)"/",dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,i-j-16,(unsigned char *)"/",black);
+      gdImageStringUp(im,gdFontSmall,494,i-j-24,
                       (unsigned char *)msg_h_visits,dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,275-i-12,
+      gdImageStringUp(im,gdFontSmall,493,i-j-25,
                       (unsigned char *)msg_h_visits,VISITCOLOR);
 
       /* Pages/Files/Hits Legend */
-      s = ( i=(strlen(msg_h_pages)*6) )+
-          ( j=(strlen(msg_h_files)*6) )+
-          ( strlen(msg_h_hits)*6 )+ 52;
-      gdImageStringUp(im,gdFontSmall,494,s,
+      i = i-j-24-k; // latest position
+      j = (strlen(msg_h_pages)*6);
+      k = (strlen(msg_h_files)*6);
+      gdImageStringUp(im,gdFontSmall,494,i-3,(unsigned char *)"/",dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,i-4,(unsigned char *)"/",black);
+      gdImageStringUp(im,gdFontSmall,494,i-12,
                       (unsigned char *)msg_h_pages,dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,s-1,
+      gdImageStringUp(im,gdFontSmall,493,i-13,
                       (unsigned char *)msg_h_pages,PAGECOLOR);
-      gdImageStringUp(im,gdFontSmall,494,s-i-3,(unsigned char *)"/",dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,s-i-4,(unsigned char *)"/",black);
-      gdImageStringUp(im,gdFontSmall,494,s-i-12,
+      gdImageStringUp(im,gdFontSmall,494,i-j-15,(unsigned char *)"/",dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,i-j-16,(unsigned char *)"/",black);
+      gdImageStringUp(im,gdFontSmall,494,i-j-24,
                       (unsigned char *)msg_h_files,dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,s-i-13,
+      gdImageStringUp(im,gdFontSmall,493,i-j-25,
                       (unsigned char *)msg_h_files,FILECOLOR);
-      gdImageStringUp(im,gdFontSmall,494,s-i-j-15,(unsigned char *)"/",dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,s-i-j-16,(unsigned char *)"/",black);
-      gdImageStringUp(im,gdFontSmall,494,s-i-j-24,
+      gdImageStringUp(im,gdFontSmall,494,i-j-k-27,(unsigned char *)"/",dkgrey);
+      gdImageStringUp(im,gdFontSmall,493,i-j-k-28,(unsigned char *)"/",black);
+      gdImageStringUp(im,gdFontSmall,494,i-j-k-36,
                       (unsigned char *)msg_h_hits,dkgrey);
-      gdImageStringUp(im,gdFontSmall,493,s-i-j-25,
+      gdImageStringUp(im,gdFontSmall,493,i-j-k-37,
                       (unsigned char *)msg_h_hits,HITCOLOR);
    }
 
@@ -472,9 +511,9 @@
       if (percent <= 0.0) continue;
       x1 = 25 + (i*15);
       x2 = x1 + 7;
-      y1 = 176 - (percent * 147);
-      gdImageFilledRectangle(im, x1, y1, x2, 176, HITCOLOR);
-      gdImageRectangle(im, x1, y1, x2, 176, black);
+      y1 = 220 - (percent * 191);
+      gdImageFilledRectangle(im, x1, y1, x2, 220, HITCOLOR);
+      gdImageRectangle(im, x1, y1, x2, 220, black);
    }
 
    /* data2 */
@@ -484,22 +523,22 @@
       if (percent <= 0.0) continue;
       x1 = 27 + (i*15);
       x2 = x1 + 7;
-      y1 = 176 - (percent * 147);
-      gdImageFilledRectangle(im, x1, y1, x2, 176, FILECOLOR);
-      gdImageRectangle(im, x1, y1, x2, 176, black);
+      y1 = 220 - (percent * 191);
+      gdImageFilledRectangle(im, x1, y1, x2, 220, FILECOLOR);
+      gdImageRectangle(im, x1, y1, x2, 220, black);
    }
 
-   /* data5 */
+   /* data7 */
    for (i=0; i<31; i++)
    {
-      if (data5[i]==0) continue;
-      percent = ((float)data5[i] / (float)maxval);
+      if (data7[i]==0) continue;
+      percent = ((float)data7[i] / (float)maxval);
       if (percent <= 0.0) continue;
       x1 = 29 + (i*15);
       x2 = x1 + 7;
-      y1 = 176 - (percent * 147);
-      gdImageFilledRectangle(im, x1, y1, x2, 176, PAGECOLOR);
-      gdImageRectangle(im, x1, y1, x2, 176, black);
+      y1 = 220 - (percent * 191);
+      gdImageFilledRectangle(im, x1, y1, x2, 220, PAGECOLOR);
+      gdImageRectangle(im, x1, y1, x2, 220, black);
    }
 
    /* sites / visits */
@@ -507,23 +546,23 @@
    for (i=0; i<31; i++)
    {
       if (data3[i]>maxval) maxval = data3[i];
-      if (data6[i]>maxval) maxval = data6[i];
+      if (data8[i]>maxval) maxval = data8[i];
    }
    if (maxval <= 0) maxval = 1;
    sprintf(maxvaltxt, "%llu", maxval);
-   gdImageStringUp(im, gdFontSmall,8,180+(strlen(maxvaltxt)*6),
-                   (unsigned char *)maxvaltxt, black);
+   gdImageStringUp(im, gdFontSmall,8,224+(strlen(maxvaltxt)*6),
+                   (unsigned char *)maxvaltxt, CHLEGENDCOLOR);
    
    /* data 6 */
    for (i=0; i<31; i++)
    {
-      percent = ((float)data6[i] / (float)maxval);
+      percent = ((float)data8[i] / (float)maxval);
       if (percent <= 0.0) continue;
       x1 = 25 + (i*15);
       x2 = x1 + 8;
-      y1 = 276 - (percent * 92);
-      gdImageFilledRectangle(im, x1, y1, x2, 276, VISITCOLOR);
-      gdImageRectangle(im, x1, y1, x2, 276, black);
+      y1 = 348 - (percent * 120);
+      gdImageFilledRectangle(im, x1, y1, x2, 348, VISITCOLOR);
+      gdImageRectangle(im, x1, y1, x2, 348, black);
    }
 
    /* data 3 */
@@ -533,29 +572,66 @@
       if (percent <= 0.0) continue;
       x1 = 29 + (i*15);
       x2 = x1 + 7;
-      y1 = 276 - (percent * 92);
-      gdImageFilledRectangle(im, x1, y1, x2, 276, SITECOLOR);
-      gdImageRectangle(im, x1, y1, x2, 276, black);
+      y1 = 348 - (percent * 120);
+      gdImageFilledRectangle(im, x1, y1, x2, 348, SITECOLOR);
+      gdImageRectangle(im, x1, y1, x2, 348, black);
    }
 
    /* data4 */
    fmaxval=0.0;
-   for (i=0; i<31; i++)
+   for (i=0; i<31; i++){
       if (data4[i]>fmaxval) fmaxval = data4[i];
+      if (!hide_iovol)
+      {
+         if (data5[i]>fmaxval) fmaxval = data5[i];
+         if (data6[i]>fmaxval) fmaxval = data6[i];
+      }
+   }
    if (fmaxval <= 0.0) fmaxval = 1.0;
-   sprintf(maxvaltxt, "%.0f", fmaxval/1024);
-   gdImageStringUp(im, gdFontSmall,8,280+(strlen(maxvaltxt)*6),
-                   (unsigned char *)maxvaltxt, black);
+   sprintf(maxvaltxt, "%s", hr_size(fmaxval));
+   i=strstr(maxvaltxt,"&")-maxvaltxt; /* search for HTML-tag &nbsp;*/
+   memset(maxvaltxt+i,' ',1); /* add space */
+   memcpy(maxvaltxt+i+1,maxvaltxt+i+6,strlen(maxvaltxt)-i); /* remove &nbsp; */
+   gdImageStringUp(im, gdFontSmall,8,352+(strlen(maxvaltxt)*6),
+                   (unsigned char *)maxvaltxt, CHLEGENDCOLOR);
    
+   /* data 4 */
    for (i=0; i<31; i++)
    {
       percent = data4[i] / fmaxval;
       if (percent <= 0.0) continue;
-      x1 = 26 + (i*15);
-      x2 = x1 + 10;
-      y1 = 375 - ( percent * 91 );
-      gdImageFilledRectangle(im, x1, y1, x2, 375, KBYTECOLOR);
-      gdImageRectangle(im, x1, y1, x2, 375, black);
+      x1 = 25 + (i*15);
+      x2 = x1 + 7;
+      y1 = 475 - ( percent * 119 );
+      gdImageFilledRectangle(im, x1, y1, x2, 475, KBYTECOLOR);
+      gdImageRectangle(im, x1, y1, x2, 475, black);
+   }
+
+   if (!hide_iovol)
+   {
+      /* data5 */
+      for (i=0; i<31; i++)
+      {
+         percent = data5[i] / fmaxval;
+         if (percent <= 0.0) continue;
+         x1 = 27 + (i*15);
+         x2 = x1 + 7;
+         y1 = 475 - ( percent * 119 );
+         gdImageFilledRectangle(im, x1, y1, x2, 475, FILECOLOR);
+         gdImageRectangle(im, x1, y1, x2, 475, black);
+      }
+
+      /* data6 */
+      for (i=0; i<31; i++)
+      {
+         percent = data6[i] / fmaxval;
+         if (percent <= 0.0) continue;
+         x1 = 29 + (i*15);
+         x2 = x1 + 7;
+         y1 = 475 - ( percent * 119 );
+         gdImageFilledRectangle(im, x1, y1, x2, 475, HITCOLOR);
+         gdImageRectangle(im, x1, y1, x2, 475, black);
+      }
    }
 
    /* stat the file */
@@ -614,7 +690,7 @@
    for (i=0;i<24;i++)
    {
       gdImageString(im,gdFontSmall,33+(i*19),238,
-                    (unsigned char *)numchar[i],black);
+                    (unsigned char *)numchar[i],CHLEGENDCOLOR);
       if (data1[i] > maxval) maxval = data1[i];           /* get max val    */
       if (data2[i] > maxval) maxval = data2[i];
       if (data3[i] > maxval) maxval = data3[i];
@@ -622,7 +698,7 @@
    if (maxval <= 0) maxval = 1;
    sprintf(maxvaltxt, "%llu", maxval);
    gdImageStringUp(im, gdFontSmall, 8, 26+(strlen(maxvaltxt)*6),
-                   (unsigned char *)maxvaltxt, black);
+                   (unsigned char *)maxvaltxt, CHLEGENDCOLOR);
    
    if (graph_legend)                          /* print color coded legends? */
    {
@@ -764,14 +840,14 @@
          }
 
          gdImageLine(im, CX, CY, gdata.x, gdata.y, black);
-         gdImageFill(im, gdata.mx, gdata.my, i+5);
+         gdImageFill(im, gdata.mx, gdata.my, i+7);
 
 	 snprintf(buffer,sizeof(buffer),"%s (%d%%)",legend[i], percent);
          x=480-(strlen(buffer)*7);
          gdImageString(im,gdFontMediumBold, x+1, y+1,
                        (unsigned char *)buffer, black);
          gdImageString(im,gdFontMediumBold, x, y,
-                       (unsigned char *)buffer, i+5);
+                       (unsigned char *)buffer, i+7);
          y+=20;
       }
    }
@@ -848,12 +924,18 @@
 
    im = gdImageCreate(xsize,ysize);
 
-   /* allocate color maps, background color first (grey) */
-   grey    = gdImageColorAllocate(im, 192, 192, 192);
+   /* allocate color maps, background color first */
+   r=getred(chbg_color); g=getgreen(chbg_color); b=getblue(chbg_color);
+   chartbackground = gdImageColorAllocate(im, r, g, b);
    dkgrey  = gdImageColorAllocate(im, 128, 128, 128);
    black   = gdImageColorAllocate(im, 0, 0, 0);
    white   = gdImageColorAllocate(im, 255, 255, 255);
-   blue    = gdImageColorAllocate(im, 0, 0, 255);
+   r=getred(chlegend_color); g=getgreen(chlegend_color); b=getblue(chlegend_color);
+   chartlegend = gdImageColorAllocate(im, r, g, b);
+   r=getred(chshad_color1); g=getgreen(chshad_color1); b=getblue(chshad_color1);
+   chartshadow1 = gdImageColorAllocate(im, r, g, b);
+   r=getred(chshad_color2); g=getgreen(chshad_color2); b=getblue(chshad_color2);
+   chartshadow2 = gdImageColorAllocate(im, r, g, b);
    r=getred(hit_color); g=getgreen(hit_color); b=getblue(hit_color);
    hit_or_green = gdImageColorAllocate(im, r, g, b);
    r=getred(site_color); g=getgreen(site_color); b=getblue(site_color);
@@ -867,16 +949,18 @@
    r=getred(visit_color); g=getgreen(visit_color); b=getblue(visit_color);
    visit_or_yellow = gdImageColorAllocate(im, r, g, b);
 
+   blue=file_or_blue;           /* currently bound to blue or file color */
+
    /* black outside border */
    gdImageRectangle(im, 0, 0, xsize-1, ysize-1, black);
 
    /* do shadow effect (bevel) border */
-   for (i=1; i<5 ;i++)
+   for (i=1; i<(chart_border+1) ;i++)
    {
-      gdImageLine(im, i, i, xsize-i-2, i, white);
-      gdImageLine(im, i, i, i, ysize-i-2, white);
-      gdImageLine(im, i+1, ysize-i-1, xsize-i-1, ysize-i-1, dkgrey);
-      gdImageLine(im, xsize-i-1, i+1, xsize-i-1, ysize-i-1, dkgrey);
+      gdImageLine(im, i, i, xsize-i-2, i, CHSHADCOLOR1);
+      gdImageLine(im, i, i, i, ysize-i-2, CHSHADCOLOR1);
+      gdImageLine(im, i+1, ysize-i-1, xsize-i-1, ysize-i-1, CHSHADCOLOR2);
+      gdImageLine(im, xsize-i-1, i+1, xsize-i-1, ysize-i-1, CHSHADCOLOR2);
    }
 
    /* generic inside shadow box */
diff -Naur webalizer-2.23-05//graphs.h webalizer-2.23-05-RB29//graphs.h
--- webalizer-2.23-05//graphs.h	2008-06-01 12:39:02.000000000 +0200
+++ webalizer-2.23-05-RB29//graphs.h	2011-04-19 18:37:55.000000000 +0200
@@ -2,7 +2,8 @@
 #define _GRAPHS_H
 
 extern int  month_graph6(char *, char *, int, int, u_int64_t *,
-             u_int64_t *, u_int64_t *, double *, u_int64_t *, u_int64_t *);
+             u_int64_t *, u_int64_t *, double *, double *, double *,
+             u_int64_t *, u_int64_t *);
 extern int  year_graph6x(char *, char *, struct hist_rec *);
 extern int  day_graph3(char *, char *, u_int64_t *, u_int64_t *, u_int64_t *);
 extern int  pie_chart(char *, char *, u_int64_t, u_int64_t *, char **);
diff -Naur webalizer-2.23-05//hashtab.c webalizer-2.23-05-RB29//hashtab.c
--- webalizer-2.23-05//hashtab.c	2011-01-10 02:47:49.000000000 +0100
+++ webalizer-2.23-05-RB29//hashtab.c	2011-04-19 18:37:55.000000000 +0200
@@ -155,6 +155,8 @@
                u_int64_t count, /* hit count */
                u_int64_t file,  /* File flag */
                double    xfer,  /* xfer size */
+               double    ixfer, /* in xfer size */
+               double    oxfer, /* out xfer size */
                u_int64_t *ctr,  /* counter   */
                u_int64_t visit, /* visits    */
                u_int64_t tstamp,/* timestamp */
@@ -177,6 +179,8 @@
          nptr->count = count;
          nptr->files = file;
          nptr->xfer  = xfer;
+         nptr->ixfer = ixfer;
+         nptr->oxfer = oxfer;
          nptr->next  = NULL;
          htab[hval] = nptr;
          if (type!=OBJ_GRP) (*ctr)++;
@@ -222,6 +226,8 @@
                cptr->count+=count;
                cptr->files+=file;
                cptr->xfer +=xfer;
+               cptr->ixfer+=ixfer;
+               cptr->oxfer+=oxfer;
 
                if (ispage(log_rec.url))
                {
@@ -253,6 +259,8 @@
          nptr->count = count;
          nptr->files = file;
          nptr->xfer  = xfer;
+         nptr->ixfer = ixfer;
+         nptr->oxfer = oxfer;
          nptr->next  = htab[hval];
          htab[hval]=nptr;
          if (type!=OBJ_GRP) (*ctr)++;
@@ -361,6 +369,7 @@
 /*********************************************/
 
 int put_unode(char *str, int type, u_int64_t count, double xfer,
+              double ixfer, double oxfer,
               u_int64_t *ctr, u_int64_t entry, u_int64_t exit, UNODEPTR *htab)
 {
    UNODEPTR cptr,nptr;
@@ -378,6 +387,8 @@
          nptr->flag = type;
          nptr->count= count;
          nptr->xfer = xfer;
+         nptr->ixfer= ixfer;
+         nptr->oxfer= oxfer;
          nptr->next = NULL;
          nptr->entry= entry;
          nptr->exit = exit;
@@ -397,6 +408,8 @@
                /* found... bump counter */
                cptr->count+=count;
                cptr->xfer += xfer;
+               cptr->ixfer+= ixfer;
+               cptr->oxfer+= oxfer;
                return 0;
             }
          }
@@ -408,6 +421,8 @@
          nptr->flag = type;
          nptr->count= count;
          nptr->xfer = xfer;
+         nptr->ixfer= ixfer;
+         nptr->oxfer= oxfer;
          nptr->next = htab[hval];
          nptr->entry= entry;
          nptr->exit = exit;
@@ -846,6 +861,8 @@
                u_int64_t count, /* hit count */
                u_int64_t file,  /* File flag */
                double    xfer,  /* xfer size */
+               double    ixfer, /* in xfer size */
+               double    oxfer, /* out xfer size */
                u_int64_t *ctr,  /* counter   */
                u_int64_t visit, /* visits    */
                u_int64_t tstamp,/* timestamp */
@@ -867,6 +884,8 @@
          nptr->count = count;
          nptr->files = file;
          nptr->xfer  = xfer;
+         nptr->ixfer = ixfer;
+         nptr->oxfer = oxfer;
          nptr->next  = NULL;
          htab[hval] = nptr;
          if (type!=OBJ_GRP) (*ctr)++;
@@ -896,6 +915,8 @@
                cptr->count+=count;
                cptr->files+=file;
                cptr->xfer +=xfer;
+               cptr->ixfer+=ixfer;
+               cptr->oxfer+=oxfer;
 
                if (ispage(log_rec.url))
                {
@@ -915,6 +936,8 @@
          nptr->count = count;
          nptr->files = file;
          nptr->xfer  = xfer;
+         nptr->ixfer = ixfer;
+         nptr->oxfer = oxfer;
          nptr->next  = htab[hval];
          htab[hval]  = nptr;
          if (type!=OBJ_GRP) (*ctr)++;
diff -Naur webalizer-2.23-05//hashtab.h webalizer-2.23-05-RB29//hashtab.h
--- webalizer-2.23-05//hashtab.h	2008-05-22 10:14:30.000000000 +0200
+++ webalizer-2.23-05-RB29//hashtab.h	2011-04-19 18:37:55.000000000 +0200
@@ -32,6 +32,8 @@
            u_int64_t tstamp;
                 char *lasturl;
               double xfer;
+              double ixfer;
+              double oxfer;
               struct hnode *next; };
 
 struct unode {  char *string;              /* url hash table structure     */
@@ -41,6 +43,8 @@
            u_int64_t entry;                /* entry page counter           */
            u_int64_t exit;                 /* exit page counter            */
               double xfer;                 /* xfer size in bytes           */
+              double ixfer;                /* in xfer size in bytes        */
+              double oxfer;                /* out xfer size in bytes       */
               struct unode *next; };       /* pointer to next node         */
 
 struct rnode {  char *string;              /* referrer hash table struct   */
@@ -64,6 +68,8 @@
            u_int64_t visit;
            u_int64_t tstamp;
               double xfer;
+              double ixfer;
+              double oxfer;
               struct inode *next; };
 
 extern HNODEPTR sm_htab[MAXHASH];             /* hash tables               */
@@ -77,11 +83,11 @@
 extern DNODEPTR host_table[MAXHASH];          /* DNS resolver table        */
 #endif
 
-extern int    put_hnode(char *, int, u_int64_t, u_int64_t, double,
+extern int    put_hnode(char *, int, u_int64_t, u_int64_t, double, double, double,
                         u_int64_t *, u_int64_t, u_int64_t, char *, HNODEPTR *);
-extern int    put_unode(char *, int, u_int64_t, double, u_int64_t *,
-                        u_int64_t, u_int64_t, UNODEPTR *);
-extern int    put_inode(char *, int, u_int64_t, u_int64_t, double,
+extern int    put_unode(char *, int, u_int64_t, double, double, double,
+                        u_int64_t *, u_int64_t, u_int64_t, UNODEPTR *);
+extern int    put_inode(char *, int, u_int64_t, u_int64_t, double, double, double,
                         u_int64_t *, u_int64_t, u_int64_t, INODEPTR *);
 extern int    put_rnode(char *, int, u_int64_t, u_int64_t *, RNODEPTR *);
 extern int    put_anode(char *, int, u_int64_t, u_int64_t *, ANODEPTR *);
diff -Naur webalizer-2.23-05//lang/webalizer_lang.albanian webalizer-2.23-05-RB29//lang/webalizer_lang.albanian
--- webalizer-2.23-05//lang/webalizer_lang.albanian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.albanian	2011-04-19 18:45:55.425095316 +0200
@@ -183,6 +183,7 @@
 char *msg_main_sum= "PÃ«rmbledhje sipas Muajsh";
 char *msg_main_da = "Mes. Ditore";
 char *msg_main_mt = "TÃ«rÃ«si PÃ«rmujore";
+char *msg_main_ar = "Statistikat e arkivuara";
 
 /* month HTML page strings */
 char *msg_hmth_du = "PÃ«rdorim ditor pÃ«r";
@@ -202,7 +203,9 @@
 char *msg_h_visits= "Vizita";
 char *msg_h_files = "Kartela";
 char *msg_h_sites = "\"Site\"-e";
-char *msg_h_xfer  = "KBajt";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "EmÃ«rstrehÃ«";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Agjent PÃ«rdoruesi";
@@ -212,6 +215,8 @@
 char *msg_h_uname = "EmÃ«r PÃ«rdoruesi";
 
 /* lidhje pÃ«rgjatÃ« kryesh faqeje */
+char *msg_hlnk_in = "Faqja kryesore";
+char *msg_hlnk_nf = "Kodi 404";
 char *msg_hlnk_ds = "Statistika Ditore";
 char *msg_hlnk_hs = "Statistika Ã§do OrÃ«";
 char *msg_hlnk_u  = "URL-ra";
@@ -228,7 +233,9 @@
 char *msg_mtot_ms = "Statistika Mujore pÃ«r";
 char *msg_mtot_th = "Hapje Gjithsej";
 char *msg_mtot_tf = "Kartela Gjithsej";
-char *msg_mtot_tx = "KBajt Gjithsej";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "\"Site\"-e UnikÃ« Gjithsej";
 char *msg_mtot_ur = "PÃ«rmendÃ«sa UnikÃ« Gjithsej";
 char *msg_mtot_ua = "AgjentÃ« UnikÃ« PÃ«rdoruesi Gjithsej";
@@ -240,7 +247,9 @@
 char *msg_mtot_mpd= "Faqe nÃ« DitÃ«";
 char *msg_mtot_msd= "\"Site\"-e nÃ« DitÃ«";
 char *msg_mtot_mvd= "Vizita nÃ« DitÃ«";
-char *msg_mtot_mkd= "KBajt nÃ« DitÃ«";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Hapje sipas Kodi PÃ«rgjigjesh";
 
 /* tabelÃ« tÃ«rÃ«sie ditore */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.arabic webalizer-2.23-05-RB29//lang/webalizer_lang.arabic
--- webalizer-2.23-05//lang/webalizer_lang.arabic	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.arabic	2011-04-19 18:45:55.429094984 +0200
@@ -1,4 +1,4 @@
-/*
+ï»¿/*
    webalizer_lang.english
 
    Webalizer V2.0x Language Support file for English.
@@ -201,6 +201,7 @@
 char *msg_main_sum= "Ø§Ù„Ù…Ù„Ø®Øµ Ø­Ø³Ø¨ Ø§Ù„Ø´Ù‡Ø±";
 char *msg_main_da = "Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ";
 char *msg_main_mt = "Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Ø§Ù„Ø¥Ø³ØªØ¹Ù…Ø§Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù  ";
@@ -220,7 +221,9 @@
 char *msg_h_visits= "Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª";
 char *msg_h_files = "Ø§Ù„Ù…Ù„ÙØ§Øª";
 char *msg_h_sites = "Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹";
-char *msg_h_xfer  = "ÙƒÙŠÙ„Ùˆ Ø¨Ø§ÙŠØª";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Ø¥Ø³Ù… Ø§Ù„Ù…Ø¶ÙŠÙ";
 char *msg_h_url   = "Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆØ±Ø¯ Ø§Ù„Ù…Ù†ØªØ¸Ù… URL";
 char *msg_h_agent = "Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…";
@@ -230,6 +233,8 @@
 char *msg_h_uname = "Ø¥Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©";
 char *msg_hlnk_hs = "Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø³Ø§Ø¹Ø©";
 char *msg_hlnk_u  = "Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ù…Ù†ØªØ¸Ù…Ø© URLs";
@@ -246,7 +251,9 @@
 char *msg_mtot_ms = "Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ© Ù„Ù ";
 char *msg_mtot_th = "Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¥ØµØ§Ø¨Ø§Øª";
 char *msg_mtot_tf = "Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª";
-char *msg_mtot_tx = "Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙŠÙ„Ùˆ Ø¨Ø§ÙŠØª";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ù†ÙØ±Ø¯Ø©";
 char *msg_mtot_ur = "Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø­ÙˆÙ„ÙŠÙ† Ø§Ù„Ù…Ù†ÙØ±Ø¯Ø©";
 char *msg_mtot_ua = "Ù…Ø¬Ù…ÙˆØ¹ Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ù†ÙØ±Ø¯Ø©";
@@ -258,7 +265,9 @@
 char *msg_mtot_mpd= "Ø§Ù„ØµÙØ­Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ…";
 char *msg_mtot_msd= "Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ…";
 char *msg_mtot_mvd= "Ø§Ù„Ø²ÙŠØ§Ø±Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ…";
-char *msg_mtot_mkd= "ÙƒÙŠÙ„Ùˆ Ø¨Ø§ÙŠØª ÙÙŠ Ø§Ù„ÙŠÙˆÙ…";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Ø§Ù„Ø¥ØµØ§Ø¨Ø§Øª Ø­Ø³Ø¨ Ø±Ù…Ø² Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.catalan webalizer-2.23-05-RB29//lang/webalizer_lang.catalan
--- webalizer-2.23-05//lang/webalizer_lang.catalan	2011-04-15 07:46:44.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.catalan	2011-04-19 18:45:55.429094984 +0200
@@ -205,6 +205,7 @@
 char *msg_main_sum= "Resum per mesos";
 char *msg_main_da = "Mitjana diària";
 char *msg_main_mt = "Totals del mes";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Ús diari per a";
@@ -224,7 +225,9 @@
 char *msg_h_visits= "Visites";
 char *msg_h_files = "Fitxers";
 char *msg_h_sites = "Navegadors";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Visitant";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Navegador";
@@ -234,6 +237,8 @@
 char *msg_h_uname = "Nom d'usuari";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Estadístiques diàries";
 char *msg_hlnk_hs = "Estadístiques horàries";
 char *msg_hlnk_u  = "URLs";
@@ -262,7 +267,9 @@
 char *msg_mtot_mpd= "Pàgines per dia";
 char *msg_mtot_msd= "Servidors per dia";
 char *msg_mtot_mvd= "Visites per dia";
-char *msg_mtot_mkd= "KBytes per dia";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Accessos segons codi de resposta";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.chinese webalizer-2.23-05-RB29//lang/webalizer_lang.chinese
--- webalizer-2.23-05//lang/webalizer_lang.chinese	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.chinese	2011-04-19 18:45:55.433095129 +0200
@@ -199,6 +199,7 @@
 char *msg_main_sum= "¨C¤ë·JÁ`²Î­p";
 char *msg_main_da = "¨C¤é¥­§¡";
 char *msg_main_mt = "¨C¤ëÁ`­p";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Daily usage for";
@@ -218,7 +219,9 @@
 char *msg_h_visits= "Visits";
 char *msg_h_files = "ÀÉ®×";
 char *msg_h_sites = "ºô¯¸¼Æ";
-char *msg_h_xfer  = "¶Ç°e¶q¡]KB¡^";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "¥D¾÷¦WºÙ";
 char *msg_h_url   = "ºô­¶¸ô®|";
 char *msg_h_agent = "ÂsÄı¾¹";
@@ -228,6 +231,8 @@
 char *msg_h_uname = "Username";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "¨C¤é²Î­p";
 char *msg_hlnk_hs = "¨C¤p®É²Î­p";
 char *msg_hlnk_u  = "ºô­¶¸ô®|";
@@ -244,7 +249,9 @@
 char *msg_mtot_ms = "¨C¤ë²Î­p--";
 char *msg_mtot_th = "Á`Åª¨ú¼Æ";
 char *msg_mtot_tf = "Á`ÀÉ®×¼Æ";
-char *msg_mtot_tx = "Á`¶Ç°e¶q¡]KB¡^";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "¨Ó·½ºô¯¸Á`¼Æ¡]¤£¥]§t­«ÂĞªÌ¡^";
 char *msg_mtot_ur = "¨Ó·½ºô­¶Á`¼Æ¡]¤£¥]§t­«ÂĞªÌ¡^";
 char *msg_mtot_ua = "¨Ó·½ÂsÄı¾¹Á`¼Æ¡]¤£¥]§t­«ÂĞªÌ¡^";
@@ -256,7 +263,9 @@
 char *msg_mtot_mpd= "Pages per Day";
 char *msg_mtot_msd= "Sites per Day";
 char *msg_mtot_mvd= "Visits per Day";
-char *msg_mtot_mkd= "KBytes per Day";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "ºô­¶Åª¨ú®É¤§¦^À³¥N½X";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.croatian webalizer-2.23-05-RB29//lang/webalizer_lang.croatian
--- webalizer-2.23-05//lang/webalizer_lang.croatian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.croatian	2011-04-19 18:45:55.433095129 +0200
@@ -196,6 +196,7 @@
 char *msg_main_sum= "Pregled po mjesecima";
 char *msg_main_da = "Dnevni prosjek";
 char *msg_main_mt = "Mjesecni zbrojevi";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Pristupi po danu za";
@@ -215,7 +216,9 @@
 char *msg_h_visits= "Posjeta";
 char *msg_h_files = "Datoteka";
 char *msg_h_sites = "Kompjutera";
-char *msg_h_xfer  = "KB";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Kompjuter";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Korisnicki program";
@@ -225,6 +228,8 @@
 char *msg_h_uname = "Korisnik";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Dnevna statistika";
 char *msg_hlnk_hs = "Statistika po satu";
 char *msg_hlnk_u  = "URL-ovi";
@@ -241,7 +246,9 @@
 char *msg_mtot_ms = "Mjesecna statistika za";
 char *msg_mtot_th = "Ukupno pristupa";
 char *msg_mtot_tf = "Ukupno datoteka";
-char *msg_mtot_tx = "Ukupno KBajta";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Ukupno razlicitih kompjutera";
 char *msg_mtot_ur = "Ukupno razlicitih referiranja";
 char *msg_mtot_ua = "Ukupno razlicitih browsera";
@@ -253,7 +260,9 @@
 char *msg_mtot_mpd= "Datoteka na sat";
 char *msg_mtot_msd= "Kompjutera na dan";
 char *msg_mtot_mvd= "Posjeta na dan";
-char *msg_mtot_mkd= "KBajta na dan";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Pristupa po kodu";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.czech webalizer-2.23-05-RB29//lang/webalizer_lang.czech
--- webalizer-2.23-05//lang/webalizer_lang.czech	2009-04-30 09:04:36.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.czech	2011-04-19 18:45:55.437094139 +0200
@@ -207,6 +207,7 @@
 char *msg_main_sum= "Mìsíèní pøehled";
 char *msg_main_da = "Denní prùmìr";
 char *msg_main_mt = "Mìsíèní souèty";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Denní vyu¾ití za";
@@ -226,7 +227,9 @@
 char *msg_h_visits= "Náv¹tìv";
 char *msg_h_files = "Souborù";
 char *msg_h_sites = "Míst";
-char *msg_h_xfer  = "KBytù";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Poèítaè";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Prohlí¾eè";
@@ -236,6 +239,8 @@
 char *msg_h_uname = "U¾ivatel";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Denní statistiky";
 char *msg_hlnk_hs = "Hodinové statistiky";
 char *msg_hlnk_u  = "URL";
@@ -252,7 +257,9 @@
 char *msg_mtot_ms = "Mìsíèní statistiky za";
 char *msg_mtot_th = "Celkem náv¹tìv";
 char *msg_mtot_tf = "Celkem souborù";
-char *msg_mtot_tx = "Celkem KBytù";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Celkem jedineènıch míst";
 char *msg_mtot_ur = "Celkem jedineènıch odkazovaèù";
 char *msg_mtot_ua = "Celkem jedineènıch Prohlí¾eèù";
@@ -264,7 +271,9 @@
 char *msg_mtot_mpd= "Stránek za den";
 char *msg_mtot_msd= "Míst za den";
 char *msg_mtot_mvd= "Náv¹tìv za den";
-char *msg_mtot_mkd= "KBytù za den";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Náv¹tìvy podle kódu odpovìdi";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.danish webalizer-2.23-05-RB29//lang/webalizer_lang.danish
--- webalizer-2.23-05//lang/webalizer_lang.danish	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.danish	2011-04-19 18:45:55.437094139 +0200
@@ -199,6 +199,7 @@
 char *msg_main_sum= "Opsummering / måned";
 char *msg_main_da = "Dagligt gennemsnit";
 char *msg_main_mt = "Sammenlagt pr. måned";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Daglig tilgang -";
@@ -218,7 +219,9 @@
 char *msg_h_visits= "Besøg";
 char *msg_h_files = "Filer";
 char *msg_h_sites = "Gæster";
-char *msg_h_xfer  = "kB";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Navn/IP-adresse";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Browser";
@@ -228,6 +231,8 @@
 char *msg_h_uname = "Username";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Daglig statistik";
 char *msg_hlnk_hs = "Timestatistik";
 char *msg_hlnk_u  = "URL";
@@ -244,7 +249,9 @@
 char *msg_mtot_ms = "Månedlig statistik for";
 char *msg_mtot_th = "Forespørgsler";
 char *msg_mtot_tf = "Filer";
-char *msg_mtot_tx = "kB";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Unikke gæster";
 char *msg_mtot_ur = "Unikke henvisende sider";
 char *msg_mtot_ua = "Unikke browsere";
@@ -256,7 +263,9 @@
 char *msg_mtot_mpd= "Sider pr. dag";
 char *msg_mtot_msd= "Gæster pr. dag";
 char *msg_mtot_mvd= "Besøg pr. dag";
-char *msg_mtot_mkd= "kB pr. dag";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Forespørgsler fordelt på svarkoder";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.dutch webalizer-2.23-05-RB29//lang/webalizer_lang.dutch
--- webalizer-2.23-05//lang/webalizer_lang.dutch	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.dutch	2011-04-19 18:45:55.441094591 +0200
@@ -215,6 +215,7 @@
 char *msg_main_sum= "Samenvatting per maand";
 char *msg_main_da = "Dagelijks gemiddelde";
 char *msg_main_mt = "Totalen per maand";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Dagelijks bezoek -";
@@ -234,7 +235,9 @@
 char *msg_h_visits= "Bezoeken";
 char *msg_h_files = "Bestanden";
 char *msg_h_sites = "Hosts";
-char *msg_h_xfer  = "kB"; /* afgekort i.v.m. onderschrift grafiek */
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Host(naam)";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Browser";
@@ -244,6 +247,8 @@
 char *msg_h_uname = "Gebruikersnaam";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Overzicht per dag";
 char *msg_hlnk_hs = "Overzicht per uur";
 char *msg_hlnk_u  = "URL's";
@@ -260,7 +265,9 @@
 char *msg_mtot_ms = "Maandoverzicht -";
 char *msg_mtot_th = "Totaal hits";
 char *msg_mtot_tf = "Totaal bestanden";
-char *msg_mtot_tx = "Totaal kilobytes";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Totaal verschillende hosts";
 char *msg_mtot_ur = "Totaal verschillende verwijzers";
 char *msg_mtot_ua = "Totaal verschillende browsers";
@@ -272,7 +279,9 @@
 char *msg_mtot_mpd= "Pagina's per dag";
 char *msg_mtot_msd= "Hosts per dag";
 char *msg_mtot_mvd= "Bezoeken per dag";
-char *msg_mtot_mkd= "Kilobytes per dag";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Hits per 'Response Code'";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.english webalizer-2.23-05-RB29//lang/webalizer_lang.english
--- webalizer-2.23-05//lang/webalizer_lang.english	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.english	2011-04-19 18:45:55.441094591 +0200
@@ -200,6 +200,7 @@
 char *msg_main_sum= "Summary by Month";
 char *msg_main_da = "Daily Avg";
 char *msg_main_mt = "Monthly Totals";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Daily usage for";
@@ -219,7 +220,9 @@
 char *msg_h_visits= "Visits";
 char *msg_h_files = "Files";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Hostname";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "User Agent";
@@ -229,6 +232,8 @@
 char *msg_h_uname = "Username";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Daily Statistics";
 char *msg_hlnk_hs = "Hourly Statistics";
 char *msg_hlnk_u  = "URLs";
@@ -245,7 +250,9 @@
 char *msg_mtot_ms = "Monthly Statistics for";
 char *msg_mtot_th = "Total Hits";
 char *msg_mtot_tf = "Total Files";
-char *msg_mtot_tx = "Total KBytes";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Total Unique Sites";
 char *msg_mtot_ur = "Total Unique Referrers";
 char *msg_mtot_ua = "Total Unique User Agents";
@@ -257,7 +264,9 @@
 char *msg_mtot_mpd= "Pages per Day";
 char *msg_mtot_msd= "Sites per Day";
 char *msg_mtot_mvd= "Visits per Day";
-char *msg_mtot_mkd= "KBytes per Day";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Hits by Response Code";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.estonian webalizer-2.23-05-RB29//lang/webalizer_lang.estonian
--- webalizer-2.23-05//lang/webalizer_lang.estonian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.estonian	2011-04-19 18:45:55.445094691 +0200
@@ -199,6 +199,7 @@
 char *msg_main_sum= "Kokkuvõtted kuude kaupa";
 char *msg_main_da = "Päeva keskm.";
 char *msg_main_mt = "Kuu kokku";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Kasutuspäevad";
@@ -218,7 +219,9 @@
 char *msg_h_visits= "Külastusi";
 char *msg_h_files = "Faile";
 char *msg_h_sites = "Arvuteid";
-char *msg_h_xfer  = "KBaite";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Server";
 char *msg_h_url   = "Aadress";
 char *msg_h_agent = "Lehitseja";
@@ -228,6 +231,8 @@
 char *msg_h_uname = "Username";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Päevade statistika";
 char *msg_hlnk_hs = "Tundide statistika";
 char *msg_hlnk_u  = "Aadressid";
@@ -244,7 +249,9 @@
 char *msg_mtot_ms = "Kuu statistika";
 char *msg_mtot_th = "Kokku Pöördumisi";
 char *msg_mtot_tf = "Kokku Faile";
-char *msg_mtot_tx = "Kokku KBaite";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Kokku Erinevaid Kasutajaid";
 char *msg_mtot_ur = "Kokku Erinevaid Viitajaid";
 char *msg_mtot_ua = "Kokku Erinevaid Lehitsejaid";
@@ -256,7 +263,9 @@
 char *msg_mtot_mpd= "Lehekülgi Päevas";
 char *msg_mtot_msd= "Külastajaarvutist Päevas";
 char *msg_mtot_mvd= "Visiite Päevas";
-char *msg_mtot_mkd= "KBaite Päevas";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Pöördumisi vastusetüüpide kaupa";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.finnish webalizer-2.23-05-RB29//lang/webalizer_lang.finnish
--- webalizer-2.23-05//lang/webalizer_lang.finnish	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.finnish	2011-04-19 18:45:55.445094691 +0200
@@ -207,6 +207,7 @@
 char *msg_main_sum= "Kuukausittainen yhteenveto";
 char *msg_main_da = "Päivien keskiarvo";
 char *msg_main_mt = "Yhteensä kuukaudessa";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Päivittäinen käyttö";
@@ -226,7 +227,9 @@
 char *msg_h_visits= "vierailuja";
 char *msg_h_files = "tiedostoja";
 char *msg_h_sites = "koneita";
-char *msg_h_xfer  = "kilotavuja";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Välityspalvelin";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Käytetyt selaimet";
@@ -236,6 +239,8 @@
 char *msg_h_uname = "Käyttäjänimi";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Päivätilastot";
 char *msg_hlnk_hs = "Tuntitilastot";
 char *msg_hlnk_u  = "URL:t";
@@ -252,7 +257,9 @@
 char *msg_mtot_ms = "Kuukausitilastot";
 char *msg_mtot_th = "Osumia yhteensä";
 char *msg_mtot_tf = "Tiedostoja yhteensä";
-char *msg_mtot_tx = "Kilotavuja yhteensä";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Yhteensä erilaisia koneita";
 char *msg_mtot_ur = "Yhteensä erilaisia hakupalvelimia";
 char *msg_mtot_ua = "Yhteensä erilaisia selaimia";
@@ -264,7 +271,9 @@
 char *msg_mtot_mpd= "Sivuja / päivä";
 char *msg_mtot_msd= "Koneita / päivä";
 char *msg_mtot_mvd= "Vierailuja / päivä";
-char *msg_mtot_mkd= "Kilotavuja / päivä";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Osumien vastauskoodit";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.french webalizer-2.23-05-RB29//lang/webalizer_lang.french
--- webalizer-2.23-05//lang/webalizer_lang.french	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.french	2011-04-19 18:45:55.449094899 +0200
@@ -234,6 +234,7 @@
 char *msg_main_sum= "R&eacute;sum&eacute; par mois";
 char *msg_main_da = "Moyenne journali&egrave;re";
 char *msg_main_mt = "Totaux mensuels";
+char *msg_main_ar = "Statistiques archiv&eacute;es";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Acces journalier pour";
@@ -253,7 +254,9 @@
 char *msg_h_visits= "Visites";
 char *msg_h_files = "Fichiers";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "Ko";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Nom d'h&ocirc;te";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Navigateur";
@@ -263,6 +266,8 @@
 char *msg_h_uname = "Utilisateur";
 
 /* links along top of page */
+char *msg_hlnk_in = "Page d'accueil";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Statistiques journali&egrave;res";
 char *msg_hlnk_hs = "Statistiques horaires";
 char *msg_hlnk_u  = "URLs";
@@ -279,7 +284,9 @@
 char *msg_mtot_ms = "Statistiques mensuelles pour";
 char *msg_mtot_th = "Total des Hits";
 char *msg_mtot_tf = "Total des Fichiers";
-char *msg_mtot_tx = "Total des Ko";
+char *msg_mtot_tx = "Total des volumes";
+char *msg_mtot_ix = "Total des vol. In";
+char *msg_mtot_ox = "Total des vol. Out";
 char *msg_mtot_us = "Total des Sites uniques";
 char *msg_mtot_ur = "Total des R&eacute;f&eacute;rents uniques";
 char *msg_mtot_ua = "Total des Navigateurs";
@@ -291,7 +298,9 @@
 char *msg_mtot_mpd= "Pages par Jour";
 char *msg_mtot_msd= "Sites par Jour";
 char *msg_mtot_mvd= "Visites par Jour";
-char *msg_mtot_mkd= "KOctets par Jour";
+char *msg_mtot_mkd= "Volume par Jour";
+char *msg_mtot_ikd= "Vol. In par Jour";
+char *msg_mtot_okd= "Vol. Out par Jour";
 char *msg_mtot_rc = "Hits par code de r&eacute;ponse";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.galician webalizer-2.23-05-RB29//lang/webalizer_lang.galician
--- webalizer-2.23-05//lang/webalizer_lang.galician	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.galician	2011-04-19 18:45:55.449094899 +0200
@@ -204,6 +204,7 @@
 char *msg_main_sum= "Resumo por meses";
 char *msg_main_da = "Medía díaria";
 char *msg_main_mt = "Totais mensuais";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Uso díario en";
@@ -223,7 +224,9 @@
 char *msg_h_visits= "Visitas";
 char *msg_h_files = "Arquivos";
 char *msg_h_sites = "Clientes";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Máquina";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Programa cliente";
@@ -233,6 +236,8 @@
 char *msg_h_uname = "Username";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Estatísiticas díarias";
 char *msg_hlnk_hs = "Estatísticas por horas";
 char *msg_hlnk_u  = "URLs";
@@ -249,7 +254,9 @@
 char *msg_mtot_ms = "Estatísticas mensuais de";
 char *msg_mtot_th = "Total Accesos";
 char *msg_mtot_tf = "Total Arquivos";
-char *msg_mtot_tx = "Total KBytes";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Total Clientes";
 char *msg_mtot_ur = "Total Ligazóns orixe";
 char *msg_mtot_ua = "Total Programas visores";
@@ -261,7 +268,9 @@
 char *msg_mtot_mpd= "Páxinas por Día";
 char *msg_mtot_msd= "Clientes por Día";
 char *msg_mtot_mvd= "Visitas por Día";
-char *msg_mtot_mkd= "KBytes por Día";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Accesos por código de resposta";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.german webalizer-2.23-05-RB29//lang/webalizer_lang.german
--- webalizer-2.23-05//lang/webalizer_lang.german	2008-07-05 20:42:27.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.german	2011-04-19 18:45:55.453094646 +0200
@@ -223,6 +223,7 @@
 char *msg_main_sum= "Zusammenfassung nach Monaten";
 char *msg_main_da = "Tagesdurchschnitt";
 char *msg_main_mt = "Monats-Summe";
+char *msg_main_ar = "Archivierte Statistiken";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Tages-Statistik im Monat";
@@ -243,7 +244,9 @@
 char *msg_h_visits= "Besuche";
 char *msg_h_files = "Dateien";
 char *msg_h_sites = "Rechner";
-char *msg_h_xfer  = "kb";
+char *msg_h_xfer  = "Volumen";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Rechnername";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Anwenderprogramm";
@@ -253,6 +256,8 @@
 char *msg_h_uname = "Benutzer";
 
 /* links along top of page */
+char *msg_hlnk_in = "Hauptseite";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Tages-Statistik";
 char *msg_hlnk_hs = "Stunden-Statistik";
 char *msg_hlnk_u  = "URLs";
@@ -269,7 +274,9 @@
 char *msg_mtot_ms = "Monats-Statistik f&uuml;r";
 char *msg_mtot_th = "Summe der Anfragen";
 char *msg_mtot_tf = "Summe der Dateien";
-char *msg_mtot_tx = "Summe in kb";
+char *msg_mtot_tx = "Summe Volumen";
+char *msg_mtot_ix = "Summe Vol. In";
+char *msg_mtot_ox = "Summe Vol. Out";
 char *msg_mtot_us = "Summe der unterschiedlichen Rechner (IP-Adressen)";
 char *msg_mtot_ur = "Summe der unterschiedlichen Verweise";
 char *msg_mtot_ua = "Summe der unterschiedlichen Anwenderprogramme";
@@ -281,7 +288,9 @@
 char *msg_mtot_mpd= "Seiten pro Tag";
 char *msg_mtot_msd= "Rechner (IP-Adressen) pro Tag";
 char *msg_mtot_mvd= "Besuche pro Tag";
-char *msg_mtot_mkd= "kb pro Tag";
+char *msg_mtot_mkd= "Volumen pro Tag";
+char *msg_mtot_ikd= "Vol. In pro Tag";
+char *msg_mtot_okd= "Vol. Out pro Tag";
 char *msg_mtot_rc = "Anfragen nach Status-Codes";
 
 /* daily total table */
@@ -343,8 +352,8 @@
          { "Code 205 - L&ouml;sche Inhalt",                                                 0 },
          { "Code 206 - Unvollst&auml;ndiger Inhalt",                                        0 },
          { "Code 300 - Mehrere Auswahlm&ouml;glichkeiten",                                  0 },
-         { "Code 301 - Die Seite wurde dauerhaft an einen andere Stelle verlegt",           0 },
-         { "Code 302 - Die Seite wurde an einer anderer Stelle gefunden",                   0 },
+         { "Code 301 - Die Seite wurde dauerhaft an eine andere Stelle verlegt",            0 },
+         { "Code 302 - Die Seite wurde an einer anderen Stelle gefunden",                   0 },
          { "Code 303 - Hole die Seite von einer anderen Position",                          0 },
          { "Code 304 - Die Seite wurde nicht ge&auml;ndert",                                0 },
          { "Code 305 - Die Benutzung des Proxys ist erforderlich",                          0 },
diff -Naur webalizer-2.23-05//lang/webalizer_lang.greek webalizer-2.23-05-RB29//lang/webalizer_lang.greek
--- webalizer-2.23-05//lang/webalizer_lang.greek	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.greek	2011-04-19 18:45:55.453094646 +0200
@@ -198,6 +198,7 @@
 char *msg_main_sum= "ÓõãêåíôñùôéêÜ óôïé÷åßá áíÜ ìŞíá";
 char *msg_main_da = "Ìİóïé üñïé áíÜ çìİñá";
 char *msg_main_mt = "Ìçíéáßá óıíïëá";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Óôïé÷åßá áíÜ çìİñá ãéá: ";
@@ -217,7 +218,9 @@
 char *msg_h_visits= "Åğéóêİøåéò";
 char *msg_h_files = "Áñ÷åßá";
 char *msg_h_sites = "ÓõóôŞìáôá";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Óıóôçìá";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Ğñüãñáììá";
@@ -227,6 +230,8 @@
 char *msg_h_uname = "Username";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "ÁíÜ çìİñá";
 char *msg_hlnk_hs = "ÁíÜ şñá";
 char *msg_hlnk_u  = "URLs";
@@ -243,7 +248,9 @@
 char *msg_mtot_ms = "ÓõãêåíôñùôéêÜ óôïé÷åßá ãéá ôï ìŞíá";
 char *msg_mtot_th = "ÓõíïëéêÜ Hits";
 char *msg_mtot_tf = "Óıíïëï áñ÷åßùí";
-char *msg_mtot_tx = "Óıíïëï KBytes";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Óıíïëï äéáöïñåôéêşí óõóôçìÜôùí";
 char *msg_mtot_ur = "Óıíïëï äéáöïñåôéêşí áíáöåñüíôùí";
 char *msg_mtot_ua = "Óıíïëï äéáöïñåôéêşí ğñïãñáììÜôùí";
@@ -255,7 +262,9 @@
 char *msg_mtot_mpd= "Óåëßäåò áíÜ çìİñá";
 char *msg_mtot_msd= "Sites per Day";
 char *msg_mtot_mvd= "Åğéóêİøåéò áíÜ çìİñá";
-char *msg_mtot_mkd= "KBytes áíÜ çìİñá";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Hits áğü ôï áğïôİëåóìá";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.hungarian webalizer-2.23-05-RB29//lang/webalizer_lang.hungarian
--- webalizer-2.23-05//lang/webalizer_lang.hungarian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.hungarian	2011-04-19 18:45:55.457094583 +0200
@@ -205,6 +205,7 @@
 char *msg_main_sum= "Havi összefoglalás";
 char *msg_main_da = "Napi átlag";
 char *msg_main_mt = "Havi összegzés";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Napi használat:";
@@ -224,7 +225,9 @@
 char *msg_h_visits= "Látogatók";
 char *msg_h_files = "File-ok";
 char *msg_h_sites = "Oldalak";
-char *msg_h_xfer  = "KByte";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Hostnév";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Felhasználó böngészõje";
@@ -234,6 +237,8 @@
 char *msg_h_uname = "Felhasználónév";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Napi Statisztika";
 char *msg_hlnk_hs = "Óránkénti Statisztika";
 char *msg_hlnk_u  = "URLs";
@@ -250,7 +255,9 @@
 char *msg_mtot_ms = "Havi Statisztika:";
 char *msg_mtot_th = "Összes Találat";
 char *msg_mtot_tf = "Összes File";
-char *msg_mtot_tx = "Összes KByte";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Összes különbözõ Oldal";
 char *msg_mtot_ur = "Összes különbözõ Hivatkozás";
 char *msg_mtot_ua = "Összes különbözõ Felhasználó böngészõje";
@@ -262,7 +269,9 @@
 char *msg_mtot_mpd= "Lap/nap";
 char *msg_mtot_msd= "Oldal/nap";
 char *msg_mtot_mvd= "Látogató/nap";
-char *msg_mtot_mkd= "KByte/nap";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Válaszkódok általi találatok";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.icelandic webalizer-2.23-05-RB29//lang/webalizer_lang.icelandic
--- webalizer-2.23-05//lang/webalizer_lang.icelandic	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.icelandic	2011-04-19 18:45:55.461094144 +0200
@@ -207,6 +207,7 @@
 char *msg_main_sum= "Yfirlit eftir mánuğum";
 char *msg_main_da = "Dags meğaltal";
 char *msg_main_mt = "Samtals á mánuği";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Notkun á dag fyrir";
@@ -226,7 +227,9 @@
 char *msg_h_visits= "Heimsóknir";
 char *msg_h_files = "Skrár";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBæti";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Host nafn";
 char *msg_h_url   = "Slóğ";
 char *msg_h_agent = "User Agent";
@@ -236,6 +239,8 @@
 char *msg_h_uname = "Notandanafn";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Daglegar samtölur";
 char *msg_hlnk_hs = "Klukkustundar samtölur";
 char *msg_hlnk_u  = "Slóğir";
@@ -252,7 +257,9 @@
 char *msg_mtot_ms = "Mánağar Samtölur fyrir";
 char *msg_mtot_th = "Samtals Beiğnir";
 char *msg_mtot_tf = "Samtals Skrár";
-char *msg_mtot_tx = "Samtals KBæti";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Samtals Einstakar Síğur";
 char *msg_mtot_ur = "Samtals Unique Referrers";
 char *msg_mtot_ua = "Samtals Unique User Agents";
@@ -264,7 +271,9 @@
 char *msg_mtot_mpd= "Síğur á Dag";
 char *msg_mtot_msd= "Síğur (sites) á Dag";
 char *msg_mtot_mvd= "Heimsóknir á Dag";
-char *msg_mtot_mkd= "KBæti á Dag";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Hits by Response Code";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.indonesian webalizer-2.23-05-RB29//lang/webalizer_lang.indonesian
--- webalizer-2.23-05//lang/webalizer_lang.indonesian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.indonesian	2011-04-19 18:45:55.461094144 +0200
@@ -203,6 +203,7 @@
 char *msg_main_sum= "Ringkasan berdasarkan bulan";
 char *msg_main_da = "Rata-rata harian";
 char *msg_main_mt = "Total bulanan";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Pengaksesan harian untuk";
@@ -222,7 +223,9 @@
 char *msg_h_visits= "Kunjungan";
 char *msg_h_files = "File";
 char *msg_h_sites = "Situs";
-char *msg_h_xfer  = "KByte";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Nama Host";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Browser/User Agent";
@@ -232,6 +235,8 @@
 char *msg_h_uname = "Username";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Statistik harian";
 char *msg_hlnk_hs = "Statistik per jam";
 char *msg_hlnk_u  = "URL";
@@ -248,7 +253,9 @@
 char *msg_mtot_ms = "Statistik bulanan untuk";
 char *msg_mtot_th = "Jumlah Hit";
 char *msg_mtot_tf = "Jumlah File";
-char *msg_mtot_tx = "Jumlah KByte";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Jumlah Situs unik";
 char *msg_mtot_ur = "Jumlah Acuan unik";
 char *msg_mtot_ua = "Jumlah Browser unik";
@@ -260,7 +267,9 @@
 char *msg_mtot_mpd= "Halaman per hari";
 char *msg_mtot_msd= "Situs per hari";
 char *msg_mtot_mvd= "Kunjungan per hari";
-char *msg_mtot_mkd= "KByte per hari";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Hit oleh kode respon";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.italian webalizer-2.23-05-RB29//lang/webalizer_lang.italian
--- webalizer-2.23-05//lang/webalizer_lang.italian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.italian	2011-04-19 18:45:55.465093199 +0200
@@ -202,6 +202,7 @@
 char *msg_main_sum= "Riepilogo mensile";
 char *msg_main_da = "Media giornaliera";
 char *msg_main_mt = "Totale mensile";
+char *msg_main_ar = "Rapporti archiviati";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Contatti giornalieri per";
@@ -221,7 +222,9 @@
 char *msg_h_visits= "Visite";
 char *msg_h_files = "File";
 char *msg_h_sites = "Siti";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Nomi di Host";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Browser";
@@ -231,6 +234,8 @@
 char *msg_h_uname = "Username";
 
 /* links along top of page */
+char *msg_hlnk_in = "Pagina Principale";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Statistiche Giornaliere";
 char *msg_hlnk_hs = "Statistiche Orarie";
 char *msg_hlnk_u  = "URL";
@@ -247,7 +252,9 @@
 char *msg_mtot_ms = "Statistiche Mensili per";
 char *msg_mtot_th = "Contatti";
 char *msg_mtot_tf = "File";
-char *msg_mtot_tx = "KBytes";
+char *msg_mtot_tx = "Totale Volume";
+char *msg_mtot_ix = "Totale Vol. In";
+char *msg_mtot_ox = "Totale Vol. Out";
 char *msg_mtot_us = "Nomi di Host";
 char *msg_mtot_ur = "Referrer";
 char *msg_mtot_ua = "Browser";
@@ -259,7 +266,9 @@
 char *msg_mtot_mpd= "Pagine Giornaliere";
 char *msg_mtot_msd= "Host Giornaliere";
 char *msg_mtot_mvd= "Visite Giornaliere";
-char *msg_mtot_mkd= "KBytes Giornalieri";
+char *msg_mtot_mkd= "Volume Giornalieri";
+char *msg_mtot_ikd= "Vol. In Giornalieri";
+char *msg_mtot_okd= "Vol. Out Giornalieri";
 char *msg_mtot_rc = "Contatti per Codice di Risposta";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.japanese webalizer-2.23-05-RB29//lang/webalizer_lang.japanese
--- webalizer-2.23-05//lang/webalizer_lang.japanese	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.japanese	2011-04-19 18:45:55.465093199 +0200
@@ -196,6 +196,7 @@
 char *msg_main_sum= "·î¤ÎÅı·×";
 char *msg_main_da = "°ìÆü¤¢¤¿¤ê¤ÎÊ¿¶Ñ";
 char *msg_main_mt = "·î¹ç·×";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Daily usage for";
@@ -215,7 +216,9 @@
 char *msg_h_visits= "Visits";
 char *msg_h_files = "Files";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "¥Û¥¹¥ÈÌ¾";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "¥æ¡¼¥¶¥¨¡¼¥¸¥§¥ó¥È";
@@ -225,6 +228,8 @@
 char *msg_h_uname = "¥æ¡¼¥¶Ì¾";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Æü¤´¤È¤ÎÅı·×";
 char *msg_hlnk_hs = "»ş´Ö¤´¤È¤ÎÅı·×";
 char *msg_hlnk_u  = "URL";
@@ -241,7 +246,9 @@
 char *msg_mtot_ms = "·î¤ÎÅı·×";
 char *msg_mtot_th = "Á´¥Ò¥Ã¥È¿ô";
 char *msg_mtot_tf = "Á´¥Õ¥¡¥¤¥ë¿ô";
-char *msg_mtot_tx = "Á´ KBytes¿ô";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "¸ÄÊÌ¥µ¥¤¥È¿ô";
 char *msg_mtot_ur = "¸ÄÊÌ¥ê¥Õ¥¡¥é¡¼¿ô";
 char *msg_mtot_ua = "¸ÄÊÌ¥æ¡¼¥¶¥¨¡¼¥¸¥§¥ó¥È¿ô";
@@ -253,7 +260,9 @@
 char *msg_mtot_mpd= "°ìÆü¤¢¤¿¤ê¤Î¥Ú¡¼¥¸¿ô";
 char *msg_mtot_msd= "Sites per Day";
 char *msg_mtot_mvd= "°ìÆü¤¢¤¿¤ê¤ÎË¬Ìä¼Ô¿ô";
-char *msg_mtot_mkd= "°ìÆü¤¢¤¿¤ê¤ÎKBytes¿ô";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "¥ì¥¹¥İ¥ó¥¹¥³¡¼¥É¤´¤È¤Î¥Ò¥Ã¥È¿ô";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.korean webalizer-2.23-05-RB29//lang/webalizer_lang.korean
--- webalizer-2.23-05//lang/webalizer_lang.korean	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.korean	2011-04-19 18:45:55.469094110 +0200
@@ -200,6 +200,7 @@
 char *msg_main_sum= "ÃÖÁ¾ 12°³¿ù";
 char *msg_main_da = "ÀÏ Æò±Õ";
 char *msg_main_mt = "¿ù ÃÑ°è";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Daily usage for";
@@ -219,7 +220,9 @@
 char *msg_h_visits= "Visits";
 char *msg_h_files = "Files";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "È£½ºÆ®¸í";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "¿¡ÀÌÀüÆ®";
@@ -229,6 +232,8 @@
 char *msg_h_uname = "Username";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "ÀÏº° Åë°è";
 char *msg_hlnk_hs = "½Ã°£´ëº° Åë°è";
 char *msg_hlnk_u  = "URL";
@@ -245,7 +250,9 @@
 char *msg_mtot_ms = "¿ùº° Åë°è";
 char *msg_mtot_th = "ÃÑ È÷Æ®¼ö";
 char *msg_mtot_tf = "ÃÑ ÆÄÀÏ¼ö";
-char *msg_mtot_tx = "ÃÑ KByte";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "ÃÑ °³º° »çÀÌÆ®";
 char *msg_mtot_ur = "ÃÑ °³º° ·¹ÆÛ·²";
 char *msg_mtot_ua = "ÃÑ °³º° ¿¡ÀÌÀüÆ®";
@@ -257,7 +264,9 @@
 char *msg_mtot_mpd= "Pages per Day";
 char *msg_mtot_msd= "Sites per Day";
 char *msg_mtot_mvd= "Visits per Day";
-char *msg_mtot_mkd= "KBytes per Day";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "ÀÀ´ä ÄÚµåº° È÷Æ®¼ö";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.latvian webalizer-2.23-05-RB29//lang/webalizer_lang.latvian
--- webalizer-2.23-05//lang/webalizer_lang.latvian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.latvian	2011-04-19 18:45:55.469094110 +0200
@@ -201,6 +201,7 @@
 char *msg_main_sum= "Pârskati par mçneğiem";
 char *msg_main_da = "Ikdienas pârskati";
 char *msg_main_mt = "Mçneğu kopsummas";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Dienas pârskati par ";
@@ -220,7 +221,9 @@
 char *msg_h_visits= "Apmeklçjumi";
 char *msg_h_files = "Faili";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Hostname";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Lietotâja programma";
@@ -230,6 +233,8 @@
 char *msg_h_uname = "Lietotâja vârds";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Dienas statistika";
 char *msg_hlnk_hs = "Stundu statistika";
 char *msg_hlnk_u  = "URL's";
@@ -246,7 +251,9 @@
 char *msg_mtot_ms = "Mçneğu pârskats pâr";
 char *msg_mtot_th = "Kopçjie Apmeklçjumi";
 char *msg_mtot_tf = "Kopçjie Faili";
-char *msg_mtot_tx = "Kopçjie KBaiti";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Kopçjâs Unikâlâs Saites";
 char *msg_mtot_ur = "Kopçjie Unikâlie Referreri";
 char *msg_mtot_ua = "Kopçjâs Unikâlâs Lietotâju Programmas";
@@ -258,7 +265,9 @@
 char *msg_mtot_mpd= "Lapas Dienâ";
 char *msg_mtot_msd= "Saites Dienâ";
 char *msg_mtot_mvd= "Apmeklçjumi Dienâ";
-char *msg_mtot_mkd= "KBaiti Dienâ";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Hits by Response Code";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.lithuanian webalizer-2.23-05-RB29//lang/webalizer_lang.lithuanian
--- webalizer-2.23-05//lang/webalizer_lang.lithuanian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.lithuanian	2011-04-19 18:45:55.473094281 +0200
@@ -195,6 +195,7 @@
 char *msg_main_sum= "Sàvadas pagal mënesius";
 char *msg_main_da = "Dieninis vidurkis";
 char *msg_main_mt = "Mënesio suminis";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Dieninis naudojimas";
@@ -214,7 +215,9 @@
 char *msg_h_visits= "Apsilankymø";
 char *msg_h_files = "Rinkmenø";
 char *msg_h_sites = "Tinklalapiø";
-char *msg_h_xfer  = "KBaitø";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Kompiuterio vardas";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Kliento programa";
@@ -224,6 +227,8 @@
 char *msg_h_uname = "Vartotojo vardas";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Dieninë statistika";
 char *msg_hlnk_hs = "Valandinë statistika";
 char *msg_hlnk_u  = "URL";
@@ -240,7 +245,9 @@
 char *msg_mtot_ms = "Mënesinë statistika";
 char *msg_mtot_th = "Viso jungèiø";
 char *msg_mtot_tf = "Viso rinkmenø";
-char *msg_mtot_tx = "Viso KBaitø";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Viso unikaliø puslapiø";
 char *msg_mtot_ur = "Viso unikaliø nukreipëjø";
 char *msg_mtot_ua = "Viso unikaliø klientø programø";
@@ -252,7 +259,9 @@
 char *msg_mtot_mpd= "Puslapiø per dienà";
 char *msg_mtot_msd= "Puslapiø (sites) per dienà";
 char *msg_mtot_mvd= "Apsilankymø per dienà";
-char *msg_mtot_mkd= "KBaitø per dienà";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Jungèiø pagal atsako kodà";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.malay webalizer-2.23-05-RB29//lang/webalizer_lang.malay
--- webalizer-2.23-05//lang/webalizer_lang.malay	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.malay	2011-04-19 18:45:55.473094281 +0200
@@ -201,6 +201,7 @@
 char *msg_main_sum= "Ringkasan Bulanan";
 char *msg_main_da = "Purata harian";
 char *msg_main_mt = "Jumlah Bulanan";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Pengunaan Harian bagi";
@@ -220,7 +221,9 @@
 char *msg_h_visits= "Lawatan";
 char *msg_h_files = "Fail";
 char *msg_h_sites = "Halaman";
-char *msg_h_xfer  = "KBait";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Nama Hos";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Agen Pengguna";
@@ -230,6 +233,8 @@
 char *msg_h_uname = "Katanama";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Statistik Harian";
 char *msg_hlnk_hs = "Statistik ikut Jam";
 char *msg_hlnk_u  = "URL";
@@ -246,7 +251,9 @@
 char *msg_mtot_ms = "Statistik Bulanan Untuk";
 char *msg_mtot_th = "Jumlah Capaian";
 char *msg_mtot_tf = "Jumlah Fail";
-char *msg_mtot_tx = "Jumlah KBait";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Jumlah Halaman Unik";
 char *msg_mtot_ur = "Jumlah Perujuk Unik";
 char *msg_mtot_ua = "Jumlah Agen Pengguna Unik";
@@ -258,7 +265,9 @@
 char *msg_mtot_mpd= "Purata Halaman Sehari";
 char *msg_mtot_msd= "Sites per Day";
 char *msg_mtot_mvd= "Purata Lawatan Sehari";
-char *msg_mtot_mkd= "Purata KBait Sehari";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Purata Capaian mengikut Kod Respon";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.norwegian webalizer-2.23-05-RB29//lang/webalizer_lang.norwegian
--- webalizer-2.23-05//lang/webalizer_lang.norwegian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.norwegian	2011-04-19 18:45:55.477094162 +0200
@@ -212,6 +212,7 @@
 char *msg_main_sum= "Summering måned for måned";
 char *msg_main_da = "Snitt over dagen";
 char *msg_main_mt = "Summer pr. måned";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Daglig bruk for";
@@ -231,7 +232,9 @@
 char *msg_h_visits= "Besøk";
 char *msg_h_files = "Filer";
 char *msg_h_sites = "Klientadresser";
-char *msg_h_xfer  = "kilobyte";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Servernavn";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Klienttype";
@@ -241,6 +244,8 @@
 char *msg_h_uname = "Brukernavn";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Daglig statistikkk";
 char *msg_hlnk_hs = "Statistikkk time for time";
 char *msg_hlnk_u  = "URLer";
@@ -257,7 +262,9 @@
 char *msg_mtot_ms = "Månedlig statistikk for";
 char *msg_mtot_th = "Totalt antall treff";
 char *msg_mtot_tf = "Totalt antall filer";
-char *msg_mtot_tx = "Totalt antall kilobytes";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Totalt antall unike klientadresser";
 char *msg_mtot_ur = "Totalt antall unike henvisninger";
 char *msg_mtot_ua = "Totalt antall unike klienttyper";
@@ -269,7 +276,9 @@
 char *msg_mtot_mpd= "Sider per dag";
 char *msg_mtot_msd= "Klientadresser per dag";
 char *msg_mtot_mvd= "Besök per dag";
-char *msg_mtot_mkd= "Kilobytes per dag";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Treff sortert etter responskode";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.polish webalizer-2.23-05-RB29//lang/webalizer_lang.polish
--- webalizer-2.23-05//lang/webalizer_lang.polish	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.polish	2011-04-19 18:45:55.477094162 +0200
@@ -207,6 +207,7 @@
 char *msg_main_sum= "Sumarycznie w miesi±cu:";
 char *msg_main_da = "¦rednio dziennie";
 char *msg_main_mt = "Ogólnie w miesi±cu: ";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Raport Dzienny - ";
@@ -226,7 +227,9 @@
 char *msg_h_visits= "Wizyty";
 char *msg_h_files = "Pliki";
 char *msg_h_sites = "Lokalizacje";
-char *msg_h_xfer  = "KB";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Nazwa hosta";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Przegl±darka";
@@ -236,6 +239,8 @@
 char *msg_h_uname = "U¿ytkownik";
 
 /* links along top of page */
+char *msg_hlnk_in = "G³ówna";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Statystyki dzienne";
 char *msg_hlnk_hs = "Statystyki godzinne";
 char *msg_hlnk_u  = "URL'e";
@@ -252,7 +257,9 @@
 char *msg_mtot_ms = "Statystyka w miesi±cu:";
 char *msg_mtot_th = "Ca³kowita liczba wywo³añ";
 char *msg_mtot_tf = "Ca³kowita liczba plików";
-char *msg_mtot_tx = "Ca³kowita liczba KB";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Ca³kowita liczba unikalnych lokalizacji";
 char *msg_mtot_ur = "Ca³kowita liczba unikalnych odno¶ników";
 char *msg_mtot_ua = "Ca³kowita liczba unikalnych przegl±darek";
@@ -264,7 +271,9 @@
 char *msg_mtot_mpd= "Stron dziennie";
 char *msg_mtot_msd= "Lokalizacji dziennie";
 char *msg_mtot_mvd= "Wizyt dziennie";
-char *msg_mtot_mkd= "Kilobajtów dziennie";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Wywo³ania wed³ug kodu odpowiedzi";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.portuguese webalizer-2.23-05-RB29//lang/webalizer_lang.portuguese
--- webalizer-2.23-05//lang/webalizer_lang.portuguese	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.portuguese	2011-04-19 18:45:55.481093307 +0200
@@ -206,6 +206,7 @@
 char *msg_main_sum= "Sumário por Mês";
 char *msg_main_da = "Média Diária";
 char *msg_main_mt = "Totais Mensais";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Uso diário de";
@@ -225,7 +226,9 @@
 char *msg_h_visits= "Visitas";
 char *msg_h_files = "Ficheiros";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Hostname";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "User Agent";
@@ -235,6 +238,8 @@
 char *msg_h_uname = "Username";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Estatística Diária";
 char *msg_hlnk_hs = "Estatística por Hora";
 char *msg_hlnk_u  = "URLs";
@@ -251,7 +256,9 @@
 char *msg_mtot_ms = "Estatística Mensal de";
 char *msg_mtot_th = "Total de Hits";
 char *msg_mtot_tf = "Total de Ficheiros";
-char *msg_mtot_tx = "Total de KBytes";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Total de Sites Únicos";
 char *msg_mtot_ur = "Total de Referrers Únicos";
 char *msg_mtot_ua = "Total de User Agents Únicos";
@@ -263,7 +270,9 @@
 char *msg_mtot_mpd= "Paginas por Dia";
 char *msg_mtot_msd= "Sites por Dia";
 char *msg_mtot_mvd= "Visitas por Dia";
-char *msg_mtot_mkd= "KBytes por Dia";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Hits por Código de Resposta";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.portuguese_brazil webalizer-2.23-05-RB29//lang/webalizer_lang.portuguese_brazil
--- webalizer-2.23-05//lang/webalizer_lang.portuguese_brazil	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.portuguese_brazil	2011-04-19 18:45:55.481093307 +0200
@@ -207,6 +207,7 @@
 char *msg_main_sum= "Resumo Mensal";
 char *msg_main_da = "Média diária";
 char *msg_main_mt = "Total Mensal";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Utilização diária em";
@@ -226,7 +227,9 @@
 char *msg_h_visits= "Visitas";
 char *msg_h_files = "Arquivos";
 char *msg_h_sites = "Endereços";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Servidores";
 char *msg_h_url   = "URLs";
 char *msg_h_agent = "Programa cliente";
@@ -236,6 +239,8 @@
 char *msg_h_uname = "Nomes de Usuários";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Estatísticas diárias";
 char *msg_hlnk_hs = "Estatísticas por hora";
 char *msg_hlnk_u  = "URLs";
@@ -252,7 +257,9 @@
 char *msg_mtot_ms = "Estatísticas Mensais para";
 char *msg_mtot_th = "Total de hits";
 char *msg_mtot_tf = "Total de arquivos";
-char *msg_mtot_tx = "Total de KBytes";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Total de servidores";
 char *msg_mtot_ur = "Total de refer&ecirc;ncias";
 char *msg_mtot_ua = "Total de programas clientes";
@@ -264,7 +271,9 @@
 char *msg_mtot_mpd= "Páginas por Dia";
 char *msg_mtot_msd= "Servidores por Dia";
 char *msg_mtot_mvd= "Visitas por Dia";
-char *msg_mtot_mkd= "KBytes por Dia";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Hits por código de resposta";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.romanian webalizer-2.23-05-RB29//lang/webalizer_lang.romanian
--- webalizer-2.23-05//lang/webalizer_lang.romanian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.romanian	2011-04-19 18:45:55.485093973 +0200
@@ -200,6 +200,7 @@
 char *msg_main_sum= "Sumarul pe luna";
 char *msg_main_da = "Media zilnica";
 char *msg_main_mt = "Totaluri lunare";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Utilizarea zilnica pe luna";
@@ -219,7 +220,9 @@
 char *msg_h_visits= "Vizite";
 char *msg_h_files = "Fisiere";
 char *msg_h_sites = "Situri";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Nume";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Navigator";
@@ -229,6 +232,8 @@
 char *msg_h_uname = "Utilizator";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Statistici zilnice";
 char *msg_hlnk_hs = "Statistici orare";
 char *msg_hlnk_u  = "URL-uri";
@@ -245,7 +250,9 @@
 char *msg_mtot_ms = "Statistici lunare pentru";
 char *msg_mtot_th = "Total accesari";
 char *msg_mtot_tf = "Total fisiere";
-char *msg_mtot_tx = "Total Kbytes";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Total situri unice";
 char *msg_mtot_ur = "Total pagini referente unice";
 char *msg_mtot_ua = "Total navigatoare";
@@ -257,7 +264,9 @@
 char *msg_mtot_mpd= "Pagini pe zi";
 char *msg_mtot_msd= "Situri pe zi";
 char *msg_mtot_mvd= "Vizite pe zi";
-char *msg_mtot_mkd= "KBytes pe zi";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Accesari dupa codul de raspuns";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.romanian-iso-8859-2 webalizer-2.23-05-RB29//lang/webalizer_lang.romanian-iso-8859-2
--- webalizer-2.23-05//lang/webalizer_lang.romanian-iso-8859-2	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.romanian-iso-8859-2	2011-04-19 18:45:55.485093973 +0200
@@ -201,6 +201,7 @@
 char *msg_main_sum= "Sumarul pe lunã";
 char *msg_main_da = "Media zilnicã";
 char *msg_main_mt = "Totaluri lunare";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Utilizarea zilnicã pe lunã";
@@ -220,7 +221,9 @@
 char *msg_h_visits= "Vizite";
 char *msg_h_files = "Fiºiere";
 char *msg_h_sites = "Situri";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Nume";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Navigator";
@@ -230,6 +233,8 @@
 char *msg_h_uname = "Utilizator";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Statistici zilnice";
 char *msg_hlnk_hs = "Statistici orare";
 char *msg_hlnk_u  = "URL-uri";
@@ -246,7 +251,9 @@
 char *msg_mtot_ms = "Statistici lunare pentru";
 char *msg_mtot_th = "Total accesãri";
 char *msg_mtot_tf = "Total fiºiere";
-char *msg_mtot_tx = "Total Kbytes";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Total situri unice";
 char *msg_mtot_ur = "Total pagini referente unice";
 char *msg_mtot_ua = "Total navigatoare";
@@ -258,7 +265,9 @@
 char *msg_mtot_mpd= "Pagini pe zi";
 char *msg_mtot_msd= "Situri pe zi";
 char *msg_mtot_mvd= "Vizite pe zi";
-char *msg_mtot_mkd= "KBytes pe zi";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Accesãri dupã codul de rãspuns";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.russian webalizer-2.23-05-RB29//lang/webalizer_lang.russian
--- webalizer-2.23-05//lang/webalizer_lang.russian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.russian	2011-04-19 18:45:55.489094233 +0200
@@ -213,6 +213,7 @@
 char *msg_main_sum= "åÖÅÍÅÓÑŞÎÁÑ ÓÔÁÔÉÓÔÉËÁ";
 char *msg_main_da = "÷ ÓÒÅÄÎÅÍ ÚÁ ÄÅÎØ";
 char *msg_main_mt = "÷ÓÅÇÏ ÚÁ ÍÅÓÑÃ";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "éÓĞÏÌØÚÏ×ÁÎÉÅ ĞÏ ÄÎÑÍ ÎÁ";
@@ -232,7 +233,9 @@
 char *msg_h_visits= "ĞÏÓÅİÅÎÉÊ";
 char *msg_h_files = "ÆÁÊÌÏ×";
 char *msg_h_sites = "ÓÁÊÔÏ×";
-char *msg_h_xfer  = "ëÂÁÊÔ";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "éÍÑ ÈÏÓÔÁ";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "âÒÏÕÚÅÒ";
@@ -242,6 +245,8 @@
 char *msg_h_uname = "éÍÑ ĞÏÌØÚÏ×ÁÔÅÌÑ";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "óÔÁÔÉÓÔÉËÁ ĞÏ ÄÎÑÍ";
 char *msg_hlnk_hs = "óÔÁÔÉÓÔÉËÁ ĞÏ ŞÁÓÁÍ";
 char *msg_hlnk_u  = "URL";
@@ -258,7 +263,9 @@
 char *msg_mtot_ms = "óÔÁÔÉÓÔÉËÁ ÚÁ ÍÅÓÑÃ ÎÁ";
 char *msg_mtot_th = "÷ÓÅÇÏ ÚÁĞÒÏÓÏ×";
 char *msg_mtot_tf = "÷ÓÅÇÏ ÆÁÊÌÏ×";
-char *msg_mtot_tx = "÷ÓÅÇÏ ËÉÌÏÂÁÊÔ";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "÷ÓÅÇÏ ÕÎÉËÁÌØÎÙÈ ÓÁÊÔÏ×";
 char *msg_mtot_ur = "÷ÓÅÇÏ ÕÎÉËÁÌØÎÙÈ ÓÓÙÌÁÀİÉÈÓÑ ÓÔÒÁÎÉÃ";
 char *msg_mtot_ua = "÷ÓÅÇÏ ÕÎÉËÁÌØÎÙÈ ÂÒÏÕÚÅÒÏ×";
@@ -270,7 +277,9 @@
 char *msg_mtot_mpd= "óÔÒÁÎÉÃ × ÄÅÎØ";
 char *msg_mtot_msd= "Sites per Day";
 char *msg_mtot_mvd= "ğÏÓÅİÅÎÉÊ × ÄÅÎØ";
-char *msg_mtot_mkd= "ïÂß£Í × ÄÅÎØ (ëÂÁÊÔ)";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "úÁĞÒÏÓÙ ĞÏ ËÏÄÁÍ ÏÔ×ÅÔÁ";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.serbian webalizer-2.23-05-RB29//lang/webalizer_lang.serbian
--- webalizer-2.23-05//lang/webalizer_lang.serbian	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.serbian	2011-04-19 18:45:55.489094233 +0200
@@ -196,6 +196,7 @@
 char *msg_main_sum= "Pregled po mesecima";
 char *msg_main_da = "Dnevni prosek";
 char *msg_main_mt = "Mesecni zbirovi";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Pristupi po danu za";
@@ -215,7 +216,9 @@
 char *msg_h_visits= "Poseta";
 char *msg_h_files = "Fajlova";
 char *msg_h_sites = "Racunara";
-char *msg_h_xfer  = "KB";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Racunar";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Korisnicki program";
@@ -225,6 +228,8 @@
 char *msg_h_uname = "Korisnik";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Dnevna statistika";
 char *msg_hlnk_hs = "Statistika po satu";
 char *msg_hlnk_u  = "URL-ovi";
@@ -241,7 +246,9 @@
 char *msg_mtot_ms = "Mesecna statistika za";
 char *msg_mtot_th = "Ukupno pristupa";
 char *msg_mtot_tf = "Ukupno fajlova";
-char *msg_mtot_tx = "Ukupno KBajta";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Ukupno razlicitih racunara";
 char *msg_mtot_ur = "Ukupno razlicitih referisanja";
 char *msg_mtot_ua = "Ukupno razlicitih browsera";
@@ -253,7 +260,9 @@
 char *msg_mtot_mpd= "Fajlova na sat";
 char *msg_mtot_msd= "Racunara na dan";
 char *msg_mtot_mvd= "Poseta na dan";
-char *msg_mtot_mkd= "KBajta na dan";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Pristupa po kodu";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.simplified_chinese webalizer-2.23-05-RB29//lang/webalizer_lang.simplified_chinese
--- webalizer-2.23-05//lang/webalizer_lang.simplified_chinese	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.simplified_chinese	2011-04-19 18:45:55.493093896 +0200
@@ -195,6 +195,7 @@
 char *msg_main_sum= "°´ÔÂÕªÒª";
 char *msg_main_da = "Ã¿ÈÕÆ½¾ù";
 char *msg_main_mt = "Ã¿ÔÂ×Ü¼Æ";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Ã¿ÈÕÊ¹ÓÃÇé¿ö";
@@ -214,7 +215,9 @@
 char *msg_h_visits= "·ÃÎÊ";
 char *msg_h_files = "ÎÄ¼ş";
 char *msg_h_sites = "Õ¾µã";
-char *msg_h_xfer  = "Ç§×Ö½Ú";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Ö÷»úÃû";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "ÓÃ»§´úÀí";
@@ -224,6 +227,8 @@
 char *msg_h_uname = "ÓÃ»§Ãû";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Ã¿ÈÕÍ³¼Æ";
 char *msg_hlnk_hs = "Ã¿Ğ¡Ê±Í³¼Æ";
 char *msg_hlnk_u  = "URLs";
@@ -240,7 +245,9 @@
 char *msg_mtot_ms = "ÔÂÍ³¼ÆĞÅÏ¢";
 char *msg_mtot_th = "×Üµã»÷Êı";
 char *msg_mtot_tf = "×ÜÎÄ¼şÊı";
-char *msg_mtot_tx = "×ÜÇ§×Ö½ÚÊı";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "×ÜÕ¾µãÊı£¨²»°üÀ¨ÖØ¸´Õ¾µã£©";
 char *msg_mtot_ur = "×ÜÒıÓÃÕßÊı£¨²»°üÀ¨ÖØ¸´ÒıÓÃÕß£©";
 char *msg_mtot_ua = "×ÜÓÃ»§´úÀíÊı£¨²»°üÀ¨ÖØ¸´ÓÃ»§´úÀí£©";
@@ -252,7 +259,9 @@
 char *msg_mtot_mpd= "Ã¿ÌìÒ³ÃæÊı";
 char *msg_mtot_msd= "Sites per Day";
 char *msg_mtot_mvd= "Ã¿Ìì·ÃÎÊÊı";
-char *msg_mtot_mkd= "Ã¿ÌìÁ÷Á¿Êı£¨µ¥Î»£ºÇ§×Ö½Ú£©";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "°´ÏìÓ¦ÂëµÄµã»÷Êı";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.slovak webalizer-2.23-05-RB29//lang/webalizer_lang.slovak
--- webalizer-2.23-05//lang/webalizer_lang.slovak	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.slovak	2011-04-19 18:45:55.493093896 +0200
@@ -205,6 +205,7 @@
 char *msg_main_sum= "Mesaènı sumár";
 char *msg_main_da = "Dennı priemer";
 char *msg_main_mt = "Mesaèné súèty";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Denné vyu¾itie za";
@@ -224,7 +225,9 @@
 char *msg_h_visits= "náv¹tev";
 char *msg_h_files = "súborov";
 char *msg_h_sites = "miest";
-char *msg_h_xfer  = "kBytov";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "poèítaè";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "prehliadaè";
@@ -234,6 +237,8 @@
 char *msg_h_uname = "u¾ivateµ";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Denné ¹tatistiky";
 char *msg_hlnk_hs = "Hodinové ¹tatistiky";
 char *msg_hlnk_u  = "URL-ky";
@@ -250,7 +255,9 @@
 char *msg_mtot_ms = "Mesaèné ¹tatistiky za";
 char *msg_mtot_th = "Celkom zásahov";
 char *msg_mtot_tf = "Celkom súborov";
-char *msg_mtot_tx = "Celkom kBytov";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Celkom jedineènıch miest";
 char *msg_mtot_ur = "Celkom jedineènıch odkazovaèov";
 char *msg_mtot_ua = "Celkom jedineènıch Browsrov";
@@ -262,7 +269,9 @@
 char *msg_mtot_mpd= "Stránok za deò";
 char *msg_mtot_msd= "Miest za deò";
 char *msg_mtot_mvd= "Náv¹tev za deò";
-char *msg_mtot_mkd= "kBytov za deò";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Zásahy podµa kódu odpovede";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.slovene webalizer-2.23-05-RB29//lang/webalizer_lang.slovene
--- webalizer-2.23-05//lang/webalizer_lang.slovene	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.slovene	2011-04-19 18:45:55.497094007 +0200
@@ -196,6 +196,7 @@
 char *msg_main_sum= "Povzetek po mesecih";
 char *msg_main_da = "Dnevno povpreèje";
 char *msg_main_mt = "Meseèni seštevki";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Poroèilo po dnevih za";
@@ -215,7 +216,9 @@
 char *msg_h_visits= "Obiskov";
 char *msg_h_files = "Datotek";
 char *msg_h_sites = "Po podroèjih";
-char *msg_h_xfer  = "KB";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Gostitelj";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Brskalnik";
@@ -225,6 +228,8 @@
 char *msg_h_uname = "Uporabnik";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Dnevna statistika";
 char *msg_hlnk_hs = "Statistika po urah";
 char *msg_hlnk_u  = "URLs";
@@ -241,7 +246,9 @@
 char *msg_mtot_ms = "Meseèno poroèilo za";
 char *msg_mtot_th = "Skupaj zahtevkov";
 char *msg_mtot_tf = "Skupaj datotek";
-char *msg_mtot_tx = "Skupaj KB";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Skupaj enkr. podroèij";
 char *msg_mtot_ur = "Skupaj enkr. napotiteljev";
 char *msg_mtot_ua = "Skupaj enkr. brskalnikov";
@@ -253,7 +260,9 @@
 char *msg_mtot_mpd= "Strani dnevno";
 char *msg_mtot_msd= "Podroèij dnevno";
 char *msg_mtot_mvd= "Obiskov dnevno";
-char *msg_mtot_mkd= "KB dnevno";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Zahtevki po odzivnih kodah";
 
 /* daily Skupaj table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.spanish webalizer-2.23-05-RB29//lang/webalizer_lang.spanish
--- webalizer-2.23-05//lang/webalizer_lang.spanish	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.spanish	2011-04-19 18:45:55.497094007 +0200
@@ -213,6 +213,7 @@
 char *msg_main_sum= "Resumen por meses";
 char *msg_main_da = "Media diaria";
 char *msg_main_mt = "Totales mensuales";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Uso diario en";
@@ -232,7 +233,9 @@
 char *msg_h_visits= "Visitas";
 char *msg_h_files = "Archivos";
 char *msg_h_sites = "Clientes";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Máquina";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Navegador";
@@ -242,6 +245,8 @@
 char *msg_h_uname = "Usuario";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Estadísticas diarias";
 char *msg_hlnk_hs = "Estadísticas por horas";
 char *msg_hlnk_u  = "URLs";
@@ -258,7 +263,9 @@
 char *msg_mtot_ms = "Estadísticas mensuales de";
 char *msg_mtot_th = "Total Accesos";
 char *msg_mtot_tf = "Total Archivos";
-char *msg_mtot_tx = "Total KBytes";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Total Clientes";
 char *msg_mtot_ur = "Total Enlaces origen";
 char *msg_mtot_ua = "Total Navegadores";
@@ -270,7 +277,9 @@
 char *msg_mtot_mpd= "Páginas por Día";
 char *msg_mtot_msd= "Clientes por Día";
 char *msg_mtot_mvd= "Visitas por Día";
-char *msg_mtot_mkd= "KBytes por Día";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Accesos por código de respuesta";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.swedish webalizer-2.23-05-RB29//lang/webalizer_lang.swedish
--- webalizer-2.23-05//lang/webalizer_lang.swedish	2008-12-15 08:34:02.000000000 +0100
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.swedish	2011-04-19 18:45:55.501094679 +0200
@@ -219,6 +219,7 @@
 char *msg_main_sum= "Summering m&aring;nad f&ouml;r m&aring;nad";
 char *msg_main_da = "Medel &ouml;ver dagen";
 char *msg_main_mt = "M&aring;natliga summor";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 /* For libgd is no HTML letters */
@@ -243,7 +244,9 @@
 char *msg_h_visits= "Besök.";	//	GD
 char *msg_h_files = "Filer";
 char *msg_h_sites = "Klient.";
-char *msg_h_xfer  = "kilobyte";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 //	char *msg_h_hname = "V&auml;rdnamn";	//	HTML
 char *msg_h_hname = "Värdnamn";	//	GD
 char *msg_h_url   = "URL";
@@ -256,6 +259,8 @@
 char *msg_h_uname = "Användarnamn";	//	GD
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Daglig statistik";
 char *msg_hlnk_hs = "Statistik timme f&ouml;r timme";
 char *msg_hlnk_u  = "URLer";
@@ -272,7 +277,9 @@
 char *msg_mtot_ms = "M&aring;natlig statistik f&ouml;r";
 char *msg_mtot_th = "Totalt antal tr&auml;ffar";
 char *msg_mtot_tf = "Totalt antal filer";
-char *msg_mtot_tx = "Totalt antal kilobytes";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Totalt antal unika klientadresser";
 char *msg_mtot_ur = "Totalt antal unika h&auml;nvisningar";
 char *msg_mtot_ua = "Totalt antal unika klienttyper";
@@ -284,7 +291,9 @@
 char *msg_mtot_mpd= "Sidor per dag";
 char *msg_mtot_msd= "Klientadresser per dag";
 char *msg_mtot_mvd= "Bes&ouml;k per dag";
-char *msg_mtot_mkd= "Kilobytes per dag";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Tr&auml;ffar sorterade efter svarskod";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.thai webalizer-2.23-05-RB29//lang/webalizer_lang.thai
--- webalizer-2.23-05//lang/webalizer_lang.thai	2008-07-02 00:24:12.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.thai	2011-04-19 18:45:55.501094679 +0200
@@ -201,6 +201,7 @@
 char *msg_main_sum= "ÊÃØ»ÃÒÂà´×Í¹";
 char *msg_main_da = "à©ÅÕèÂµèÍÇÑ¹";
 char *msg_main_mt = "ÃÇÁ·Ñé§à´×Í¹";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Daily usage for";
@@ -220,7 +221,9 @@
 char *msg_h_visits= "Visits";
 char *msg_h_files = "Files";
 char *msg_h_sites = "Sites";
-char *msg_h_xfer  = "KBytes";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Hostname";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "User Agent";
@@ -230,6 +233,8 @@
 char *msg_h_uname = "Username";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Ê¶ÔµÔÃÒÂÇÑ¹";
 char *msg_hlnk_hs = "Ê¶ÔµÔÃÒÂªÑèÇâÁ§";
 char *msg_hlnk_u  = "URL";
@@ -246,7 +251,9 @@
 char *msg_mtot_ms = "Ê¶ÔµÔÃÒÂà´×Í¹ÊÓËÃÑº";
 char *msg_mtot_th = "hit ·Ñé§ËÁ´";
 char *msg_mtot_tf = "ä¿Åì·Ñé§ËÁ´";
-char *msg_mtot_tx = "¡ÔâÅäºµì·Ñé§ËÁ´";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "unique site ·Ñé§ËÁ´";
 char *msg_mtot_ur = "unique referrer ·Ñé§ËÁ´";
 char *msg_mtot_ua = "unique user agent ·Ñé§ËÁ´";
@@ -258,7 +265,9 @@
 char *msg_mtot_mpd= "page µèÍÇÑ¹";
 char *msg_mtot_msd= "site µèÍÇÑ¹";
 char *msg_mtot_mvd= "visit µèÍÇÑ¹";
-char *msg_mtot_mkd= "¡ÔâºäºµìµèÍÇÑ¹";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "hit µèÍ response Code";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.turkish webalizer-2.23-05-RB29//lang/webalizer_lang.turkish
--- webalizer-2.23-05//lang/webalizer_lang.turkish	2008-07-02 00:24:13.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.turkish	2011-04-19 18:45:55.505093040 +0200
@@ -201,6 +201,7 @@
 char *msg_main_sum= "Ay'a Gore Ozet";
 char *msg_main_da = "Gunluk Averaj";
 char *msg_main_mt = "Aylik Toplamlar";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "Gunluk Kullanim:";
@@ -220,7 +221,9 @@
 char *msg_h_visits= "Ziyaret";
 char *msg_h_files = "Dosya";
 char *msg_h_sites = "Istemci";
-char *msg_h_xfer  = "KBayt'a Gore";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "Makine Adi";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "Kullanici Ajani";
@@ -230,6 +233,8 @@
 char *msg_h_uname = "Kullanici";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "Gunluk Istatistikler";
 char *msg_hlnk_hs = "Saatlik Istatistikler";
 char *msg_hlnk_u  = "URL'ler";
@@ -246,7 +251,9 @@
 char *msg_mtot_ms = "Aylik Istatistikler:";
 char *msg_mtot_th = "Toplam HIT'ler";
 char *msg_mtot_tf = "Toplam Dosyalar";
-char *msg_mtot_tx = "Toplam KBaytlar";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "Toplam Ayni Istemciler";
 char *msg_mtot_ur = "Toplam Ayni Referanslar";
 char *msg_mtot_ua = "Toplam Ayni Kullanici Ajanlari";
@@ -258,7 +265,9 @@
 char *msg_mtot_mpd= "Gunluk Sayfalar";
 char *msg_mtot_msd= "Gunluk Istemciler";
 char *msg_mtot_mvd= "Gunluk Ziyaretler";
-char *msg_mtot_mkd= "Gunluk KBaytlar";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "Cevap Koduna Gore HIT";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang/webalizer_lang.ukrainian webalizer-2.23-05-RB29//lang/webalizer_lang.ukrainian
--- webalizer-2.23-05//lang/webalizer_lang.ukrainian	2011-04-15 07:31:44.000000000 +0200
+++ webalizer-2.23-05-RB29//lang/webalizer_lang.ukrainian	2011-04-19 18:45:55.505093040 +0200
@@ -205,6 +205,7 @@
 char *msg_main_sum= "ıÏÍ¦ÓÑŞÎÉÊ Ğ¦ÄÓÕÍÏË";
 char *msg_main_da = "÷ ÓÅÒÅÄÎØÏÍÕ ÚÁ ÄÅÎØ";
 char *msg_main_mt = "÷ÓØÏÇÏ ÚÁ Í¦ÓÑÃØ";
+char *msg_main_ar = "Archived reports";
 
 /* month HTML page strings */
 char *msg_hmth_du = "ıÏÄÅÎÎÅ ×ÉËÏÒÉÓÔÁÎÎÑ ÚÁ";
@@ -224,7 +225,9 @@
 char *msg_h_visits= "×¦Ä×¦Ä.";
 char *msg_h_files = "ÆÁÊÌ¦×";
 char *msg_h_sites = "ÓÁÊÔ¦×";
-char *msg_h_xfer  = "ëâÁÊÔ";
+char *msg_h_xfer  = "Volume";
+char *msg_h_ixfer = "Vol. In";
+char *msg_h_oxfer = "Vol. Out";
 char *msg_h_hname = "¦Í'Ñ ÈÏÓÔÁ";
 char *msg_h_url   = "URL";
 char *msg_h_agent = "ÁÇÅÎÔ ËÏÒÉÓÔÕ×ÁŞÁ";
@@ -234,6 +237,8 @@
 char *msg_h_uname = "¦Í'Ñ ËÏÒÉÓÔÕ×ÁŞÁ";
 
 /* links along top of page */
+char *msg_hlnk_in = "Main";
+char *msg_hlnk_nf = "Code 404";
 char *msg_hlnk_ds = "óÔÁÔÉÓÔÉËÁ ĞÏ ÄÎÑÈ";
 char *msg_hlnk_hs = "óÔÁÔÉÓÔÉËÁ ĞÏ ÇÏÄÉÎÁÈ";
 char *msg_hlnk_u  = "URL'É";
@@ -250,7 +255,9 @@
 char *msg_mtot_ms = "í¦ÓÑŞÎÁ ÓÔÁÔÉÓÎÉËÁ ÚÁ";
 char *msg_mtot_th = "÷ÓØÏÇÏ ÚÁĞÉÔ¦×";
 char *msg_mtot_tf = "÷ÓØÏÇÏ ÆÁÊÌ¦×";
-char *msg_mtot_tx = "÷ÓØÏÇÏ ëâÁÊÔ";
+char *msg_mtot_tx = "Total Volume";
+char *msg_mtot_ix = "Total Vol. In";
+char *msg_mtot_ox = "Total Vol. Out";
 char *msg_mtot_us = "÷ÓØÏÇÏ ÕÎ¦ËÁÌØÎÉÈ ÓÁÊÔ¦×";
 char *msg_mtot_ur = "÷ÓØÏÇÏ ÕÎ¦ËÁÌØÎÉÈ ĞÏÓÉÌÁÎØ";
 char *msg_mtot_ua = "÷ÓØÏÇÏ ÕÎ¦ËÁÌØÎÉÈ ÁÇÅÎÔ¦× ËÏÒÉÓÔÕ×ÁŞÁ";
@@ -262,7 +269,9 @@
 char *msg_mtot_mpd= "óÔÏÒ¦ÎÏË ÚÁ ÄÅÎØ";
 char *msg_mtot_msd= "Sites per Day";
 char *msg_mtot_mvd= "÷¦Ä×¦ÄÕ×ÁÎØ ÚÁ ÄÅÎØ";
-char *msg_mtot_mkd= "KâÁÊÔ ÚÁ ÄÅÎØ";
+char *msg_mtot_mkd= "Volume per Day";
+char *msg_mtot_ikd= "Vol. In per Day";
+char *msg_mtot_okd= "Vol. Out per Day";
 char *msg_mtot_rc = "ú×ÅÒÔÁÎØ ÚÁ ËÏÄÏÍ ×¦ÄĞÏ×¦Ä¦";
 
 /* daily total table */
diff -Naur webalizer-2.23-05//lang.h webalizer-2.23-05-RB29//lang.h
--- webalizer-2.23-05//lang.h	2008-07-01 07:47:10.000000000 +0200
+++ webalizer-2.23-05-RB29//lang.h	2011-04-19 18:37:55.000000000 +0200
@@ -90,6 +90,7 @@
 extern char *msg_main_sum;
 extern char *msg_main_da ;
 extern char *msg_main_mt ;
+extern char *msg_main_ar ;
 
 extern char *msg_hmth_du ;
 extern char *msg_hmth_hu ;
@@ -108,6 +109,8 @@
 extern char *msg_h_files ;
 extern char *msg_h_sites ;
 extern char *msg_h_xfer  ;
+extern char *msg_h_ixfer ;
+extern char *msg_h_oxfer ;
 extern char *msg_h_hname ;
 extern char *msg_h_url   ;
 extern char *msg_h_agent ;
@@ -116,6 +119,8 @@
 extern char *msg_h_search;
 extern char *msg_h_uname ;
 
+extern char *msg_hlnk_in ;
+extern char *msg_hlnk_nf ;
 extern char *msg_hlnk_ds ;
 extern char *msg_hlnk_hs ;
 extern char *msg_hlnk_u  ;
@@ -132,6 +137,8 @@
 extern char *msg_mtot_th ;
 extern char *msg_mtot_tf ;
 extern char *msg_mtot_tx ;
+extern char *msg_mtot_ix ;
+extern char *msg_mtot_ox ;
 extern char *msg_mtot_us ;
 extern char *msg_mtot_ur ;
 extern char *msg_mtot_ua ;
@@ -144,6 +151,8 @@
 extern char *msg_mtot_msd;
 extern char *msg_mtot_mvd;
 extern char *msg_mtot_mkd;
+extern char *msg_mtot_ikd;
+extern char *msg_mtot_okd;
 extern char *msg_mtot_rc ;
 
 extern char *msg_dtot_ds ;
diff -Naur webalizer-2.23-05//output.c webalizer-2.23-05-RB29//output.c
--- webalizer-2.23-05//output.c	2011-01-03 05:52:05.000000000 +0100
+++ webalizer-2.23-05-RB29//output.c	2011-04-19 18:37:55.000000000 +0200
@@ -70,6 +70,7 @@
 void    write_html_tail(FILE *);                    /* tail of html page   */
 void    month_links();                              /* Page links          */
 void    month_total_table();                        /* monthly total table */
+void    month_error_table();                        /* monthly 404 table   */
 void    daily_total_table();                        /* daily total table   */
 void    hourly_total_table();                       /* hourly total table  */
 void    top_sites_table(int);                       /* top n sites table   */
@@ -104,6 +105,7 @@
 int     all_agents_page(u_int64_t, u_int64_t);      /* output agents page  */
 int     all_search_page(u_int64_t, u_int64_t);      /* output search page  */
 int     all_users_page(u_int64_t, u_int64_t);       /* output ident page   */
+int     all_errors_page();                          /* output 404 page     */
 void    dump_all_sites();                           /* dump sites tab file */
 void    dump_all_urls();                            /* dump urls tab file  */
 void    dump_all_refs();                            /* dump refs tab file  */
@@ -125,7 +127,6 @@
 #define YELLOW         "#FFFF00"
 #define PURPLE         "#FF00FF"
 #define CYAN           "#00E0FF"
-#define GRPCOLOR       "#D0D0E0"
 
 /* configurable html colors */
 #define HITCOLOR       hit_color
@@ -135,6 +136,14 @@
 #define PAGECOLOR      page_color
 #define VISITCOLOR     visit_color
 #define MISCCOLOR      misc_color
+#define BACKGNDCOLOR   backgnd_color
+#define TEXTCOLOR      text_color
+#define LINKCOLOR      link_color
+#define VLINKCOLOR     vlink_color
+#define ALINKCOLOR     alink_color
+#define GRPCOLOR       grp_color
+#define HEADLINECOLOR  headline_color
+#define COUNTERCOLOR   counter_color
 
 /* sort arrays */
 UNODEPTR *u_array      = NULL;                /* Sort array for URLs      */
@@ -172,7 +181,13 @@
       }
    }
    /* Standard header comments */
-   fprintf(out_fp,"<!-- Generated by The Webalizer  Ver. %s-%s -->\n",
+   fprintf(out_fp,"<!--   Generated by Webalizer Xtended %s    -->\n",
+      version_xt);
+   fprintf(out_fp,"<!--                                          -->\n");
+   fprintf(out_fp,"<!--  %s  -->\n",copyright_xt);
+   fprintf(out_fp,"<!--   http://www.patrickfrei.ch/webalizer/   -->\n");
+   fprintf(out_fp,"<!--                                          -->\n");
+   fprintf(out_fp,"<!--   Based on The Webalizer  Ver. %s-%s   -->\n",
       version,editlvl);
    fprintf(out_fp,"<!--                                          -->\n");
    fprintf(out_fp,"<!-- Copyright 1997-2011  Bradford L. Barrett -->\n");
@@ -201,8 +216,8 @@
    lptr = html_body;
    if (lptr==NULL)
       fprintf(out_fp,"<BODY BGCOLOR=\"%s\" TEXT=\"%s\" "   \
-              "LINK=\"%s\" VLINK=\"%s\">\n",
-              LTGREY, BLACK, BLUE, RED);
+              "LINK=\"%s\" VLINK=\"%s\" ALINK=\"%s\">\n",
+              BACKGNDCOLOR, TEXTCOLOR, LINKCOLOR, VLINKCOLOR, ALINKCOLOR);
    else
    {
       while (lptr!=NULL)
@@ -216,7 +231,16 @@
       fprintf(out_fp,"<SMALL><STRONG>\n%s: %s<BR>\n",msg_hhdr_sp,period);
    else
       fprintf(out_fp,"<SMALL><STRONG>\n%s<BR>\n",msg_main_per);
-   fprintf(out_fp,"%s %s<BR>\n</STRONG></SMALL>\n",msg_hhdr_gt,cur_time());
+   fprintf(out_fp,"%s %s<BR>\n",msg_hhdr_gt,cur_time());
+   fprintf(out_fp,"<A HREF=\"http://www.patrickfrei.ch/webalizer/\">"\
+                  "Webalizer Xtended (%s)</A><BR>\n",version_xt);
+#ifdef USE_GEOIP
+   extern int  geoip;
+   extern char geo_db_info[256];
+   if (geoip)
+      fprintf(out_fp,"GeoIP: %s<BR>\n", geo_db_info);
+#endif /* USE_GEOIP */
+   fprintf(out_fp, "</STRONG></SMALL>\n");
    lptr=html_post;
    while (lptr!=NULL)
    {
@@ -240,9 +264,12 @@
                   "CELLSPACING=0 BORDER=0>\n");
    fprintf(out_fp,"<TR>\n");
    fprintf(out_fp,"<TD ALIGN=left VALIGN=top>\n");
-   fprintf(out_fp,"<SMALL>Generated by\n");
+   fprintf(out_fp,"<SMALL>Generated by "\
+                  "<A HREF=\"http://www.patrickfrei.ch/webalizer/\">"\
+		  "<STRONG>Webalizer Xtended (%s)</STRONG></A> by Patrick Frei "\
+                  "based on \n",version_xt);
    fprintf(out_fp,"<A HREF=\"http://www.webalizer.org/\">");
-   fprintf(out_fp,"<STRONG>Webalizer Version %s</STRONG></A>\n",version);
+   fprintf(out_fp,"Webalizer Version %s-%s</A>\n",version,editlvl);
    fprintf(out_fp,"</SMALL>\n</TD>\n");
    lptr=html_tail;
    if (lptr)
@@ -260,6 +287,8 @@
    /* wind up, this is the end of the file */
    fprintf(out_fp,"\n<!-- Webalizer Version %s-%s (Mod: %s) -->\n",
            version,editlvl,moddate);
+   fprintf(out_fp,"\n<!--  Webalizer Xtended %s (Mod: %s)   -->\n",
+           version_xt,moddate_xt);
    lptr = html_end;
    if (lptr)
    {
@@ -308,8 +337,10 @@
                       tm_file,             /* data 2 (files)    */
                       tm_site,             /* data 3 (sites)    */
                       tm_xfer,             /* data 4 (kbytes)   */
-                      tm_page,             /* data 5 (pages)    */
-                      tm_visit);           /* data 6 (visits)   */
+                      tm_ixfer,            /* data 5 (kbytes)   */
+                      tm_oxfer,            /* data 6 (kbytes)   */
+                      tm_page,             /* data 7 (pages)    */
+                      tm_visit);           /* data 8 (visits)   */
    }
 
    if (hourly_graph)
@@ -331,11 +362,17 @@
    write_html_head(buffer, out_fp);
    month_links();
    month_total_table();
+   if (ntop_notfound && response[21].count && resp_counter) /* 404 error stuff */
+   {
+      fprintf(out_fp,"<A NAME=\"ERRORSTATS\"></A>\n");
+      month_error_table();
+   }
+
    if (daily_graph || daily_stats)        /* Daily stuff */
    {
       fprintf(out_fp,"<A NAME=\"DAYSTATS\"></A>\n");
       if (daily_graph) fprintf(out_fp,"<IMG SRC=\"%s\" ALT=\"%s\" " \
-                  "HEIGHT=400 WIDTH=512><P>\n",png1_fname,dtitle);
+                  "HEIGHT=500 WIDTH=512><P>\n",png1_fname,dtitle);
       if (daily_stats) daily_total_table();
    }
 
@@ -462,6 +499,7 @@
 
    if (ntop_ctrys ) top_ctry_table();     /* top countries table            */
 
+   month_links();
    write_html_tail(out_fp);               /* finish up the HTML document    */
    fclose(out_fp);                        /* close the file                 */
    return (0);                            /* done...                        */
@@ -473,7 +511,14 @@
 
 void month_links()
 {
+   char index_fname[256];
+   
    fprintf(out_fp,"<SMALL>\n");
+   snprintf(index_fname,sizeof(index_fname),"index.%s",html_ext);
+   fprintf(out_fp, "<A HREF=\"%s\">[%s]</A>\n", index_fname, msg_hlnk_in);
+   
+   if (ntop_notfound && response[21].count && resp_counter)
+      fprintf(out_fp,"<A HREF=\"#ERRORSTATS\">[%s]</A>\n",msg_hlnk_nf);
    if (daily_stats || daily_graph)
       fprintf(out_fp,"<A HREF=\"#DAYSTATS\">[%s]</A>\n",msg_hlnk_ds);
    if (hourly_stats || hourly_graph)
@@ -505,9 +550,12 @@
 
 void month_total_table()
 {
-   int i,days_in_month;
+   int i,j,z,days_in_month;
    u_int64_t max_files=0,max_hits=0,max_visits=0,max_pages=0,max_sites=0;
-   double max_xfer=0.0;
+   double max_xfer=0.0,max_ixfer=0.0,max_oxfer=0.0;
+   u_int64_t pie_data[10],pie_tmp_data[10];
+   char *pie_legend[10],*pie_tmp_legend[10],pie_title[48],pie_fname[48];
+   extern int response_graph;  /* include external flag */
 
    days_in_month=(l_day-f_day)+1;
    for (i=0;i<31;i++)
@@ -518,12 +566,16 @@
       if (tm_visit[i]>max_visits) max_visits= tm_visit[i];
       if (tm_site[i]>max_sites)   max_sites = tm_site[i];
       if (tm_xfer[i]>max_xfer)    max_xfer  = tm_xfer[i];
+      if (tm_ixfer[i]>max_ixfer)  max_ixfer = tm_ixfer[i];
+      if (tm_oxfer[i]>max_oxfer)  max_oxfer = tm_oxfer[i];
    }
 
-   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+      table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH COLSPAN=3 ALIGN=center BGCOLOR=\"%s\">"           \
-      "%s %s %d</TH></TR>\n",GREY,msg_mtot_ms,l_month[cur_month-1],cur_year);
+      "%s %s %d</TH></TR>\n",HEADLINECOLOR,msg_mtot_ms,l_month[cur_month-1],
+      cur_year);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    /* Total Hits */
    fprintf(out_fp,"<TR><TD WIDTH=380><FONT SIZE=\"-1\">%s</FONT></TD>\n"     \
@@ -543,8 +595,17 @@
       "</FONT></TD></TR>\n",msg_h_total, msg_h_visits, t_visit);
    /* Total XFer */
    fprintf(out_fp,"<TR><TD WIDTH=380><FONT SIZE=\"-1\">%s</FONT></TD>\n"     \
-      "<TD ALIGN=right COLSPAN=2><FONT SIZE=\"-1\"><B>%.0f</B>"              \
-      "</FONT></TD></TR>\n",msg_mtot_tx,t_xfer/1024);
+      "<TD ALIGN=right COLSPAN=2><FONT SIZE=\"-1\"><B>%s</B>"                \
+      "</FONT></TD></TR>\n",msg_mtot_tx,hr_size(t_xfer));
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"<TR><TD WIDTH=380><FONT SIZE=\"-1\">%s</FONT></TD>\n"  \
+         "<TD ALIGN=right COLSPAN=2><FONT SIZE=\"-1\"><B>%s</B>"             \
+         "</FONT></TD></TR>\n",msg_mtot_ix,hr_size(t_ixfer));
+      fprintf(out_fp,"<TR><TD WIDTH=380><FONT SIZE=\"-1\">%s</FONT></TD>\n"  \
+         "<TD ALIGN=right COLSPAN=2><FONT SIZE=\"-1\"><B>%s</B>"             \
+         "</FONT></TD></TR>\n",msg_mtot_ox,hr_size(t_oxfer));
+   }
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    /**********************************************/
    /* Unique Sites */
@@ -584,7 +645,8 @@
       "<FONT SIZE=-1>%s </FONT></TH>\n"                                      \
       "<TH WIDTH=65 BGCOLOR=\"%s\" ALIGN=right>"                             \
       "<FONT SIZE=-1>%s </FONT></TH></TR>\n",
-      GREY,GREY,GREY,msg_h_avg,GREY,msg_h_max);
+      HEADLINECOLOR,HEADLINECOLOR,HEADLINECOLOR,msg_h_avg,HEADLINECOLOR,
+      msg_h_max);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    /* Max/Avg Hits per Hour */
    fprintf(out_fp,"<TR>"                                                     \
@@ -625,15 +687,30 @@
    /* Max/Avg KBytes per Day */
    fprintf(out_fp,"<TR>"                                                     \
       "<TD><FONT SIZE=\"-1\">%s</FONT></TD>\n"                               \
-      "<TD ALIGN=right WIDTH=65><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
-      "<TD WIDTH=65 ALIGN=right><FONT SIZE=-1><B>%.0f</B>"                   \
+      "<TD ALIGN=right WIDTH=65><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"   \
+      "<TD WIDTH=65 ALIGN=right><FONT SIZE=-1><B>%s</B>"                     \
       "</FONT></TD></TR>\n",msg_mtot_mkd,
-      (t_xfer/1024)/days_in_month,max_xfer/1024);
+      hr_size(t_xfer/days_in_month),hr_size(max_xfer));
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"<TR>"                                                  \
+         "<TD><FONT SIZE=\"-1\">%s</FONT></TD>\n"                            \
+         "<TD ALIGN=right WIDTH=65><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"\
+         "<TD WIDTH=65 ALIGN=right><FONT SIZE=-1><B>%s</B>"                  \
+         "</FONT></TD></TR>\n",msg_mtot_ikd,
+         hr_size(t_ixfer/days_in_month),hr_size(max_ixfer));
+      fprintf(out_fp,"<TR>"                                                  \
+         "<TD><FONT SIZE=\"-1\">%s</FONT></TD>\n"                            \
+         "<TD ALIGN=right WIDTH=65><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"\
+         "<TD WIDTH=65 ALIGN=right><FONT SIZE=-1><B>%s</B>"                  \
+         "</FONT></TD></TR>\n",msg_mtot_okd,
+         hr_size(t_oxfer/days_in_month),hr_size(max_oxfer));
+   }
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    /**********************************************/
    /* response code totals */
    fprintf(out_fp,"<TR><TH COLSPAN=3 ALIGN=center BGCOLOR=\"%s\">\n"         \
-           "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",GREY,msg_mtot_rc);
+           "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",HEADLINECOLOR,msg_mtot_rc);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    for (i=0;i<TOTAL_RC;i++)
    {
@@ -648,6 +725,224 @@
 
    fprintf(out_fp,"</TABLE>\n");
    fprintf(out_fp,"<P>\n");
+
+   /* generate pie chart if needed */
+   if (response_graph) {
+      for (i=0;i<10;i++) pie_data[i]=0;              /* init data array      */
+      z=0;                          /* z: max 10 responses to create the pie */
+      for (i=0;i<TOTAL_RC;i++)                      /* process all responses */
+      {
+         if (response[i].count > 0 && z<10) {
+            if (i==0) {       /* process special response[0] that has no "-" */
+               pie_data[0]=response[0].count;
+               pie_legend[0]=response[0].desc;
+               z+=1;
+            } else {                                     /* process the rest */
+               pie_data[z]=response[i].count;
+               size_t legend_size=strcspn(response[i].desc,"-");
+               void * tmp_ptr = calloc(legend_size+1,sizeof(char));
+               if (tmp_ptr) {
+                  pie_legend[z] = (char *) tmp_ptr;
+                  pie_tmp_legend[z] = (char *) tmp_ptr;
+               } else {
+                  fprintf(stderr, "ERROR: Can't allocate enough memory\n");
+                  exit(0);
+               }
+               memcpy(pie_legend[z],response[i].desc,legend_size);
+               pie_legend[z][legend_size]='\0';
+               z+=1;
+            }
+         }
+      }
+
+      /* Sort the pie chart strings */
+      for (i=0;i<(z-1);i++) {
+        for (j=0;j<(z-1-i);j++) {
+            if (pie_data[j] < pie_data[j+1]) {
+               pie_tmp_data[0] = pie_data[j];
+               pie_tmp_legend[0] = pie_legend[j];
+               pie_data[j] = pie_data[j+1];
+               pie_legend[j] = pie_legend[j+1];
+               pie_data[j+1] = pie_tmp_data[0];
+               pie_legend[j+1] = pie_tmp_legend[0];
+            }
+         }
+      }
+
+      snprintf(pie_title,sizeof(pie_title),"%s %s %d",
+               msg_mtot_rc,l_month[cur_month-1],cur_year);
+      snprintf(pie_fname,sizeof(pie_fname),"responses_%04d%02d.png",
+               cur_year,cur_month);
+      
+      pie_chart(pie_fname,pie_title,t_hit,pie_data,pie_legend);
+      
+      /* put the image tag in the page */
+      fprintf(out_fp,"<IMG SRC=\"%s\" ALT=\"%s\" " \
+            "HEIGHT=300 WIDTH=512><P>\n",pie_fname,pie_title);
+   }
+}
+
+/*********************************************/
+/* MONTH_ERROR_TABLE - monthly 404 table     */
+/*********************************************/
+
+void month_error_table()
+{
+   int i, j;
+   u_long tmp_resp_counter;
+
+   /* Alloc memory for the 404 errors with resp_counter size */
+   void * tmp_ptr = calloc(resp_counter, sizeof(struct responsetmp_url));
+   if (tmp_ptr) {
+       respnotfoundtmp = (struct responsetmp_url *) tmp_ptr;
+   } else {
+       fprintf(stderr, "ERROR: Can't allocate enough memory\n");
+       exit(0);
+   }
+   
+   /* Sort the 404 error strings */
+   for (i=0;i<(resp_counter-1);i++) {
+      for (j=0;j<(resp_counter-1-i);j++) {
+         if (respnotfound[j].count < respnotfound[j+1].count) {
+            strncpy(respnotfoundtmp[0].respurl,respnotfound[j].respurl,
+                  sizeof(respnotfoundtmp[0].respurl)-1);
+            respnotfoundtmp[0].respurl[sizeof(respnotfoundtmp[0].respurl)-1]='\0';
+            respnotfoundtmp[0].count = respnotfound[j].count;
+            strncpy(respnotfound[j].respurl,respnotfound[j+1].respurl,
+                  sizeof(respnotfound[j].respurl)-1);
+            respnotfound[j].respurl[sizeof(respnotfound[j].respurl)-1]='\0';
+            respnotfound[j].count = respnotfound[j+1].count;
+            strncpy(respnotfound[j+1].respurl,respnotfoundtmp[0].respurl,
+                  sizeof(respnotfound[j+1].respurl)-1);
+            respnotfound[j+1].respurl[sizeof(respnotfound[j+1].respurl)-1]='\0';
+            respnotfound[j+1].count = respnotfoundtmp[0].count;
+         }
+      }
+   }
+   
+   /* Print a 404 error table */
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 " \
+           "CELLPADDING=1>\n",table_border);
+   fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
+   
+   /* Change table header according to ntop_notfound & resp_counter */
+   if (ntop_notfound==1) {
+      fprintf(out_fp,"<TR><TH COLSPAN=5 BGCOLOR=\"%s\" ALIGN=center>" \
+              "Code 404 %s %s %d (%lu %s)</TH></TR>\n",HEADLINECOLOR,msg_mtot_ms,
+	      l_month[cur_month-1],cur_year,resp_counter,msg_hlnk_u);
+   } else {
+      if (resp_counter < ntop_notfound) {
+         fprintf(out_fp,"<TR><TH COLSPAN=5 BGCOLOR=\"%s\" ALIGN=center>" \
+	         "Code 404 %s %s %d (%s %lu %s %lu %s)</TH></TR>\n",HEADLINECOLOR,
+	         msg_mtot_ms,l_month[cur_month-1],cur_year,msg_top_top,
+	         resp_counter,msg_top_of,resp_counter,msg_hlnk_u);
+      } else {
+         fprintf(out_fp,"<TR><TH COLSPAN=5 BGCOLOR=\"%s\" ALIGN=center>" \
+	         "Code 404 %s %s %d (%s %i %s %lu %s)</TH></TR>\n",HEADLINECOLOR,
+	         msg_mtot_ms,l_month[cur_month-1],cur_year,msg_top_top,
+	         ntop_notfound,msg_top_of,resp_counter,msg_hlnk_u);
+      }
+   }
+   fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
+   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=center>" \
+           "<FONT SIZE=\"-1\">#</FONT></TH>\n",COUNTERCOLOR);
+   fprintf(out_fp,"<TH COLSPAN=2 BGCOLOR=\"%s\" ALIGN=center>" \
+           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HITCOLOR,msg_h_hits);
+   fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center>" \
+           "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",PAGECOLOR,msg_h_url);
+   fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
+
+   /* Show all 404's if ntop_notfound=1 else show preferred number */
+   if (resp_counter > ntop_notfound && ntop_notfound!=1) {
+      tmp_resp_counter=ntop_notfound;
+   } else {
+      tmp_resp_counter=resp_counter;
+   }
+   
+   for (i=0;i<tmp_resp_counter;i++) {
+      fprintf(out_fp,"<TR><TD ALIGN=center><FONT SIZE=\"-1\"><B>%i</B>" \
+              "</FONT></TD>\n",i+1);
+      fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\"><B>%lu</B>" \
+	      "</FONT></TD>\n",respnotfound[i].count+1);
+      fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT>" \
+	      "</TD>\n",PCENT( (respnotfound[i].count+1), response[21].count) );
+      /* check for a service prefix (ie: http://) */
+      if (strstr(respnotfound[i].respurl,"://")!=NULL) {
+         fprintf(out_fp,"<TD ALIGN=left><FONT SIZE=-1><A HREF=\"%s\">%s</A>" \
+         "</FONT></TD></TR>\n",respnotfound[i].respurl,respnotfound[i].respurl);
+      } else {
+         if (log_type == LOG_FTP) { /* FTP log? */
+            fprintf(out_fp,"<TD ALIGN=left><FONT SIZE=-1>%s</FONT></TD></TR>\n",
+               respnotfound[i].respurl);
+         } else { /* Web log  */
+            if (use_https) {
+               /* secure server mode, use https:// */
+               fprintf(out_fp,"<TD ALIGN=left><FONT SIZE=-1><A HREF=\"https://%s%s\">%s</A>" \
+               "</FONT></TD></TR>\n",hname,respnotfound[i].respurl,respnotfound[i].respurl);
+            } else {
+               /* otherwise use standard http:// */
+               fprintf(out_fp,"<TD ALIGN=left><FONT SIZE=-1><A HREF=\"http://%s%s\">%s</A>" \
+               "</FONT></TD></TR>\n",hname,respnotfound[i].respurl,respnotfound[i].respurl);
+            }
+         }
+      }
+   }
+
+   /* additionally show all 404's on a single page? */
+   if (all_errors) {
+      if (all_errors_page()) {
+         fprintf(out_fp,"<TR BGCOLOR=\"%s\">",GRPCOLOR);
+         fprintf(out_fp,"<TD COLSPAN=6 ALIGN=\"center\">\n");
+         fprintf(out_fp,"<FONT SIZE=\"-1\">");
+         fprintf(out_fp,"<A HREF=\"./error_%04d%02d.%s\">",
+                    cur_year,cur_month,html_ext);
+         fprintf(out_fp,"%s</A></FONT></TD></TR>\n",msg_v_urls);
+      }
+   }
+
+   fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
+   fprintf(out_fp,"</TABLE>\n");
+   fprintf(out_fp,"<P>\n");
+
+   free(respnotfoundtmp); /* free temp memory */
+}
+
+/*********************************************/
+/* ALL_ERRORS_PAGE - HTML page of all 404's  */
+/*********************************************/
+
+int all_errors_page()
+{
+   FILE     *out_fp;
+   char     error_fname[256], buffer[256];
+   int i;
+
+   /* generate file name */
+   snprintf(error_fname,sizeof(error_fname),"error_%04d%02d.%s",
+            cur_year,cur_month,html_ext);
+
+   /* open file */
+   if ( (out_fp=open_out_file(error_fname))==NULL ) return 0;
+
+   snprintf(buffer,sizeof(buffer),"%s %d - %s",
+            l_month[cur_month-1],cur_year,msg_h_url);
+   write_html_head(buffer, out_fp);
+
+   fprintf(out_fp,"<FONT SIZE=\"-1\"></CENTER><PRE>\n");
+
+   fprintf(out_fp,"%12s              %s\n",msg_h_hits,msg_h_url);
+   fprintf(out_fp,"----------------  --------------------\n\n");
+
+   for (i=0;i<resp_counter;i++) {
+      fprintf(out_fp,"%-8lu %6.02f%%  %s\n", respnotfound[i].count+1,
+          PCENT( (respnotfound[i].count+1), response[21].count),
+          respnotfound[i].respurl);
+   }
+
+   fprintf(out_fp,"</PRE></FONT>\n");
+   write_html_tail(out_fp);
+   fclose(out_fp);
+   return 1;
 }
 
 /*********************************************/
@@ -659,14 +954,46 @@
    int i,j;
 
    /* Daily stats */
-   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+           table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    /* Daily statistics for ... */
-   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" COLSPAN=13 ALIGN=center>"          \
-           "%s %s %d</TH></TR>\n",
-           GREY,msg_dtot_ds,l_month[cur_month-1], cur_year);
+   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" COLSPAN=\"%i\" ALIGN=center>"      \
+           "%s %s %d</TH></TR>\n",HEADLINECOLOR,j=(!hide_iovol)?17:13,
+           msg_dtot_ds,l_month[cur_month-1], cur_year);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   fprintf(out_fp,"<TR><TH ALIGN=center BGCOLOR=\"%s\">"                     \
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"<TR><TH ALIGN=center BGCOLOR=\"%s\">"                  \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",
+                  COUNTERCOLOR, msg_h_day,
+                  HITCOLOR,     msg_h_hits,
+                  FILECOLOR,    msg_h_files,
+                  PAGECOLOR,    msg_h_pages,
+                  VISITCOLOR,   msg_h_visits,
+                  SITECOLOR,    msg_h_sites,
+                  KBYTECOLOR,   msg_h_xfer,
+                  FILECOLOR,    msg_h_ixfer,
+                  HITCOLOR,     msg_h_oxfer);
+   }else
+   {
+      fprintf(out_fp,"<TR><TH ALIGN=center BGCOLOR=\"%s\">"                  \
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
@@ -680,13 +1007,14 @@
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n"                       \
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"               \
                   "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",
-                  GREY,       msg_h_day,
-                  HITCOLOR,   msg_h_hits,
-                  FILECOLOR,  msg_h_files,
-                  PAGECOLOR,  msg_h_pages,
-                  VISITCOLOR, msg_h_visits,
-                  SITECOLOR,  msg_h_sites,
-                  KBYTECOLOR, msg_h_xfer);
+                  COUNTERCOLOR, msg_h_day,
+                  HITCOLOR,     msg_h_hits,
+                  FILECOLOR,    msg_h_files,
+                  PAGECOLOR,    msg_h_pages,
+                  VISITCOLOR,   msg_h_visits,
+                  SITECOLOR,    msg_h_sites,
+                  KBYTECOLOR,   msg_h_xfer);
+   }
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
 
    /* skip beginning blank days in a month */
@@ -721,9 +1049,20 @@
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n",
               tm_site[i],PCENT(tm_site[i],t_site));
       fprintf(out_fp,"<TD ALIGN=right>"                                      \
-              "<FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n"                  \
+              "<FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"                    \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n",
+              hr_size(tm_xfer[i]),PCENT(tm_xfer[i],t_xfer));
+      if (!hide_iovol)
+      {
+         fprintf(out_fp,"<TD ALIGN=right>"                                   \
+              "<FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"                    \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n",
+              hr_size(tm_ixfer[i]),PCENT(tm_ixfer[i],t_ixfer));
+         fprintf(out_fp,"<TD ALIGN=right>"                                   \
+              "<FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"                    \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD></TR>\n",
-              tm_xfer[i]/1024,PCENT(tm_xfer[i],t_xfer));
+              hr_size(tm_oxfer[i]),PCENT(tm_oxfer[i],t_oxfer));
+      }
    }
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"</TABLE>\n");
@@ -736,20 +1075,23 @@
 
 void hourly_total_table()
 {
-   int       i,days_in_month;
+   int       i,j,days_in_month;
    u_int64_t avg_file=0;
-   double    avg_xfer=0.0;
+   double    avg_xfer=0.0,avg_ixfer=0.0,avg_oxfer=0.0;
 
    days_in_month=(l_day-f_day)+1;
 
    /* Hourly stats */
-   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+           table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" COLSPAN=13 ALIGN=center>"\
-           "%s %s %d</TH></TR>\n",
-           GREY,msg_htot_hs,l_month[cur_month-1], cur_year);
+   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" COLSPAN=\"%i\" ALIGN=center>" \
+           "%s %s %d</TH></TR>\n",HEADLINECOLOR,j=(!hide_iovol)?19:13,
+           msg_htot_hs,l_month[cur_month-1], cur_year);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   fprintf(out_fp,"<TR><TH ALIGN=center ROWSPAN=2 BGCOLOR=\"%s\">" \
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"<TR><TH ALIGN=center ROWSPAN=2 BGCOLOR=\"%s\">" \
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n"             \
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n"             \
@@ -758,12 +1100,36 @@
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n"             \
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
                   "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",
-                  GREY,       msg_h_hour,
-                  HITCOLOR,   msg_h_hits,
-                  FILECOLOR,  msg_h_files,
-                  PAGECOLOR,  msg_h_pages,
-                  KBYTECOLOR, msg_h_xfer);
+                  COUNTERCOLOR, msg_h_hour,
+                  HITCOLOR,     msg_h_hits,
+                  FILECOLOR,    msg_h_files,
+                  PAGECOLOR,    msg_h_pages,
+                  KBYTECOLOR,   msg_h_xfer,
+                  FILECOLOR,    msg_h_ixfer,
+                  HITCOLOR,     msg_h_oxfer);
+   }else
+   {
+      fprintf(out_fp,"<TR><TH ALIGN=center ROWSPAN=2 BGCOLOR=\"%s\">" \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"             \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"             \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"             \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n"             \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=3>"     \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",
+                  COUNTERCOLOR, msg_h_hour,
+                  HITCOLOR,     msg_h_hits,
+                  FILECOLOR,    msg_h_files,
+                  PAGECOLOR,    msg_h_pages,
+                  KBYTECOLOR,   msg_h_xfer);
+   }
    fprintf(out_fp,"<TR><TH ALIGN=center BGCOLOR=\"%s\">"           \
                   "<FONT SIZE=\"-2\">%s</FONT></TH>\n"             \
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"     \
@@ -782,9 +1148,22 @@
    fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"               \
                   "<FONT SIZE=\"-2\">%s</FONT></TH>\n"             \
                   "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"     \
-                  "<FONT SIZE=\"-2\">%s</FONT></TH></TR>\n",
+                  "<FONT SIZE=\"-2\">%s</FONT></TH>\n",
                   KBYTECOLOR, msg_h_avg, KBYTECOLOR, msg_h_total);
-
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"            \
+                  "<FONT SIZE=\"-2\">%s</FONT></TH>\n"             \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"     \
+                  "<FONT SIZE=\"-2\">%s</FONT></TH>\n",
+                  FILECOLOR, msg_h_avg, FILECOLOR, msg_h_total);
+      fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"            \
+                  "<FONT SIZE=\"-2\">%s</FONT></TH>\n"             \
+                  "<TH ALIGN=center BGCOLOR=\"%s\" COLSPAN=2>"     \
+                  "<FONT SIZE=\"-2\">%s</FONT></TH></TR>\n",
+                  HITCOLOR, msg_h_avg, HITCOLOR, msg_h_total);
+   }
+   
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    for (i=0;i<24;i++)
    {
@@ -809,13 +1188,30 @@
          th_page[i]/days_in_month,th_page[i],
          PCENT(th_page[i],t_page));
       fprintf(out_fp,
-         "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
-         "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
-         "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD></TR>\n",
-         (th_xfer[i]/days_in_month)/1024,th_xfer[i]/1024,
+         "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n" \
+         "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n" \
+         "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n",
+         hr_size(th_xfer[i]/days_in_month),hr_size(th_xfer[i]),
          PCENT(th_xfer[i],t_xfer));
+      if (!hide_iovol)
+      {
+         fprintf(out_fp,
+            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n" \
+            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n" \
+            "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n",
+            hr_size(th_ixfer[i]/days_in_month),hr_size(th_ixfer[i]),
+            PCENT(th_ixfer[i],t_ixfer));
+         fprintf(out_fp,
+            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n" \
+            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n" \
+            "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD></TR>\n",
+            hr_size(th_oxfer[i]/days_in_month),hr_size(th_oxfer[i]),
+            PCENT(th_oxfer[i],t_oxfer));
+      }
       avg_file += th_file[i]/days_in_month;
-      avg_xfer+= (th_xfer[i]/days_in_month)/1024;
+      avg_xfer += (th_xfer[i]/days_in_month)/1024;
+      avg_ixfer+= (th_ixfer[i]/days_in_month)/1024;
+      avg_oxfer+= (th_oxfer[i]/days_in_month)/1024;
    }
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"</TABLE>\n<P>\n");
@@ -828,14 +1224,14 @@
 void top_sites_table(int flag)
 {
    u_int64_t cnt=0, h_reg=0, h_grp=0, h_hid=0, tot_num;
-   int       i;
+   int       i,j;
    HNODEPTR  hptr, *pointer;
 
    cnt=a_ctr; pointer=h_array;
    while(cnt--)
    {
       /* calculate totals */
-      switch ( (int)((HNODEPTR)(*pointer)->flag) )
+      switch ((*pointer)->flag)
       {
          case OBJ_REG:   h_reg++;  break;
          case OBJ_GRP:   h_grp++;  break;
@@ -851,24 +1247,33 @@
    if ((!flag) || (flag&&!ntop_sites))                  /* now do <A> tag   */
       fprintf(out_fp,"<A NAME=\"TOPSITES\"></A>\n");
 
-   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+           table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   if (flag) fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=10>" \
+   if (flag) fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=\"%i\">" \
            "%s %llu %s %llu %s %s %s</TH></TR>\n",
-           GREY, msg_top_top,tot_num,msg_top_of,
+           HEADLINECOLOR,j=(!hide_iovol)?14:10,msg_top_top,tot_num,msg_top_of,
            t_site,msg_top_s,msg_h_by,msg_h_xfer);
-   else      fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=10>" \
+   else      fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=\"%i\">" \
            "%s %llu %s %llu %s</TH></TR>\n",
-           GREY,msg_top_top, tot_num, msg_top_of, t_site, msg_top_s);
+           HEADLINECOLOR,j=(!hide_iovol)?14:10,msg_top_top, tot_num, msg_top_of,
+           t_site, msg_top_s);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=center>"                    \
-          "<FONT SIZE=\"-1\">#</FONT></TH>\n",GREY);
+          "<FONT SIZE=\"-1\">#</FONT></TH>\n",COUNTERCOLOR);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"              \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HITCOLOR,msg_h_hits);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"              \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",FILECOLOR,msg_h_files);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"              \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",KBYTECOLOR,msg_h_xfer);
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"           \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",FILECOLOR,msg_h_ixfer);
+      fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"           \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HITCOLOR,msg_h_oxfer);
+   }
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"              \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",VISITCOLOR,msg_h_visits);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center>"                        \
@@ -886,23 +1291,51 @@
             fprintf(out_fp,"<TR BGCOLOR=\"%s\">\n", GRPCOLOR);
          else fprintf(out_fp,"<TR>\n");
 
-         fprintf(out_fp,
+	 if (!hide_iovol)
+         {
+            fprintf(out_fp,
               "<TD ALIGN=center><FONT SIZE=\"-1\"><B>%d</B></FONT></TD>\n"  \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
-              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"   \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=left NOWRAP><FONT SIZE=\"-1\">",
               i+1,hptr->count,
               (t_hit==0)?0:((float)hptr->count/t_hit)*100.0,hptr->files,
-              (t_file==0)?0:((float)hptr->files/t_file)*100.0,hptr->xfer/1024,
+              (t_file==0)?0:((float)hptr->files/t_file)*100.0,hr_size(hptr->xfer),
+              (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hr_size(hptr->ixfer),
+              (t_ixfer==0)?0:((float)hptr->ixfer/t_ixfer)*100.0,hr_size(hptr->oxfer),
+              (t_oxfer==0)?0:((float)hptr->oxfer/t_oxfer)*100.0,hptr->visit,
+              (t_visit==0)?0:((float)hptr->visit/t_visit)*100.0);
+	 }
+	 else
+	 {
+            fprintf(out_fp,
+              "<TD ALIGN=center><FONT SIZE=\"-1\"><B>%d</B></FONT></TD>\n"  \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=left NOWRAP><FONT SIZE=\"-1\">",
+              i+1,hptr->count,
+              (t_hit==0)?0:((float)hptr->count/t_hit)*100.0,hptr->files,
+              (t_file==0)?0:((float)hptr->files/t_file)*100.0,hr_size(hptr->xfer),
               (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hptr->visit,
               (t_visit==0)?0:((float)hptr->visit/t_visit)*100.0);
-
+	 }
+	 
          if ((hptr->flag==OBJ_GRP)&&hlite_groups)
              fprintf(out_fp,"<STRONG>%s</STRONG></FONT></TD></TR>\n",
                hptr->string);
@@ -921,11 +1354,11 @@
          if (all_sites_page(h_reg, h_grp))
          {
             fprintf(out_fp,"<TR BGCOLOR=\"%s\">",GRPCOLOR);
-            fprintf(out_fp,"<TD COLSPAN=10 ALIGN=\"center\">\n");
+            fprintf(out_fp,"<TD COLSPAN=\"%i\" ALIGN=\"center\">\n",j=(!hide_iovol)?14:10);
             fprintf(out_fp,"<FONT SIZE=\"-1\">");
             fprintf(out_fp,"<A HREF=\"./site_%04d%02d.%s\">",
                     cur_year,cur_month,html_ext);
-            fprintf(out_fp,"%s</A></TD></TR>\n",msg_v_sites);
+            fprintf(out_fp,"%s</A></FONT></TD></TR>\n",msg_v_sites);
             if (flag)   /* do we need to sort? */
                qsort(h_array,a_ctr,sizeof(HNODEPTR),qs_site_cmph);
          }
@@ -958,10 +1391,24 @@
 
    fprintf(out_fp,"<FONT SIZE=\"-1\"></CENTER><PRE>\n");
 
-   fprintf(out_fp," %12s      %12s      %12s      %12s      %s\n",
-           msg_h_hits, msg_h_files, msg_h_xfer, msg_h_visits, msg_h_hname);
-   fprintf(out_fp,"----------------  ----------------  ----------------  " \
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"%12s      %12s       %12s         %12s          %12s"   \
+                  "       %12s           %s\n",
+           msg_h_hits, msg_h_files, msg_h_xfer, msg_h_ixfer, msg_h_oxfer, 
+           msg_h_visits, msg_h_hname);
+      fprintf(out_fp,"----------------  ----------------  -------------------  " \
+                  "-------------------  -------------------  "                \
                   "----------------  --------------------\n\n");
+   }else
+   {
+      fprintf(out_fp,"%12s      %12s       %12s"   \
+                  "       %12s         %s\n",
+           msg_h_hits, msg_h_files, msg_h_xfer, 
+           msg_h_visits, msg_h_hname);
+      fprintf(out_fp,"----------------  ----------------  -------------------  " \
+                  "----------------  ---------------\n\n");
+   }
 
    /* Do groups first (if any) */
    pointer=h_array;
@@ -970,15 +1417,31 @@
       hptr=*pointer++;
       if (hptr->flag == OBJ_GRP)
       {
-         fprintf(out_fp,
-            "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  "            \
+	 if (!hide_iovol)
+	 {
+            fprintf(out_fp,
+            "%-8llu %6.02f%%  %8llu %6.02f%%  %16s %6.02f%%  %16s %6.02f%%  " \
+            "%16s %6.02f%%  %8llu %6.02f%%  %s\n",
+            hptr->count,
+            (t_hit==0)?0:((float)hptr->count/t_hit)*100.0,hptr->files,
+            (t_file==0)?0:((float)hptr->files/t_file)*100.0,hr_size(hptr->xfer),
+            (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hr_size(hptr->ixfer),
+            (t_ixfer==0)?0:((float)hptr->ixfer/t_ixfer)*100.0,hr_size(hptr->oxfer),
+            (t_oxfer==0)?0:((float)hptr->oxfer/t_oxfer)*100.0,hptr->visit,
+            (t_visit==0)?0:((float)hptr->visit/t_visit)*100.0,
+            hptr->string);
+         }else
+         {
+            fprintf(out_fp,
+            "%-8llu %6.02f%%  %8llu %6.02f%%  %16s %6.02f%%  " \
             "%8llu %6.02f%%  %s\n",
             hptr->count,
             (t_hit==0)?0:((float)hptr->count/t_hit)*100.0,hptr->files,
-            (t_file==0)?0:((float)hptr->files/t_file)*100.0,hptr->xfer/1024,
+            (t_file==0)?0:((float)hptr->files/t_file)*100.0,hr_size(hptr->xfer),
             (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hptr->visit,
             (t_visit==0)?0:((float)hptr->visit/t_visit)*100.0,
             hptr->string);
+         }
          h_grp--;
       }
    }
@@ -992,15 +1455,31 @@
       hptr=*pointer++;
       if (hptr->flag == OBJ_REG)
       {
-         fprintf(out_fp,
-            "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  "            \
+	 if (!hide_iovol)
+	 {
+            fprintf(out_fp,
+            "%-8llu %6.02f%%  %8llu %6.02f%%  %16s %6.02f%%  %16s %6.02f%%  " \
+            "%16s %6.02f%%  %8llu %6.02f%%  %s\n",
+            hptr->count,
+            (t_hit==0)?0:((float)hptr->count/t_hit)*100.0,hptr->files,
+            (t_file==0)?0:((float)hptr->files/t_file)*100.0,hr_size(hptr->xfer),
+            (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hr_size(hptr->ixfer),
+            (t_ixfer==0)?0:((float)hptr->ixfer/t_ixfer)*100.0,hr_size(hptr->oxfer),
+            (t_oxfer==0)?0:((float)hptr->oxfer/t_oxfer)*100.0,hptr->visit,
+            (t_visit==0)?0:((float)hptr->visit/t_visit)*100.0,
+            hptr->string);
+         }else
+         {
+            fprintf(out_fp,
+            "%-8llu %6.02f%%  %8llu %6.02f%%  %16s %6.02f%%  " \
             "%8llu %6.02f%%  %s\n",
             hptr->count,
             (t_hit==0)?0:((float)hptr->count/t_hit)*100.0,hptr->files,
-            (t_file==0)?0:((float)hptr->files/t_file)*100.0,hptr->xfer/1024,
+            (t_file==0)?0:((float)hptr->files/t_file)*100.0,hr_size(hptr->xfer),
             (t_xfer==0)?0:((float)hptr->xfer/t_xfer)*100.0,hptr->visit,
             (t_visit==0)?0:((float)hptr->visit/t_visit)*100.0,
             hptr->string);
+         }
          h_reg--;
       }
    }
@@ -1018,14 +1497,14 @@
 void top_urls_table(int flag)
 {
    u_int64_t cnt=0,u_reg=0,u_grp=0,u_hid=0, tot_num;
-   int       i;
+   int       i,j;
    UNODEPTR  uptr, *pointer;
 
    cnt=a_ctr; pointer=u_array;
    while (cnt--)
    {
       /* calculate totals */
-      switch ( (int)((UNODEPTR)(*pointer)->flag) )
+      switch ((*pointer)->flag)
       {
          case OBJ_REG:  u_reg++;  break;
          case OBJ_GRP:  u_grp++;  break;
@@ -1040,24 +1519,35 @@
    if ((!flag) || (flag&&!ntop_urls))                   /* now do <A> tag   */
       fprintf(out_fp,"<A NAME=\"TOPURLS\"></A>\n");
 
-   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+           table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   if (flag) fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=6>"  \
+   if (flag) fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=\"%i\">"  \
            "%s %llu %s %llu %s %s %s</TH></TR>\n",
-           GREY,msg_top_top,tot_num,msg_top_of,
+           HEADLINECOLOR,j=(!hide_iovol)?10:6,msg_top_top,tot_num,msg_top_of,
            t_url,msg_top_u,msg_h_by,msg_h_xfer);
-   else fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=6>"   \
+   else fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=\"%i\">"   \
            "%s %llu %s %llu %s</TH></TR>\n",
-           GREY,msg_top_top,tot_num,msg_top_of,t_url,msg_top_u);
+           HEADLINECOLOR,j=(!hide_iovol)?10:6,msg_top_top,tot_num,msg_top_of,
+           t_url,msg_top_u);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=center>"                  \
-                  "<FONT SIZE=\"-1\">#</FONT></TH>\n",GREY);
+                  "<FONT SIZE=\"-1\">#</FONT></TH>\n",COUNTERCOLOR);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"            \
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n",
                   HITCOLOR,msg_h_hits);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"            \
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n",
                   KBYTECOLOR,msg_h_xfer);
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"         \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n",
+                  FILECOLOR,msg_h_ixfer);
+      fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"         \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n",
+                  HITCOLOR,msg_h_oxfer);
+   }
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center>"                      \
                   "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",
                   MISCCOLOR,msg_h_url);
@@ -1074,17 +1564,41 @@
             fprintf(out_fp,"<TR BGCOLOR=\"%s\">\n", GRPCOLOR);
          else fprintf(out_fp,"<TR>\n");
 
-         fprintf(out_fp,
+         if (!hide_iovol)
+         {
+            fprintf(out_fp,
             "<TD ALIGN=center><FONT SIZE=\"-1\"><B>%d</B></FONT></TD>\n" \
             "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n"\
             "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
-            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n"\
+            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"  \
+            "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"  \
+            "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"  \
             "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
             "<TD ALIGN=left NOWRAP><FONT SIZE=\"-1\">",
             i+1,uptr->count,
             (t_hit==0)?0:((float)uptr->count/t_hit)*100.0,
-            uptr->xfer/1024,
+            hr_size(uptr->xfer),
+            (t_xfer==0)?0:((float)uptr->xfer/t_xfer)*100.0,
+            hr_size(uptr->ixfer),
+            (t_ixfer==0)?0:((float)uptr->ixfer/t_ixfer)*100.0,
+            hr_size(uptr->oxfer),
+            (t_oxfer==0)?0:((float)uptr->oxfer/t_oxfer)*100.0);
+         }else
+         {
+            fprintf(out_fp,
+            "<TD ALIGN=center><FONT SIZE=\"-1\"><B>%d</B></FONT></TD>\n" \
+            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n"\
+            "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+            "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"  \
+            "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+            "<TD ALIGN=left NOWRAP><FONT SIZE=\"-1\">",
+            i+1,uptr->count,
+            (t_hit==0)?0:((float)uptr->count/t_hit)*100.0,
+            hr_size(uptr->xfer),
             (t_xfer==0)?0:((float)uptr->xfer/t_xfer)*100.0);
+         }
 
          if (uptr->flag==OBJ_GRP)
          {
@@ -1130,11 +1644,11 @@
          if (all_urls_page(u_reg, u_grp))
          {
             fprintf(out_fp,"<TR BGCOLOR=\"%s\">",GRPCOLOR);
-            fprintf(out_fp,"<TD COLSPAN=6 ALIGN=\"center\">\n");
+            fprintf(out_fp,"<TD COLSPAN=\"%i\" ALIGN=\"center\">\n",j=(!hide_iovol)?10:6);
             fprintf(out_fp,"<FONT SIZE=\"-1\">");
             fprintf(out_fp,"<A HREF=\"./url_%04d%02d.%s\">",
                     cur_year,cur_month,html_ext);
-            fprintf(out_fp,"%s</A></TD></TR>\n",msg_v_urls);
+            fprintf(out_fp,"%s</A></FONT></TD></TR>\n",msg_v_urls);
             if (flag)   /* do we need to sort first? */
                qsort(u_array,a_ctr,sizeof(UNODEPTR),qs_url_cmph);
          }
@@ -1167,10 +1681,19 @@
 
    fprintf(out_fp,"<FONT SIZE=\"-1\"></CENTER><PRE>\n");
 
-   fprintf(out_fp," %12s      %12s      %s\n",
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"%12s       %12s         %12s          %12s               %s\n",
+           msg_h_hits,msg_h_xfer,msg_h_ixfer,msg_h_oxfer,msg_h_url);
+      fprintf(out_fp,"----------------  -------------------  -------------------  " \
+                  "-------------------  --------------------\n\n");
+   }else
+   {
+      fprintf(out_fp,"%12s       %12s               %s\n",
            msg_h_hits,msg_h_xfer,msg_h_url);
-   fprintf(out_fp,"----------------  ----------------  " \
+      fprintf(out_fp,"----------------  -------------------  " \
                   "--------------------\n\n");
+   }
 
    /* do groups first (if any) */
    pointer=u_array;
@@ -1179,12 +1702,28 @@
       uptr=*pointer++;
       if (uptr->flag == OBJ_GRP)
       {
-         fprintf(out_fp,"%-8llu %6.02f%%  %8.0f %6.02f%%  %s\n",
+	 if (!hide_iovol)
+	 {
+            fprintf(out_fp,"%-8llu %6.02f%%  %16s %6.02f%%  %16s %6.02f%%  " \
+         	        "%16s %6.02f%%  %s\n",
+            uptr->count,
+            (t_hit==0)?0:((float)uptr->count/t_hit)*100.0,
+            hr_size(uptr->xfer),
+            (t_xfer==0)?0:((float)uptr->xfer/t_xfer)*100.0,
+            hr_size(uptr->ixfer),
+            (t_ixfer==0)?0:((float)uptr->ixfer/t_ixfer)*100.0,
+            hr_size(uptr->oxfer),
+            (t_oxfer==0)?0:((float)uptr->oxfer/t_oxfer)*100.0,
+            uptr->string);
+         }else
+         {
+            fprintf(out_fp,"%-8llu %6.02f%%  %16s %6.02f%%  %s\n",
             uptr->count,
             (t_hit==0)?0:((float)uptr->count/t_hit)*100.0,
-            uptr->xfer/1024,
+            hr_size(uptr->xfer),
             (t_xfer==0)?0:((float)uptr->xfer/t_xfer)*100.0,
             uptr->string);
+         }
          u_grp--;
       }
    }
@@ -1198,12 +1737,28 @@
       uptr=*pointer++;
       if (uptr->flag == OBJ_REG)
       {
-         fprintf(out_fp,"%-8llu %6.02f%%  %8.0f %6.02f%%  %s\n",
+	 if (!hide_iovol)
+	 {
+            fprintf(out_fp,"%-8llu %6.02f%%  %16s %6.02f%%  %16s %6.02f%%  " \
+         	        "%16s %6.02f%%  %s\n",
+            uptr->count,
+            (t_hit==0)?0:((float)uptr->count/t_hit)*100.0,
+            hr_size(uptr->xfer),
+            (t_xfer==0)?0:((float)uptr->xfer/t_xfer)*100.0,
+            hr_size(uptr->ixfer),
+            (t_ixfer==0)?0:((float)uptr->ixfer/t_ixfer)*100.0,
+            hr_size(uptr->oxfer),
+            (t_oxfer==0)?0:((float)uptr->oxfer/t_oxfer)*100.0,
+            uptr->string);
+         }else
+         {
+            fprintf(out_fp,"%-8llu %6.02f%%  %16s %6.02f%%  %s\n",
             uptr->count,
             (t_hit==0)?0:((float)uptr->count/t_hit)*100.0,
-            uptr->xfer/1024,
+            hr_size(uptr->xfer),
             (t_xfer==0)?0:((float)uptr->xfer/t_xfer)*100.0,
             uptr->string);
+         }
          u_reg--;
       }
    }
@@ -1228,12 +1783,12 @@
    cnt=a_ctr; pointer=u_array;
    while (cnt--)
    {
-      if ( (int)((UNODEPTR)(*pointer)->flag) == OBJ_REG )
+      if ((*pointer)->flag == OBJ_REG )
       {
-         if ( (u_int64_t)(((UNODEPTR)(*pointer))->entry) )
-            {  u_entry++; t_entry+=(u_int64_t)(((UNODEPTR)(*pointer))->entry); }
-         if ( (u_int64_t)(((UNODEPTR)(*pointer))->exit)  )
-            { u_exit++;   t_exit +=(u_int64_t)(((UNODEPTR)(*pointer))->exit);  }
+         if ((*pointer)->entry)  
+            {  u_entry++; t_entry+=((*pointer))->entry; }
+         if ((*pointer)->exit  )  
+            { u_exit++;   t_exit +=(*pointer)->exit;  }
       }
       pointer++;
    }
@@ -1249,16 +1804,17 @@
    if (flag) fprintf(out_fp,"<A NAME=\"TOPEXIT\"></A>\n"); /* do anchor tag */
    else      fprintf(out_fp,"<A NAME=\"TOPENTRY\"></A>\n");
 
-   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+           table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=6>"        \
            "%s %llu %s %llu %s</TH></TR>\n",
-           GREY,msg_top_top,tot_num,msg_top_of,
+           HEADLINECOLOR,msg_top_top,tot_num,msg_top_of,
            (flag)?u_exit:u_entry,(flag)?msg_top_ex:msg_top_en);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=center>"                  \
                   "<FONT SIZE=\"-1\">#</FONT></TH>\n",
-                  GREY);
+                  COUNTERCOLOR);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"            \
                   "<FONT SIZE=\"-1\">%s</FONT></TH>\n",
                   HITCOLOR,msg_h_hits);
@@ -1332,7 +1888,7 @@
    while(cnt--)
    {
       /* calculate totals */
-      switch ( (int)((RNODEPTR)(*pointer)->flag) )
+      switch ((*pointer)->flag)
       {
          case OBJ_REG:  r_reg++;  break;
          case OBJ_HIDE: r_hid++;  break;
@@ -1345,15 +1901,16 @@
    if (tot_num > ntop_refs) tot_num=ntop_refs;          /* get max to do... */
 
    fprintf(out_fp,"<A NAME=\"TOPREFS\"></A>\n");
-   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+           table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=4>"         \
            "%s %llu %s %llu %s</TH></TR>\n",
-           GREY, msg_top_top, tot_num, msg_top_of, t_ref, msg_top_r);
+           HEADLINECOLOR, msg_top_top, tot_num, msg_top_of, t_ref, msg_top_r);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=center>"                   \
           "<FONT SIZE=\"-1\">#</FONT></TH>\n",
-          GREY);
+          COUNTERCOLOR);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",
           HITCOLOR,msg_h_hits);
@@ -1411,7 +1968,7 @@
          fprintf(out_fp,"<FONT SIZE=\"-1\">");
          fprintf(out_fp,"<A HREF=\"./ref_%04d%02d.%s\">",
                  cur_year,cur_month,html_ext);
-         fprintf(out_fp,"%s</A></TD></TR>\n",msg_v_refs);
+         fprintf(out_fp,"%s</A></FONT></TD></TR>\n",msg_v_refs);
       }
    }
    fprintf(out_fp,"</TABLE>\n<P>\n");
@@ -1441,7 +1998,7 @@
 
    fprintf(out_fp,"<FONT SIZE=\"-1\"></CENTER><PRE>\n");
 
-   fprintf(out_fp," %12s      %s\n",msg_h_hits,msg_h_ref);
+   fprintf(out_fp,"%12s            %s\n",msg_h_hits,msg_h_ref);
    fprintf(out_fp,"----------------  --------------------\n\n");
 
    /* do groups first (if any) */
@@ -1497,7 +2054,7 @@
    while(cnt--)
    {
       /* calculate totals */
-      switch ( (int)((ANODEPTR)(*pointer)->flag) )
+      switch ((*pointer)->flag)
       {
          case OBJ_REG:   a_reg++;  break;
          case OBJ_GRP:   a_grp++;  break;
@@ -1510,15 +2067,16 @@
    if (tot_num > ntop_agents) tot_num=ntop_agents;      /* get max to do... */
 
    fprintf(out_fp,"<A NAME=\"TOPAGENTS\"></A>\n");
-   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+           table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=4>"        \
           "%s %llu %s %llu %s</TH></TR>\n",
-          GREY, msg_top_top, tot_num, msg_top_of, t_agent, msg_top_a);
+          HEADLINECOLOR, msg_top_top, tot_num, msg_top_of, t_agent, msg_top_a);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=center>"                  \
           "<FONT SIZE=\"-1\">#</FONT></TH>\n",
-          GREY);
+          COUNTERCOLOR);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"            \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",
           HITCOLOR,msg_h_hits);
@@ -1565,7 +2123,7 @@
          fprintf(out_fp,"<FONT SIZE=\"-1\">");
          fprintf(out_fp,"<A HREF=\"./agent_%04d%02d.%s\">",
                  cur_year,cur_month,html_ext);
-         fprintf(out_fp,"%s</A></TD></TR>\n",msg_v_agents);
+         fprintf(out_fp,"%s</A></FONT></TD></TR>\n",msg_v_agents);
       }
    }
    fprintf(out_fp,"</TABLE>\n<P>\n");
@@ -1595,7 +2153,7 @@
 
    fprintf(out_fp,"<FONT SIZE=\"-1\"></CENTER><PRE>\n");
 
-   fprintf(out_fp," %12s      %s\n",msg_h_hits,msg_h_agent);
+   fprintf(out_fp,"%12s         %s\n",msg_h_hits,msg_h_agent);
    fprintf(out_fp,"----------------  ----------------------\n\n");
 
    /* do groups first (if any) */
@@ -1650,22 +2208,23 @@
    cnt=tot_num=a_ctr; pointer=s_array;
    while(cnt--)
    {
-      t_val+=(u_int64_t)(((SNODEPTR)(*pointer))->count);
+      t_val+=(*pointer)->count;
       pointer++;
    }
 
    if ( tot_num > ntop_search) tot_num=ntop_search;
 
    fprintf(out_fp,"<A NAME=\"TOPSEARCH\"></A>\n");
-   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+           table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=4>"        \
           "%s %llu %s %llu %s</TH></TR>\n",
-          GREY, msg_top_top, tot_num, msg_top_of, a_ctr, msg_top_sr);
+          HEADLINECOLOR, msg_top_top, tot_num, msg_top_of, a_ctr, msg_top_sr);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=center>"                  \
           "<FONT SIZE=\"-1\">#</FONT></TH>\n",
-          GREY);
+          COUNTERCOLOR);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"            \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",
           HITCOLOR,msg_h_hits);
@@ -1700,7 +2259,7 @@
          fprintf(out_fp,"<FONT SIZE=\"-1\">");
          fprintf(out_fp,"<A HREF=\"./search_%04d%02d.%s\">",
                  cur_year,cur_month,html_ext);
-         fprintf(out_fp,"%s</A></TD></TR>\n",msg_v_search);
+         fprintf(out_fp,"%s</A></FONT></TD></TR>\n",msg_v_search);
       }
    }
    fprintf(out_fp,"</TABLE>\n<P>\n");
@@ -1731,7 +2290,7 @@
 
    fprintf(out_fp,"<FONT SIZE=\"-1\"></CENTER><PRE>\n");
 
-   fprintf(out_fp," %12s      %s\n",msg_h_hits,msg_h_search);
+   fprintf(out_fp,"%12s              %s\n",msg_h_hits,msg_h_search);
    fprintf(out_fp,"----------------  ----------------------\n\n");
 
    pointer=s_array;
@@ -1757,14 +2316,14 @@
 void top_users_table()
 {
    u_int64_t cnt=0, i_reg=0, i_grp=0, i_hid=0, tot_num;
-   int       i;
+   int       i,j;
    INODEPTR  iptr, *pointer;
 
    cnt=a_ctr; pointer=i_array;
    while(cnt--)
    {
       /* calculate totals */
-      switch ( (int)((INODEPTR)(*pointer)->flag) )
+      switch ((*pointer)->flag)
       {
          case OBJ_REG:   i_reg++;  break;
          case OBJ_GRP:   i_grp++;  break;
@@ -1778,20 +2337,28 @@
 
    fprintf(out_fp,"<A NAME=\"TOPUSERS\"></A>\n");       /* now do <A> tag   */
 
-   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+           table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=10>" \
-           "%s %llu %s %llu %s</TH></TR>\n",
-           GREY,msg_top_top, tot_num, msg_top_of, t_user, msg_top_i);
+   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=\"%i\">" \
+           "%s %llu %s %llu %s</TH></TR>\n",HEADLINECOLOR,j=(!hide_iovol)?14:10,
+           msg_top_top, tot_num, msg_top_of, t_user, msg_top_i);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=center>"                   \
-          "<FONT SIZE=\"-1\">#</FONT></TH>\n",GREY);
+          "<FONT SIZE=\"-1\">#</FONT></TH>\n",COUNTERCOLOR);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HITCOLOR,msg_h_hits);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",FILECOLOR,msg_h_files);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",KBYTECOLOR,msg_h_xfer);
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"          \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",FILECOLOR,msg_h_ixfer);
+      fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"          \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HITCOLOR,msg_h_oxfer);
+   }
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",VISITCOLOR,msg_h_visits);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center>"                       \
@@ -1809,22 +2376,49 @@
             fprintf(out_fp,"<TR BGCOLOR=\"%s\">\n", GRPCOLOR);
          else fprintf(out_fp,"<TR>\n");
 
-         fprintf(out_fp,
+         if (!hide_iovol)
+         {
+            fprintf(out_fp,
               "<TD ALIGN=center><FONT SIZE=\"-1\"><B>%d</B></FONT></TD>\n"  \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
-              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"   \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
               "<TD ALIGN=left NOWRAP><FONT SIZE=\"-1\">",
               i+1,iptr->count,
               (t_hit==0)?0:((float)iptr->count/t_hit)*100.0,iptr->files,
-              (t_file==0)?0:((float)iptr->files/t_file)*100.0,iptr->xfer/1024,
+              (t_file==0)?0:((float)iptr->files/t_file)*100.0,hr_size(iptr->xfer),
+              (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,hr_size(iptr->ixfer),
+              (t_ixfer==0)?0:((float)iptr->ixfer/t_ixfer)*100.0,hr_size(iptr->oxfer),
+              (t_oxfer==0)?0:((float)iptr->oxfer/t_oxfer)*100.0,iptr->visit,
+              (t_visit==0)?0:((float)iptr->visit/t_visit)*100.0);
+         }else
+         {
+            fprintf(out_fp,
+              "<TD ALIGN=center><FONT SIZE=\"-1\"><B>%d</B></FONT></TD>\n"  \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"    \
+              "<TD ALIGN=left NOWRAP><FONT SIZE=\"-1\">",
+              i+1,iptr->count,
+              (t_hit==0)?0:((float)iptr->count/t_hit)*100.0,iptr->files,
+              (t_file==0)?0:((float)iptr->files/t_file)*100.0,hr_size(iptr->xfer),
               (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,iptr->visit,
               (t_visit==0)?0:((float)iptr->visit/t_visit)*100.0);
+         }
 
          if ((iptr->flag==OBJ_GRP)&&hlite_groups)
              fprintf(out_fp,"<STRONG>%s</STRONG></FONT></TD></TR>\n",
@@ -1842,11 +2436,11 @@
       if (all_users_page(i_reg, i_grp))
       {
          fprintf(out_fp,"<TR BGCOLOR=\"%s\">",GRPCOLOR);
-         fprintf(out_fp,"<TD COLSPAN=10 ALIGN=\"center\">\n");
+         fprintf(out_fp,"<TD COLSPAN=\"%i\" ALIGN=\"center\">\n",j=(!hide_iovol)?14:10);
          fprintf(out_fp,"<FONT SIZE=\"-1\">");
          fprintf(out_fp,"<A HREF=\"./user_%04d%02d.%s\">",
             cur_year,cur_month,html_ext);
-         fprintf(out_fp,"%s</A></TD></TR>\n",msg_v_users);
+         fprintf(out_fp,"%s</A></FONT></TD></TR>\n",msg_v_users);
       }
    }
    fprintf(out_fp,"</TABLE>\n<P>\n");
@@ -1876,10 +2470,22 @@
 
    fprintf(out_fp,"<FONT SIZE=\"-1\"></CENTER><PRE>\n");
 
-   fprintf(out_fp," %12s      %12s      %12s      %12s      %s\n",
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"%12s      %12s       %12s         %12s          %12s"\
+   	          "       %12s            %s\n",
+           msg_h_hits, msg_h_files, msg_h_xfer, msg_h_ixfer, msg_h_oxfer, 
+           msg_h_visits, msg_h_uname);
+      fprintf(out_fp,"----------------  ----------------  -------------------  " \
+   	          "-------------------  -------------------  "                \
+                  "----------------  --------------------\n\n");
+   }else
+   {
+      fprintf(out_fp,"%12s      %12s       %12s        %12s            %s\n",
            msg_h_hits, msg_h_files, msg_h_xfer, msg_h_visits, msg_h_uname);
-   fprintf(out_fp,"----------------  ----------------  ----------------  " \
+      fprintf(out_fp,"----------------  ----------------  -------------------  " \
                   "----------------  --------------------\n\n");
+   }
 
    /* Do groups first (if any) */
    pointer=i_array;
@@ -1888,14 +2494,29 @@
       iptr=*pointer++;
       if (iptr->flag == OBJ_GRP)
       {
-         fprintf(out_fp,
-      "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  %8llu %6.02f%%  %s\n",
+	 if (!hide_iovol)
+	 {
+            fprintf(out_fp,"%-8llu %6.02f%%  %8llu %6.02f%%  %16s %6.02f%%  "    \
+         	        "%16s %6.02f%%  %16s %6.02f%%  %8llu %6.02f%%  %s\n",
+            iptr->count,
+            (t_hit==0)?0:((float)iptr->count/t_hit)*100.0,iptr->files,
+            (t_file==0)?0:((float)iptr->files/t_file)*100.0,hr_size(iptr->xfer),
+            (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,hr_size(iptr->ixfer),
+            (t_ixfer==0)?0:((float)iptr->ixfer/t_ixfer)*100.0,hr_size(iptr->oxfer),
+            (t_oxfer==0)?0:((float)iptr->oxfer/t_oxfer)*100.0,iptr->visit,
+            (t_visit==0)?0:((float)iptr->visit/t_visit)*100.0,
+            iptr->string);
+         }else
+         {
+            fprintf(out_fp,"%-8llu %6.02f%%  %8llu %6.02f%%  %16s %6.02f%%  "    \
+         	        "%8llu %6.02f%%  %s\n",
             iptr->count,
             (t_hit==0)?0:((float)iptr->count/t_hit)*100.0,iptr->files,
-            (t_file==0)?0:((float)iptr->files/t_file)*100.0,iptr->xfer/1024,
+            (t_file==0)?0:((float)iptr->files/t_file)*100.0,hr_size(iptr->xfer),
             (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,iptr->visit,
             (t_visit==0)?0:((float)iptr->visit/t_visit)*100.0,
             iptr->string);
+         }
          i_grp--;
       }
    }
@@ -1909,14 +2530,29 @@
       iptr=*pointer++;
       if (iptr->flag == OBJ_REG)
       {
-         fprintf(out_fp,
-      "%-8llu %6.02f%%  %8llu %6.02f%%  %8.0f %6.02f%%  %8llu %6.02f%%  %s\n",
+	 if (!hide_iovol)
+	 {
+            fprintf(out_fp,"%-8llu %6.02f%%  %8llu %6.02f%%  %16s %6.02f%%  "    \
+         	        "%16s %6.02f%%  %16s %6.02f%%  %8llu %6.02f%%  %s\n",
+            iptr->count,
+            (t_hit==0)?0:((float)iptr->count/t_hit)*100.0,iptr->files,
+            (t_file==0)?0:((float)iptr->files/t_file)*100.0,hr_size(iptr->xfer),
+            (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,hr_size(iptr->ixfer),
+            (t_ixfer==0)?0:((float)iptr->ixfer/t_ixfer)*100.0,hr_size(iptr->oxfer),
+            (t_oxfer==0)?0:((float)iptr->oxfer/t_oxfer)*100.0,iptr->visit,
+            (t_visit==0)?0:((float)iptr->visit/t_visit)*100.0,
+            iptr->string);
+         }else
+         {
+            fprintf(out_fp,"%-8llu %6.02f%%  %8llu %6.02f%%  %16s %6.02f%%  "    \
+         	        "%8llu %6.02f%%  %s\n",
             iptr->count,
             (t_hit==0)?0:((float)iptr->count/t_hit)*100.0,iptr->files,
-            (t_file==0)?0:((float)iptr->files/t_file)*100.0,iptr->xfer/1024,
+            (t_file==0)?0:((float)iptr->files/t_file)*100.0,hr_size(iptr->xfer),
             (t_xfer==0)?0:((float)iptr->xfer/t_xfer)*100.0,iptr->visit,
             (t_visit==0)?0:((float)iptr->visit/t_visit)*100.0,
             iptr->string);
+         }
          i_reg--;
       }
    }
@@ -1933,7 +2569,7 @@
 
 void top_ctry_table()
 {
-   int       i,j,x,tot_num=0,tot_ctry=0;
+   int       i,j,k,x,tot_num=0,tot_ctry=0;
    int       ctry_fnd=0;
    u_int64_t idx;
    HNODEPTR  hptr;
@@ -2016,6 +2652,8 @@
                      ctry[j].count+=hptr->count;
                      ctry[j].files+=hptr->files;
                      ctry[j].xfer +=hptr->xfer;
+                     ctry[j].ixfer+=hptr->ixfer;
+                     ctry[j].oxfer+=hptr->oxfer;
                      ctry_fnd=1;
                      break;
                   }
@@ -2026,6 +2664,8 @@
                ctry[0].count+=hptr->count;
                ctry[0].files+=hptr->files;
                ctry[0].xfer +=hptr->xfer;
+               ctry[0].ixfer+=hptr->ixfer;
+               ctry[0].oxfer+=hptr->oxfer;
             }
          }
          hptr=hptr->next;
@@ -2079,20 +2719,28 @@
    /* Now do the table */
 
    for (i=0;i<ntop_ctrys;i++) if (top_ctrys[i]->count!=0) tot_num++;
-   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=510 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+           table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=8>"         \
-           "%s %d %s %d %s</TH></TR>\n",
-           GREY,msg_top_top,tot_num,msg_top_of,tot_ctry,msg_top_c);
+   fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=CENTER COLSPAN=\"%i\">"    \
+           "%s %d %s %d %s</TH></TR>\n",HEADLINECOLOR,k=(!hide_iovol)?12:8,
+           msg_top_top,tot_num,msg_top_of,tot_ctry,msg_top_c);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" ALIGN=center>"                   \
-          "<FONT SIZE=\"-1\">#</FONT></TH>\n",GREY);
+          "<FONT SIZE=\"-1\">#</FONT></TH>\n",COUNTERCOLOR);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HITCOLOR,msg_h_hits);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",FILECOLOR,msg_h_files);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"             \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",KBYTECOLOR,msg_h_xfer);
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"          \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",FILECOLOR,msg_h_ixfer);
+      fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center COLSPAN=2>"          \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HITCOLOR,msg_h_oxfer);
+   }
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=center>"                       \
           "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",MISCCOLOR,msg_h_ctry);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
@@ -2112,13 +2760,43 @@
       }
 
       if (top_ctrys[i]->count!=0)
-      fprintf(out_fp,"<TR>"                                                \
+      {
+      	 if (!hide_iovol)
+	 {
+            fprintf(out_fp,"<TR>"                                          \
+              "<TD ALIGN=center><FONT SIZE=\"-1\"><B>%d</B></FONT></TD>\n" \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n"\
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n"\
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"  \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"  \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"  \
+              "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
+              "<TD ALIGN=left NOWRAP>%s<FONT SIZE=\"-1\">%s</FONT>"        \
+              "</TD></TR>\n",
+              i+1,top_ctrys[i]->count,
+              (t_hit==0)?0:((float)top_ctrys[i]->count/t_hit)*100.0,
+              top_ctrys[i]->files,
+              (t_file==0)?0:((float)top_ctrys[i]->files/t_file)*100.0,
+              hr_size(top_ctrys[i]->xfer),
+              (t_xfer==0)?0:((float)top_ctrys[i]->xfer/t_xfer)*100.0,
+              hr_size(top_ctrys[i]->ixfer),
+              (t_ixfer==0)?0:((float)top_ctrys[i]->ixfer/t_ixfer)*100.0,
+              hr_size(top_ctrys[i]->oxfer),
+              (t_oxfer==0)?0:((float)top_ctrys[i]->oxfer/t_oxfer)*100.0,
+              flag_buf,top_ctrys[i]->desc);
+         }else
+         {
+            fprintf(out_fp,"<TR>"                                          \
               "<TD ALIGN=center><FONT SIZE=\"-1\"><B>%d</B></FONT></TD>\n" \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n"\
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
               "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%llu</B></FONT></TD>\n"\
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
-              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%.0f</B></FONT></TD>\n"\
+              "<TD ALIGN=right><FONT SIZE=\"-1\"><B>%s</B></FONT></TD>\n"  \
               "<TD ALIGN=right><FONT SIZE=\"-2\">%3.02f%%</FONT></TD>\n"   \
               "<TD ALIGN=left NOWRAP>%s<FONT SIZE=\"-1\">%s</FONT>"        \
               "</TD></TR>\n",
@@ -2126,9 +2804,11 @@
               (t_hit==0)?0:((float)top_ctrys[i]->count/t_hit)*100.0,
               top_ctrys[i]->files,
               (t_file==0)?0:((float)top_ctrys[i]->files/t_file)*100.0,
-              top_ctrys[i]->xfer/1024,
+              hr_size(top_ctrys[i]->xfer),
               (t_xfer==0)?0:((float)top_ctrys[i]->xfer/t_xfer)*100.0,
               flag_buf,top_ctrys[i]->desc);
+         }
+      }
    }
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"</TABLE>\n<P>\n");
@@ -2155,8 +2835,9 @@
    /* need a header? */
    if (dump_header)
    {
-      fprintf(out_fp,"%s\t%s\t%s\t%s\t%s\n",
-       msg_h_hits,msg_h_files,msg_h_xfer,msg_h_visits,msg_h_hname); 
+      fprintf(out_fp,"%s\t%s\t%s\t%s\t%s\t%s\t%s\n",
+       msg_h_hits,msg_h_files,msg_h_xfer,msg_h_ixfer,msg_h_oxfer,msg_h_visits,
+       msg_h_hname); 
    }
 
    /* dump 'em */
@@ -2167,8 +2848,9 @@
       if (hptr->flag != OBJ_GRP)
       {
          fprintf(out_fp,
-         "%llu\t%llu\t%.0f\t%llu\t%s\n",
+         "%llu\t%llu\t%.0f\t%.0f\t%.0f\t%llu\t%s\n",
             hptr->count,hptr->files,hptr->xfer/1024,
+            hptr->ixfer/1024,hptr->oxfer/1024,
             hptr->visit,hptr->string);
       }
       cnt--;
@@ -2198,7 +2880,8 @@
    /* need a header? */
    if (dump_header)
    {
-      fprintf(out_fp,"%s\t%s\t%s\n",msg_h_hits,msg_h_xfer,msg_h_url);
+      fprintf(out_fp,"%s\t%s\t%s\t%s\t%s\n",msg_h_hits,msg_h_xfer,msg_h_ixfer,
+      	             msg_h_oxfer,msg_h_url);
    }
 
    /* dump 'em */
@@ -2208,8 +2891,9 @@
       uptr=*pointer++;
       if (uptr->flag != OBJ_GRP)
       {
-         fprintf(out_fp,"%llu\t%.0f\t%s\n",
-            uptr->count,uptr->xfer/1024,uptr->string);
+         fprintf(out_fp,"%llu\t%.0f\t%.0f\t%.0f\t%s\n",
+            uptr->count,uptr->xfer/1024,uptr->ixfer/1024,uptr->oxfer/1024,
+            uptr->string);
       }
       cnt--;
    }
@@ -2316,8 +3000,9 @@
    /* need a header? */
    if (dump_header)
    {
-      fprintf(out_fp,"%s\t%s\t%s\t%s\t%s\n",
-         msg_h_hits,msg_h_files,msg_h_xfer,msg_h_visits,msg_h_uname);
+      fprintf(out_fp,"%s\t%s\t%s\t%s\t%s\t%s\t%s\n",
+         msg_h_hits,msg_h_files,msg_h_xfer,msg_h_ixfer,msg_h_oxfer,msg_h_visits,
+         msg_h_uname);
    }
 
    /* dump 'em */
@@ -2328,8 +3013,9 @@
       if (iptr->flag != OBJ_GRP)
       {
          fprintf(out_fp,
-         "%llu\t%llu\t%.0f\t%llu\t%s\n",
+         "%llu\t%llu\t%.0f\t%.0f\t%.0f\t%llu\t%s\n",
             iptr->count,iptr->files,iptr->xfer/1024,
+            iptr->ixfer/1024,iptr->oxfer/1024,
             iptr->visit,iptr->string);
       }
       cnt--;
@@ -2384,6 +3070,7 @@
 
    int     i,j,days_in_month;
    int     s_year=hist[HISTSIZE-1].year;
+   int     last_year=0,last_month=0;
    char    index_fname[256];
    char    buffer[BUFSIZE];
    u_int64_t m_hit=0;
@@ -2391,10 +3078,14 @@
    u_int64_t m_pages=0;
    u_int64_t m_visits=0;
    double    m_xfer=0.0;
+   double    m_ixfer=0.0;
+   double    m_oxfer=0.0;
    double  gt_hit=0.0;
    double  gt_files=0.0;
    double  gt_pages=0.0;
    double  gt_xfer=0.0;
+   double  gt_ixfer=0.0;
+   double  gt_oxfer=0.0;
    double  gt_visits=0.0;
 
    if (verbose>1) printf("%s\n",msg_gen_sum);
@@ -2433,17 +3124,20 @@
    fprintf(out_fp,"<IMG SRC=\"usage.png\" ALT=\"%s\" "    \
                   "HEIGHT=256 WIDTH=512><P>\n",buffer);
    /* month table */
-   fprintf(out_fp,"<TABLE WIDTH=600 BORDER=2 CELLSPACING=1 CELLPADDING=1>\n");
+   fprintf(out_fp,"<TABLE WIDTH=750 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+           table_border);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
-   fprintf(out_fp,"<TR><TH COLSPAN=11 BGCOLOR=\"%s\" ALIGN=center>",GREY);
+   fprintf(out_fp,"<TR><TH COLSPAN=\"%i\" BGCOLOR=\"%s\" ALIGN=center>",
+   	   j=(!hide_iovol)?13:11,HEADLINECOLOR);
    fprintf(out_fp,"%s</TH></TR>\n",msg_main_sum);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH ALIGN=left ROWSPAN=2 BGCOLOR=\"%s\">"          \
-          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",GREY,msg_h_mth);
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HEADLINECOLOR,msg_h_mth);
    fprintf(out_fp,"<TH ALIGN=center COLSPAN=4 BGCOLOR=\"%s\">"            \
-          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",GREY,msg_main_da);
-   fprintf(out_fp,"<TH ALIGN=center COLSPAN=6 BGCOLOR=\"%s\">"            \
-          "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",GREY,msg_main_mt);
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HEADLINECOLOR,msg_main_da);
+   fprintf(out_fp,"<TH ALIGN=center COLSPAN=\"%i\" BGCOLOR=\"%s\">"       \
+          "<FONT SIZE=\"-1\">%s</FONT></TH></TR>\n",j=(!hide_iovol)?8:6,
+          HEADLINECOLOR,msg_main_mt);
    fprintf(out_fp,"<TR><TH ALIGN=center BGCOLOR=\"%s\">"                  \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HITCOLOR,msg_h_hits);
    fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"                      \
@@ -2456,6 +3150,13 @@
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",SITECOLOR,msg_h_sites);
    fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"                      \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",KBYTECOLOR,msg_h_xfer);
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"                   \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",FILECOLOR,msg_h_ixfer);
+      fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"                   \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HITCOLOR,msg_h_oxfer);
+   }
    fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"                      \
           "<FONT SIZE=\"-1\">%s</FONT></TH>\n",VISITCOLOR,msg_h_visits);
    fprintf(out_fp,"<TH ALIGN=center BGCOLOR=\"%s\">"                      \
@@ -2475,6 +3176,9 @@
       }
       else days_in_month=(hist[i].lday-hist[i].fday)+1;
 
+      last_year = hist[i].year;
+      last_month = hist[i].month;
+
       /* Check for year change */
       if (s_year!=hist[i].year)
       {
@@ -2482,26 +3186,33 @@
          if (index_mths>16 && year_totals)
          {
             fprintf(out_fp,"<TR><TH COLSPAN=6 BGCOLOR=\"%s\" "         \
-                "ALIGN=left><FONT SIZE=\"-1\"><STRONG>%04d</TH>\n",
+                "ALIGN=left><FONT SIZE=\"-1\"><STRONG>%04d</STRONG></FONT></TH>\n",
                 GRPCOLOR,s_year);
             fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
-                  "<FONT SIZE=\"-1\">%.0f</TH>", GRPCOLOR, m_xfer);
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n", GRPCOLOR, hr_size(m_xfer*1024));
+            if (!hide_iovol)
+            {
+               fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n", GRPCOLOR, hr_size(m_ixfer*1024));
+               fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
+                  "<FONT SIZE=\"-1\">%s</FONT></TH>\n", GRPCOLOR, hr_size(m_oxfer*1024));
+            }
             fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
-                  "<FONT SIZE=\"-1\">%0llu</TH>", GRPCOLOR, m_visits);
+                  "<FONT SIZE=\"-1\">%0llu</FONT></TH>\n", GRPCOLOR, m_visits);
             fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
-                  "<FONT SIZE=\"-1\">%0llu</TH>", GRPCOLOR, m_pages);
+                  "<FONT SIZE=\"-1\">%0llu</FONT></TH>\n", GRPCOLOR, m_pages);
             fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
-                  "<FONT SIZE=\"-1\">%0llu</TH>", GRPCOLOR, m_files);
+                  "<FONT SIZE=\"-1\">%0llu</FONT></TH>\n", GRPCOLOR, m_files);
             fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
-                  "<FONT SIZE=\"-1\">%0llu</TH>", GRPCOLOR, m_hit);
-            m_xfer=0; m_visits=0; m_pages=0; m_files=0; m_hit=0;
+                  "<FONT SIZE=\"-1\">%0llu</FONT></TH>\n", GRPCOLOR, m_hit);
+            m_xfer=0; m_ixfer=0; m_oxfer=0; m_visits=0; m_pages=0; m_files=0; m_hit=0;
          }
  
          /* Year Header */
          s_year=hist[i].year;
          if (index_mths>16 && year_hdrs)
-            fprintf(out_fp,"<TR><TH COLSPAN=11 BGCOLOR=\"%s\" "           \
-               "ALIGN=center>%04d</TH></TR>\n", GREY, s_year);
+            fprintf(out_fp,"<TR><TH COLSPAN=\"%i\" BGCOLOR=\"%s\" "           \
+               "ALIGN=center>%04d</TH></TR>\n", j=(!hide_iovol)?13:11, HEADLINECOLOR, s_year);
       }
 
       fprintf(out_fp,"<TR><TD NOWRAP>");
@@ -2524,8 +3235,15 @@
                       hist[i].visit/days_in_month);
       fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%llu</FONT></TD>\n",
                       hist[i].site);
-      fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%.0f</FONT></TD>\n",
-                      hist[i].xfer);
+      fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%s</FONT></TD>\n",
+                      hr_size(hist[i].xfer*1024));
+      if (!hide_iovol)
+      {
+         fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%s</FONT></TD>\n",
+                      hr_size(hist[i].ixfer*1024));
+         fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%s</FONT></TD>\n",
+                      hr_size(hist[i].oxfer*1024));
+      }
       fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%llu</FONT></TD>\n",
                       hist[i].visit);
       fprintf(out_fp,"<TD ALIGN=right><FONT SIZE=\"-1\">%llu</FONT></TD>\n",
@@ -2539,45 +3257,146 @@
       gt_files += hist[i].files;
       gt_pages += hist[i].page;
       gt_xfer  += hist[i].xfer;
+      gt_ixfer += hist[i].ixfer;
+      gt_oxfer += hist[i].oxfer;
       gt_visits+= hist[i].visit;
        m_hit   += hist[i].hit;
        m_files += hist[i].files;
        m_pages += hist[i].page;
        m_visits+= hist[i].visit;
        m_xfer  += hist[i].xfer;
+       m_ixfer += hist[i].ixfer;
+       m_oxfer += hist[i].oxfer;
    }
 
    if (index_mths>16 && year_totals)
    {
       fprintf(out_fp,"<TR><TH COLSPAN=6 BGCOLOR=\"%s\" "         \
-                     "ALIGN=left><FONT SIZE=\"-1\"><STRONG>%04d</TH>\n",
+                     "ALIGN=left><FONT SIZE=\"-1\"><STRONG>%04d</STRONG></FONT></TH>\n",
                      GRPCOLOR,s_year);
       fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
-                     "<FONT SIZE=\"-1\">%.0f</TH>", GRPCOLOR, m_xfer);
+                     "<FONT SIZE=\"-1\">%s</FONT></TH>\n", GRPCOLOR, hr_size(m_xfer*1024));
+      if (!hide_iovol)
+      {
+         fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
+                     "<FONT SIZE=\"-1\">%s</FONT></TH>\n", GRPCOLOR, hr_size(m_ixfer*1024));
+         fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
+                     "<FONT SIZE=\"-1\">%s</FONT></TH>\n", GRPCOLOR, hr_size(m_oxfer*1024));
+      }
       fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
-                     "<FONT SIZE=\"-1\">%0llu</TH>", GRPCOLOR, m_visits);
+                     "<FONT SIZE=\"-1\">%0llu</FONT></TH>\n", GRPCOLOR, m_visits);
       fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
-                     "<FONT SIZE=\"-1\">%0llu</TH>", GRPCOLOR, m_pages);
+                     "<FONT SIZE=\"-1\">%0llu</FONT></TH>\n", GRPCOLOR, m_pages);
       fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
-                     "<FONT SIZE=\"-1\">%0llu</TH>", GRPCOLOR, m_files);
+                     "<FONT SIZE=\"-1\">%0llu</FONT></TH>\n", GRPCOLOR, m_files);
       fprintf(out_fp,"<TH ALIGN=\"right\" BGCOLOR=\"%s\">"       \
-                     "<FONT SIZE=\"-1\">%0llu</TH>", GRPCOLOR, m_hit);
+                     "<FONT SIZE=\"-1\">%0llu</FONT></TH>\n", GRPCOLOR, m_hit);
    }
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"<TR><TH BGCOLOR=\"%s\" COLSPAN=6 ALIGN=left>"          \
-          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",GREY,msg_h_totals);
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HEADLINECOLOR,msg_h_totals);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=right>"                       \
-          "<FONT SIZE=\"-1\">%.0f</FONT></TH>\n",GREY,gt_xfer);
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HEADLINECOLOR,hr_size(gt_xfer*1024));
+   if (!hide_iovol)
+   {
+      fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=right>"                       \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HEADLINECOLOR,hr_size(gt_ixfer*1024));
+      fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=right>"                       \
+          "<FONT SIZE=\"-1\">%s</FONT></TH>\n",HEADLINECOLOR,hr_size(gt_oxfer*1024));
+   }
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=right>"                       \
-          "<FONT SIZE=\"-1\">%.0f</FONT></TH>\n",GREY,gt_visits);
+          "<FONT SIZE=\"-1\">%.0f</FONT></TH>\n",HEADLINECOLOR,gt_visits);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=right>"                       \
-          "<FONT SIZE=\"-1\">%.0f</FONT></TH>\n",GREY,gt_pages);
+          "<FONT SIZE=\"-1\">%.0f</FONT></TH>\n",HEADLINECOLOR,gt_pages);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=right>"                       \
-          "<FONT SIZE=\"-1\">%.0f</FONT></TH>\n",GREY,gt_files);
+          "<FONT SIZE=\"-1\">%.0f</FONT></TH>\n",HEADLINECOLOR,gt_files);
    fprintf(out_fp,"<TH BGCOLOR=\"%s\" ALIGN=right>"                       \
-          "<FONT SIZE=\"-1\">%.0f</FONT></TH></TR>\n",GREY,gt_hit);
+          "<FONT SIZE=\"-1\">%.0f</FONT></TH></TR>\n",HEADLINECOLOR,gt_hit);
    fprintf(out_fp,"<TR><TH HEIGHT=4></TH></TR>\n");
    fprintf(out_fp,"</TABLE>\n");
+
+   if (narch_reports>0 && narch_reports<481) // range (1-480 months)
+   {
+      int counter=0;
+      struct stat st;
+      //filename: 13 chars for "usage_xxxxyy."+file extension+NULL terminator
+      char filename[13+sizeof(html_ext)+1];
+      
+      fprintf(out_fp,"<P>\n");
+      fprintf(out_fp,"<TABLE WIDTH=750 BORDER=%i CELLSPACING=1 CELLPADDING=1>\n",
+              table_border);
+      fprintf(out_fp,"<TR><TH HEIGHT=4 COLSPAN=6></TH></TR>\n");
+      fprintf(out_fp,"<TR><TH COLSPAN=6 BGCOLOR=\"%s\" ALIGN=center>",
+              HEADLINECOLOR);
+      fprintf(out_fp,"%s</TH></TR>\n",msg_main_ar);
+      fprintf(out_fp,"<TR><TH HEIGHT=4 COLSPAN=6></TH></TR>\n");
+      
+      if (last_month!=1) // no heading if last_month is 1 (January)
+      {
+         fprintf(out_fp,"<TH COLSPAN=6 BGCOLOR=\"%s\" ALIGN=center>" \
+         	 "<FONT SIZE=\"-1\">%i</FONT></TH>\n",HEADLINECOLOR,last_year);
+      }
+      for (i=0;i<narch_reports;i++) // main table-loop
+      {
+         counter++;
+         if (counter==1) fprintf(out_fp,"<TR>\n");
+         if (--last_month<0)
+         {
+            last_month=12; // December
+            last_year-=1;  // change year
+         }
+         if (last_month==0)
+         {
+            if (counter==1)
+            {
+               fprintf(out_fp,"<TH COLSPAN=6 BGCOLOR=\"%s\" ALIGN=center>" \
+                       "<FONT SIZE=\"-1\">%i</FONT></TH>\n",HEADLINECOLOR,last_year-1);
+            } else
+            {
+               while (counter<7)
+               {
+                  fprintf(out_fp,"<TD WIDTH=\"16.66%%\">&nbsp;</TD>\n");
+                  counter++;
+               }
+               fprintf(out_fp,"<TR><TH COLSPAN=6 BGCOLOR=\"%s\" ALIGN=center>" \
+                       "<FONT SIZE=\"-1\">%i</FONT></TH></TR>\n",HEADLINECOLOR,last_year-1);
+            }
+            counter=0;
+            fprintf(out_fp,"</TR>\n");
+            --i; // reduce loop-counter to keep the number of required months
+            continue;
+         }
+         sprintf(filename,"usage_%04d%02d.%s",last_year, last_month, html_ext);
+         if (stat(filename, &st)==0) // check if file exists
+         {
+            fprintf(out_fp,"<TD WIDTH=\"16.66%%\"><A HREF=\"usage_%04d%02d.%s\">" \
+                   "<FONT SIZE=\"-1\">%s %d</FONT></A></TD>\n", last_year, last_month,
+                   html_ext, s_month[last_month-1], last_year);
+         } else
+         {
+            fprintf(out_fp,"<TD WIDTH=\"16.66%%\">" \
+                   "<FONT SIZE=\"-1\">%s %d</FONT></TD>\n", s_month[last_month-1], last_year);
+         }
+         if (counter==6) // close row after six cycles and reset counter
+         {
+            counter=0;
+            fprintf(out_fp,"</TR>\n");
+         }
+      }
+      if (counter<6 && counter>0) // fill up empty table spaces at the end
+      {
+         while (counter<6)
+         {
+            fprintf(out_fp,"<TD WIDTH=\"16.66%%\">&nbsp;</TD>\n");
+            counter++;
+         }
+         fprintf(out_fp,"</TR>\n");
+      }
+      
+      fprintf(out_fp,"<TR><TH HEIGHT=4 COLSPAN=6></TH></TR>\n");
+      fprintf(out_fp,"</TABLE>\n");
+   }
+
    write_html_tail(out_fp);
    fclose(out_fp);
    return 0;
@@ -2907,4 +3726,3 @@
    }
    return out_fp;
 }
-
diff -Naur webalizer-2.23-05//parser.c webalizer-2.23-05-RB29//parser.c
--- webalizer-2.23-05//parser.c	2011-01-03 05:51:34.000000000 +0100
+++ webalizer-2.23-05-RB29//parser.c	2011-04-19 18:37:55.000000000 +0200
@@ -199,6 +199,9 @@
    /* return appropriate response code */
    log_rec.resp_code=(*(eob-2)=='i')?206:200;
 
+   /* don't worry about I/O bytes in FTP */
+   log_rec.ixfer_size=log_rec.oxfer_size=0;
+
    return 1;
 }
 
@@ -365,6 +368,18 @@
    while ( (*cp1 != '\0') && (cp1 != eos) ) *cp2++ = *cp1++;
    *cp2 = '\0';
 
+   /* IN xfer size */
+   while ( (*cp1 != '\0') && (cp1 < eob) ) cp1++;
+   if (cp1 < eob) cp1++;
+   if (*cp1<'0'||*cp1>'9') log_rec.ixfer_size=0;
+   else log_rec.ixfer_size = strtoul(cp1,NULL,10);
+
+   /* OUT xfer size */
+   while ( (*cp1 != '\0') && (cp1 < eob) ) cp1++;
+   if (cp1 < eob) cp1++;
+   if (*cp1<'0'||*cp1>'9') log_rec.oxfer_size=0;
+   else log_rec.oxfer_size = strtoul(cp1,NULL,10);
+
    return 1;     /* maybe a valid record, return with TRUE */
 }
 
@@ -501,6 +516,9 @@
    /* strip trailing space(s) */
    while (*cp2==' ') *cp2--='\0';
 
+   /* don't do this for squid */
+   log_rec.ixfer_size=log_rec.oxfer_size=0;
+
    /* we have no interest in the remaining fields */
    return 1;
 }
diff -Naur webalizer-2.23-05//preserve.c webalizer-2.23-05-RB29//preserve.c
--- webalizer-2.23-05//preserve.c	2011-01-03 05:51:40.000000000 +0100
+++ webalizer-2.23-05-RB29//preserve.c	2011-04-19 18:37:55.000000000 +0200
@@ -121,7 +121,8 @@
          if (i>=0)
          {
          /* month# year# requests files sites xfer firstday lastday */
-         numfields = sscanf(buffer,"%d %d %llu %llu %llu %lf %d %d %llu %llu",
+         numfields = sscanf(buffer,
+         	       "%d %d %llu %llu %llu %lf %d %d %llu %llu %lf %lf",
                        &hist[i].month,
                        &hist[i].year,
                        &hist[i].hit,
@@ -131,7 +132,9 @@
                        &hist[i].fday,
                        &hist[i].lday,
                        &hist[i].page,
-                       &hist[i].visit);
+                       &hist[i].visit,
+                       &hist[i].ixfer,
+                       &hist[i].oxfer);
          }
       }
       fclose(hist_fp);
@@ -184,7 +187,7 @@
 
       for (i=HISTSIZE-1;i>=0;i--)
       {
-         fprintf(hist_fp,"%d %d %llu %llu %llu %.0f %d %d %llu %llu\n",
+         fprintf(hist_fp,"%d %d %llu %llu %llu %.0f %d %d %llu %llu %.0f %.0f\n",
                          hist[i].month,
                          hist[i].year,
                          hist[i].hit,
@@ -194,7 +197,9 @@
                          hist[i].fday,
                          hist[i].lday,
                          hist[i].page,
-                         hist[i].visit);
+                         hist[i].visit,
+                         hist[i].ixfer,
+                         hist[i].oxfer);
       }
       /* Done, close file */
       fclose(hist_fp);
@@ -298,6 +303,8 @@
       hist[i].xfer  = t_xfer/1024;
       hist[i].fday  = f_day;
       hist[i].lday  = l_day;
+      hist[i].ixfer = t_ixfer/1024;
+      hist[i].oxfer = t_oxfer/1024;
    }
 }
 
@@ -361,9 +368,9 @@
    if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
 
    /* Monthly totals for sites, urls, etc... */
-   sprintf(buffer,"%llu %llu %llu %llu %llu %llu %.0f %llu %llu %llu\n",
+   sprintf(buffer,"%llu %llu %llu %llu %llu %llu %.0f %llu %llu %llu %.0f %.0f\n",
         t_hit, t_file, t_site, t_url,
-        t_ref, t_agent, t_xfer, t_page, t_visit, t_user);
+        t_ref, t_agent, t_xfer, t_page, t_visit, t_user, t_ixfer, t_oxfer);
    if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
 
    /* Daily totals for sites, urls, etc... */
@@ -374,16 +381,17 @@
    /* Monthly (by day) total array */
    for (i=0;i<31;i++)
    {
-      sprintf(buffer,"%llu %llu %.0f %llu %llu %llu\n",
-        tm_hit[i],tm_file[i],tm_xfer[i],tm_site[i],tm_page[i],tm_visit[i]);
+      sprintf(buffer,"%llu %llu %.0f %llu %llu %llu %.0f %.0f\n",
+        tm_hit[i],tm_file[i],tm_xfer[i],tm_site[i],
+        tm_page[i],tm_visit[i],tm_ixfer[i],tm_oxfer[i]);
       if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
    }
 
    /* Daily (by hour) total array */
    for (i=0;i<24;i++)
    {
-      sprintf(buffer,"%llu %llu %.0f %llu\n",
-        th_hit[i],th_file[i],th_xfer[i],th_page[i]);
+      sprintf(buffer,"%llu %llu %.0f %llu %.0f %.0f\n",
+        th_hit[i],th_file[i],th_xfer[i],th_page[i],th_ixfer[i],th_oxfer[i]);
       if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
    }
 
@@ -402,9 +410,9 @@
       uptr=um_htab[i];
       while (uptr!=NULL)
       {
-         snprintf(buffer,sizeof(buffer),"%s\n%d %llu %llu %.0f %llu %llu\n",
+         snprintf(buffer,sizeof(buffer),"%s\n%d %llu %llu %.0f %llu %llu %.0f %.0f\n",
                   uptr->string, uptr->flag, uptr->count, uptr->files,
-                  uptr->xfer, uptr->entry, uptr->exit);
+                  uptr->xfer, uptr->entry, uptr->exit, uptr->ixfer, uptr->oxfer);
          if (fputs(buffer,fp)==EOF) return 1;
          uptr=uptr->next;
       }
@@ -419,9 +427,10 @@
       hptr=sm_htab[i];
       while (hptr!=NULL)
       {
-         snprintf(buffer,sizeof(buffer),"%s\n%d %llu %llu %.0f %llu %llu\n%s\n",
+         snprintf(buffer,sizeof(buffer),"%s\n%d %llu %llu %.0f %llu %llu %.0f %.0f\n%s\n",
                   hptr->string, hptr->flag, hptr->count, hptr->files,
                   hptr->xfer, hptr->visit, hptr->tstamp,
+                  hptr->ixfer, hptr->oxfer,
                   (hptr->lasturl==blank_str)?"-":hptr->lasturl);
          if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
          hptr=hptr->next;
@@ -436,9 +445,10 @@
       hptr=sd_htab[i];
       while (hptr!=NULL)
       {
-         snprintf(buffer,sizeof(buffer),"%s\n%d %llu %llu %.0f %llu %llu\n%s\n",
+         snprintf(buffer,sizeof(buffer),"%s\n%d %llu %llu %.0f %llu %llu %.0f %.0f\n%s\n",
                   hptr->string, hptr->flag, hptr->count, hptr->files,
                   hptr->xfer, hptr->visit, hptr->tstamp,
+                  hptr->ixfer, hptr->oxfer,
                   (hptr->lasturl==blank_str)?"-":hptr->lasturl);
          if (fputs(buffer,fp)==EOF) return 1;
          hptr=hptr->next;
@@ -505,15 +515,30 @@
       iptr=im_htab[i];
       while (iptr!=NULL)
       {
-         snprintf(buffer,sizeof(buffer),"%s\n%d %llu %llu %.0f %llu %llu\n",
+         snprintf(buffer,sizeof(buffer),"%s\n%d %llu %llu %.0f %llu %llu %.0f %.0f\n",
                   iptr->string, iptr->flag, iptr->count, iptr->files,
-              iptr->xfer, iptr->visit, iptr->tstamp);
+                  iptr->xfer, iptr->visit, iptr->tstamp,
+                  iptr->ixfer,iptr->oxfer);
          if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
          iptr=iptr->next;
       }
    }
    if (fputs("# End Of Table - usernames\n",fp)==EOF) return 1;
 
+   /* 404 error list */
+   snprintf(buffer,sizeof(buffer),"%lu\n",resp_counter); /* save total 404 counter */
+   if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
+   
+   if (fputs("# -notfounderrors- \n",fp)==EOF) return 1;  /* error exit */
+   if (resp_counter>0) {
+      for (i=0;i<resp_counter;i++) {
+      	snprintf(buffer,sizeof(buffer),"%s\n%lu\n",respnotfound[i].respurl,
+	         respnotfound[i].count);
+      	if (fputs(buffer,fp)==EOF) return 1;  /* error exit */
+      }
+   }
+   if (fputs("# End Of Table - notfounderrors\n",fp)==EOF) return 1;
+
    /* Done, close file */
    fclose(fp);
 
@@ -589,9 +614,15 @@
    /* Get monthly totals */
    if ((fgets(buffer,BUFSIZE,fp)) != NULL)
    {
-      sscanf(buffer,"%llu %llu %llu %llu %llu %llu %lf %llu %llu %llu",
+      if (sscanf(buffer,"%llu %llu %llu %llu %llu %llu %lf %llu %llu %llu %lf %lf",
        &t_hit, &t_file, &t_site, &t_url,
-       &t_ref, &t_agent, &t_xfer, &t_page, &t_visit, &t_user);
+       &t_ref, &t_agent, &t_xfer, &t_page, &t_visit,
+       &t_user, &t_ixfer, &t_oxfer)==10)
+       {
+	       /* compat fix for mod_logio: set missing values to 0 */
+	       t_ixfer=0.0;
+	       t_oxfer=0.0;
+       }
    } else return 3;  /* error exit */
      
    /* Get daily totals */
@@ -606,9 +637,14 @@
    {
       if ((fgets(buffer,BUFSIZE,fp)) != NULL)
       {
-         sscanf(buffer,"%llu %llu %lf %llu %llu %llu",
-          &tm_hit[i],&tm_file[i],&tm_xfer[i],&tm_site[i],&tm_page[i],
-          &tm_visit[i]);
+         if (sscanf(buffer,"%llu %llu %lf %llu %llu %llu %lf %lf",
+          &tm_hit[i],&tm_file[i],&tm_xfer[i],
+          &tm_site[i],&tm_page[i],&tm_visit[i],&tm_ixfer[i],&tm_oxfer[i])==6)
+	  {
+		  /* compat fix for mod_logio: set missing values to 0 */
+		  tm_ixfer[i]=0.0;
+		  tm_oxfer[i]=0.0;
+	  }
       } else return 5;  /* error exit */
    }
 
@@ -617,8 +653,14 @@
    {
       if ((fgets(buffer,BUFSIZE,fp)) != NULL)
       {
-         sscanf(buffer,"%llu %llu %lf %llu",
-          &th_hit[i],&th_file[i],&th_xfer[i],&th_page[i]);
+         if (sscanf(buffer,"%llu %llu %lf %llu %lf %lf",
+          &th_hit[i],&th_file[i],&th_xfer[i],
+          &th_page[i],&th_ixfer[i],&th_oxfer[i])==4)
+	  {
+		  /* compat fix for mod_logio: set missing values to 0 */
+		  th_ixfer[i]=0.0;
+		  th_oxfer[i]=0.0;
+	  }
       } else return 6;  /* error exit */
    }
 
@@ -652,14 +694,20 @@
       if (!isdigit((unsigned char)buffer[0])) return 10;  /* error exit */
 
       /* load temporary node data */
-      sscanf(buffer,"%d %llu %llu %lf %llu %llu",
+      if (sscanf(buffer,"%d %llu %llu %lf %llu %llu %lf %lf",
          &t_unode.flag,&t_unode.count,
          &t_unode.files, &t_unode.xfer,
-         &t_unode.entry, &t_unode.exit);
+         &t_unode.entry, &t_unode.exit, &t_unode.ixfer, &t_unode.oxfer)==6)
+	 {
+		 /* compat fix for mod_logio: set missing values to 0 */
+		 t_unode.ixfer=0.0;
+		 t_unode.oxfer=0.0;
+	 }
 
       /* Good record, insert into hash table */
       if (put_unode(tmp_buf,t_unode.flag,t_unode.count,
-         t_unode.xfer,&ul_bogus,t_unode.entry,t_unode.exit,um_htab))
+         t_unode.xfer,t_unode.ixfer,t_unode.oxfer,&ul_bogus,t_unode.entry,
+         t_unode.exit,um_htab))
       {
          if (verbose)
          /* Error adding URL node, skipping ... */
@@ -683,10 +731,15 @@
       if (!isdigit((unsigned char)buffer[0])) return 8;  /* error exit */
 
       /* load temporary node data */
-      sscanf(buffer,"%d %llu %llu %lf %llu %llu",
+      if (sscanf(buffer,"%d %llu %llu %lf %llu %llu %lf %lf",
          &t_hnode.flag,&t_hnode.count,
          &t_hnode.files, &t_hnode.xfer,
-         &t_hnode.visit, &t_hnode.tstamp);
+         &t_hnode.visit, &t_hnode.tstamp, &t_hnode.ixfer, &t_hnode.oxfer)==6)
+	 {
+		 /* compat fix for mod_logio: set missing values to 0 */
+		 t_hnode.ixfer=0.0;
+		 t_hnode.oxfer=0.0;
+	 }
 
       /* get last url */
       if ((fgets(buffer,BUFSIZE,fp)) == NULL) return 8;  /* error exit */
@@ -699,8 +752,8 @@
 
       /* Good record, insert into hash table */
       if (put_hnode(tmp_buf,t_hnode.flag,
-         t_hnode.count,t_hnode.files,t_hnode.xfer,&ul_bogus,
-         t_hnode.visit+1,t_hnode.tstamp,t_hnode.lasturl,sm_htab))
+         t_hnode.count,t_hnode.files,t_hnode.xfer,t_hnode.ixfer,t_hnode.oxfer,
+         &ul_bogus,t_hnode.visit+1,t_hnode.tstamp,t_hnode.lasturl,sm_htab))
       {
          /* Error adding host node (monthly), skipping .... */
          if (verbose) fprintf(stderr,"%s %s\n",msg_nomem_mh, t_hnode.string);
@@ -723,10 +776,15 @@
       if (!isdigit((unsigned char)buffer[0])) return 9;  /* error exit */
 
       /* load temporary node data */
-      sscanf(buffer,"%d %llu %llu %lf %llu %llu",
+      if (sscanf(buffer,"%d %llu %llu %lf %llu %llu %lf %lf",
           &t_hnode.flag,&t_hnode.count,
           &t_hnode.files, &t_hnode.xfer,
-          &t_hnode.visit, &t_hnode.tstamp);
+          &t_hnode.visit, &t_hnode.tstamp, &t_hnode.ixfer, &t_hnode.oxfer)==6)
+	  {
+		  /* compat fix for mod_logio: set missing values to 0 */
+		  t_hnode.ixfer=0.0;
+		  t_hnode.oxfer=0.0;
+	  }
 
       /* get last url */
       if ((fgets(buffer,BUFSIZE,fp)) == NULL) return 9;  /* error exit */
@@ -739,8 +797,8 @@
 
       /* Good record, insert into hash table */
       if (put_hnode(tmp_buf,t_hnode.flag,
-         t_hnode.count,t_hnode.files,t_hnode.xfer,&ul_bogus,
-         t_hnode.visit+1,t_hnode.tstamp,t_hnode.lasturl,sd_htab))
+         t_hnode.count,t_hnode.files,t_hnode.xfer,t_hnode.ixfer,t_hnode.oxfer,
+         &ul_bogus,t_hnode.visit+1,t_hnode.tstamp,t_hnode.lasturl,sd_htab))
       {
          /* Error adding host node (daily), skipping .... */
          if (verbose) fprintf(stderr,"%s %s\n",msg_nomem_dh, t_hnode.string);
@@ -837,15 +895,20 @@
       if (!isdigit((unsigned char)buffer[0])) return 14;  /* error exit */
 
       /* load temporary node data */
-      sscanf(buffer,"%d %llu %llu %lf %llu %llu",
+      if (sscanf(buffer,"%d %llu %llu %lf %llu %llu %lf %lf",
          &t_inode.flag,&t_inode.count,
          &t_inode.files, &t_inode.xfer,
-         &t_inode.visit, &t_inode.tstamp);
+         &t_inode.visit, &t_inode.tstamp, &t_inode.ixfer, &t_inode.oxfer)==6)
+	 {
+		 /* compat fix for mod_logio: set missing values to 0 */
+		 t_inode.ixfer=0.0;
+		 t_inode.oxfer=0.0;
+	 }
 
       /* Good record, insert into hash table */
       if (put_inode(tmp_buf,t_inode.flag,
-         t_inode.count,t_inode.files,t_inode.xfer,&ul_bogus,
-         t_inode.visit+1,t_inode.tstamp,im_htab))
+         t_inode.count,t_inode.files,t_inode.xfer,t_inode.ixfer,t_inode.oxfer,
+         &ul_bogus,t_inode.visit+1,t_inode.tstamp,im_htab))
       {
          if (verbose)
          /* Error adding username node, skipping .... */
@@ -853,6 +916,43 @@
       }
    }
 
+   /* 404 error list */
+   if ((fgets(buffer,BUFSIZE,fp)) != NULL)
+   { sscanf(buffer,"%lu",&resp_counter); } /* read total 404 counter */
+   else return 15;
+   
+   /* Realloc memory if there are more 404 error entries in */
+   /* webalizer.current than predefined in MAXRESP */
+   if (resp_counter>=MAXRESP) {
+      void * new_ptr = realloc(respnotfound, 
+            sizeof(struct response_url)*(resp_counter));
+      if (new_ptr) {
+         respnotfound = (struct response_url *) new_ptr;
+      } else {
+         fprintf(stderr, "ERROR: Can't reallocate enough memory\n");
+         exit(0);
+      }
+   }
+   
+   if ((fgets(buffer,BUFSIZE,fp)) != NULL)
+   { if (strncmp(buffer,"# -notfounderrors- ",19)) return 15; }
+   else return 15;   /* error exit */
+   
+   i=0;
+   
+   while ((fgets(buffer,BUFSIZE,fp)) != NULL)
+   {
+      if (!strncmp(buffer,"# End Of Table ",15)) break;
+      strncpy(respnotfound[i].respurl,buffer,MAXURLH);
+      respnotfound[i].respurl[strlen(buffer)-1]=0;
+      
+      if ((fgets(buffer,BUFSIZE,fp)) == NULL) return 15;  /* error exit */
+      if (!isdigit((int)buffer[0])) return 15;  /* error exit */
+      
+      sscanf(buffer,"%lu",&respnotfound[i].count);
+      i+=1;
+   }
+
    fclose(fp);
    check_dup = 1;              /* enable duplicate checking */
    return 0;                   /* return with ok code       */
diff -Naur webalizer-2.23-05//preserve.h webalizer-2.23-05-RB29//preserve.h
--- webalizer-2.23-05//preserve.h	2008-06-01 20:41:48.000000000 +0200
+++ webalizer-2.23-05-RB29//preserve.h	2011-04-19 18:37:55.000000000 +0200
@@ -21,6 +21,8 @@
                   u_int64_t   page;           /* pages for month          */
                   u_int64_t   visit;          /* visits for month         */
                      double   xfer;           /* xfer amt for month       */
+                     double   ixfer;          /* in xfer size in bytes    */
+                     double   oxfer;          /* out xfer size in bytes   */
                 };
 
 extern struct hist_rec hist[HISTSIZE];        /* declare our hist array   */
diff -Naur webalizer-2.23-05//README webalizer-2.23-05-RB29//README
--- webalizer-2.23-05//README	2011-01-03 05:55:25.000000000 +0100
+++ webalizer-2.23-05-RB29//README	2011-04-19 18:46:05.237092614 +0200
@@ -1,5 +1,6 @@
 The Webalizer - A web server log file analysis tool
 Copyright 1997-2011 by Bradford L. Barrett
+Copyright 2005-2011 by Patrick K. Frei
 
 Distributed under the GNU GPL.  See the files "COPYING" and
 "Copyright" supplied with the distribution for additional info.
@@ -885,6 +886,9 @@
               to anything between 12 and 72 months (1 to 6 years).
               Command line argument: -k
 
+ResponseGraph ResponseGraph allows the response code graph to be disabled.
+              Values can be 'yes' or 'no', default is 'yes'.
+
 CountryGraph  This keyword is used to either enable or disable the creation
               and display of the Country Usage graph.  Values may be either
               'yes' or 'no', with the default being 'yes'.
@@ -1064,6 +1068,22 @@
               unless an absolute name is given (ie: starts with '/').
               Command line argument: -W
 
+TableBorder   TableBorder defines the border size of all tables. The default 
+              value for TableBorder is 1. The table border may be disabled by
+              using zero (0) for the value. Only values between 0 and 5 are
+              allowed.
+
+ChartBorder   ChartBorder defines the border size of all charts. The default 
+              value for ChartBorder is 1. The chart border may be disabled by
+              using zero (0) for the value. Only values between 0 and 5 are
+              allowed.
+
+ArchiveReports
+              ArchiveReports defines (additionally to at most 120 index months)
+              the number of archived reports (months) that will be shown as links
+              in a separate table on the summary page. If a month's report is not
+              available no link will be shown. The default number is 0 (disabled).
+              The maximum number is 480 (40 years).
 
 Top Table Keywords
 ------------------
@@ -1163,6 +1183,15 @@
               enabled.  Value can be either 'yes' or 'no', with 'no'
               being the default.
 
+CodeNotFound  CodeNotFound defines the number of entries in the HTTP-Code 404
+              error table. The default value for CodeNotFound is 20. The code
+              404 error table may be disabled by using zero (0) for the value.
+              Using one (1) for the value shows all code 404 errors in the table.
+
+AllErrors     Will create aseparate HTML page to be generated for all HTTP 
+              404 NOT FOUND errors. A link will be added to the bottom of the 
+              "Code 404 Monthly Statistics" table if enabled.  Value can be 
+              either 'yes' or 'no', with 'yes' being the default.
 
 Hide Object Keywords
 --------------------
@@ -1210,6 +1239,12 @@
               Value can be either 'yes' or 'no', with 'no' the default.
               Command line argument: -X
 
+HideInOutVolume This allows forcing the input/output volume to be hidden in
+              the report.  This is particularly useful if you don't have the 
+              Apache module "mod_logio" enabled on your webserver.  The value 
+              for this keyword can be either 'yes' or 'no', with 'no' the 
+              default, allowing the input/output volume to be displayed.
+
 HideURL       This allows you to hide URLs from the "Top URLs" table.
               Normally, this is used to hide items such as graphic files,
               audio files or other 'non-html' files that are transferred
@@ -1475,28 +1510,52 @@
 value is case insensitive.  If not specified, the default color shown
 will be used.
 
-ColorHit      Color used for 'Hits'.   Default is '00805C' (green)
+ColorBackground      Color used for 'Background'. Default is 'e8e8e8'
+
+ColorText            Color used for 'Text'. Default is '000000'
+
+ColorLink            Color used for 'Links'. Default is '0000ff'
+
+ColorVLink           Color used for 'Visited Links'. Default is 'ff0000'
+
+ColorALink           Color used for 'Activated Links'. Default is 'ff0000'
+
+ColorGrp             Color used for 'Groups'. Default is 'd0d0e0'
+
+ColorHeadline        Color used for 'Headlines'. Default is 'c0c0c0'
+
+ColorCounter         Color used for 'Counters'. Default is 'c0c0c0'
+
+ColorHit             Color used for 'Hits'. Default is '00805C' (green)
+
+ColorFile            Color used for 'Files'. Default is '0040FF' (blue)
+
+ColorSite            Color used for 'Sites'. Default is 'FF8000' (orange)
+
+ColorKbyte           Color used for 'KBytes'. Default is 'FF0000' (red)
+
+ColorPage            Color used for 'Pages'. Default is '00E0FF' (cyan)
 
-ColorFile     Color used for 'Files'.  Default is '0040FF' (blue)
+ColorVisit           Color used for 'Visits'. Default is 'FFFF00' (yellow)
 
-ColorSite     Color used for 'Sites'.  Default is 'FF8000' (orange)
+ColorMisc            Color used for miscellaneous titles in various 'Top'
+                     tables (not graphs). Default is '00E0FF' (cyan)
 
-ColorKbyte    Color used for 'KBytes'. Default is 'FF0000' (red)
+ChartBackgroundColor Color used for 'Chart Background'. Default is 'c0c0c0'
 
-ColorPage     Color used for 'Pages'.  Default is '00E0FF' (cyan)
+ChartLegendColor     Color used for 'Chart Legends'. Default is '000000'
 
-ColorVisit    Color used for 'Visits'. Default is 'FFFF00' (yellow)
+ChartShadowColor1    Chart Shadow color #1. Default is 'ffffff'
 
-ColorMisc     Color used for miscellaneous titles in various 'Top'
-              tables (not graphs).     Default is '00E0FF' (cyan)
+ChartShadowColor2    Chart Shadows color #2. Default is '808080'
 
-PieColor1     Pie Chart color #1.      Default is '800080' (purple)
+PieColor1            Pie Chart color #1. Default is '800080' (purple)
 
-PieColor2     Pie Chart color #2.      Default is '80FFC0' (lt. green)
+PieColor2            Pie Chart color #2. Default is '80FFC0' (lt. green)
 
-PieColor3     Pie Chart color #3.      Default is 'FF00FF' (lt. purple)
+PieColor3            Pie Chart color #3. Default is 'FF00FF' (lt. purple)
 
-PieColor4     Pie Chart color #4.      Default is 'FFC080' (tan)
+PieColor4            Pie Chart color #4. Default is 'FFC080' (tan)
 
 
 --------------------------------------------------------------------------
diff -Naur webalizer-2.23-05//sample.conf webalizer-2.23-05-RB29//sample.conf
--- webalizer-2.23-05//sample.conf	2011-01-03 05:53:33.000000000 +0100
+++ webalizer-2.23-05-RB29//sample.conf	2011-04-19 18:46:05.225093120 +0200
@@ -1,5 +1,7 @@
 #
-# Sample Webalizer configuration file
+# Sample Webalizer Xtended configuration file
+# Copyright 2005-2011 by Patrick K. Frei (pa_frei@bluewin.ch)
+# Based on the sample Webalizer configuration file
 # Copyright 1997-2011 by Bradford L. Barrett
 #
 # Distributed under the GNU General Public License.  See the
@@ -108,6 +110,7 @@
 PageType	htm*
 PageType	cgi
 #PageType	phtml
+#PageType	php
 #PageType	php3
 #PageType	pl
 
@@ -368,6 +371,11 @@
 
 #IgnoreState	no
 
+# ResponseGraph allows the response code graph to be disabled.
+# Values can be 'yes' or 'no', default is 'yes'.
+
+#ResponseGraph	yes
+
 # CountryGraph allows the usage by country graph to be disabled.
 # Values can be 'yes' or 'no', default is 'yes'.
 
@@ -416,7 +424,7 @@
 # Note, due to rounding errors, some values don't work quite right.
 # The lower the better, with 1,2,3,4,6 and 10 producing nice results.
 
-#GraphLines	2
+#GraphLines	4
 
 # IndexMonths defines the number of months to display in the main index
 # (yearly summary) table.  Value can be between 12 and 120, with the
@@ -463,18 +471,18 @@
 #TopSearch       20
 #TopUsers        20
 
-# The All* keywords allow the display of all URLs, Sites, Referrers
-# User Agents, Search Strings and Usernames.  If enabled, a seperate
+# The All* keywords allow the display of all URL's, Sites, Referrers, User
+# Agents, Search Strings, Usernames and 404-errors.  If enabled, a seperate
 # HTML page will be created, and a link will be added to the bottom
 # of the appropriate "Top" table.  There are a couple of conditions
-# for this to occur..  First, there must be more items than will fit
+# for this to occur.  First, there must be more items than will fit
 # in the "Top" table (otherwise it would just be duplicating what is
 # already displayed).  Second, the listing will only show those items
 # that are normally visable, which means it will not show any hidden
 # items.  Grouped entries will be listed first, followed by individual
 # items.  The value for these keywords can be either 'yes' or 'no',
-# with the default being 'no'.  Please be aware that these pages can
-# be quite large in size, particularly the sites page,  and seperate
+# with the default being 'no' (exc. 404-errors). Please be aware that these
+# pages can be quite large in size, particularly the sites page, and seperate
 # pages are generated for each month, which can consume quite a lot
 # of disk space depending on the traffic to your site.
 
@@ -484,6 +492,7 @@
 #AllAgents	no
 #AllSearchStr	no
 #AllUsers       no
+#AllErrors      yes
 
 # The Webalizer normally strips the string 'index.' off the end of
 # URLs in order to consolidate URL totals.  For example, the URL
@@ -586,11 +595,15 @@
 
 #GroupAgent	Opera/		Opera
 #HideAgent	Opera/
-#GroupAgent	"MSIE 7"	Microsoft Internet Exploder 7
+#GroupAgent	"MSIE 9"	Microsoft Internet Explorer 9
+#HideAgent	MSIE 9
+#GroupAgent	"MSIE 8"	Microsoft Internet Explorer 8
+#HideAgent	MSIE 8
+#GroupAgent	"MSIE 7"	Microsoft Internet Explorer 7
 #HideAgent	MSIE 7
-#GroupAgent	"MSIE 6"	Microsoft Internet Exploder 6
+#GroupAgent	"MSIE 6"	Microsoft Internet Explorer 6
 #HideAgent	MSIE 6
-#GroupAgent	"MSIE "		Older Microsoft Exploders
+#GroupAgent	"MSIE "		Older Microsoft Explorers
 #HideAgent	MSIE 
 #GroupAgent	Firefox/2.	Firefox 2
 #HideAgent	Firefox/2.
@@ -619,6 +632,14 @@
 
 #HideAllSites	no
 
+# HideInOutVolume allows forcing the input/output volume to be hidden in
+# the report.  This is particularly useful if you don't have the Apache
+# module "mod_logio" enabled on your webserver.  The value for this
+# keyword can be either 'yes' or 'no', with 'no' the default, allowing
+# the input/output volume to be displayed.
+
+#HideInOutVolume no
+
 # The GroupDomains keyword allows you to group individual hostnames
 # into their respective domains.  The value specifies the level of
 # grouping to perform, and can be thought of as 'the number of dots'
@@ -655,8 +676,10 @@
 # remember, the use of these will MAKE YOUR STATS INACCURATE and you
 # should consider using an equivalent 'Hide*' keyword instead.
 
+#IgnoreSite	localhost
 #IgnoreSite	bad.site.net
 #IgnoreURL	/test*
+#IgnoreReferrer	localhost
 #IgnoreReferrer	file:/*
 #IgnoreAgent	RealPlayer
 #IgnoreUser     root
@@ -759,21 +782,65 @@
 #DumpUsers	no
 #DumpSearchStr  no
 
+# CodeNotFound defines the number of entries in the HTTP-Code 404 error table.
+# The default value for CodeNotFound is 20. The code 404 error table may be
+# disabled by using zero (0) for the value. Using one (1) for the value
+# shows all code 404 errors in the table.
+
+#CodeNotFound    20
+
+# The custom page colors are defined here. Declare them in the standard
+# hexadecimal way (as HTML, without the '#'). If none are given, you will get
+# the standard webalizer colors.
+
+#ColorBackground        e8e8e8
+#ColorText              000000
+#ColorLink              0000ff
+#ColorVLink             ff0000
+#ColorALink             ff0000
+
 # The custom graph colors are defined here. Declare them 
 # in the standard hexadecimal way (as HTML, without the '#') 
 # If none are given, you will get the standard default colors.
 
-#ColorHit	00805c
-#ColorFile	0040ff
-#ColorSite	ff8000
-#ColorKbyte	ff0000
-#ColorPage	00e0ff
-#ColorVisit	ffff00
-#ColorMisc      00e0ff
-
-#PieColor1	800080
-#PieColor2	80ffc0
-#PieColor3	ff00ff
-#PieColor4	ffc080
+#ColorGrp               d0d0e0
+#ColorHeadline          c0c0c0
+#ColorCounter           c0c0c0
+#ColorHit	        00805c
+#ColorFile	        0040ff
+#ColorSite	        ff8000
+#ColorKbyte	        ff0000
+#ColorPage	        00e0ff
+#ColorVisit	        ffff00
+#ColorMisc              00e0ff
+
+#ChartBackgroundColor	c0c0c0
+#ChartLegendColor	000000
+#ChartShadowColor1      ffffff
+#ChartShadowColor2      808080
+
+#PieColor1	        800080
+#PieColor2	        80ffc0
+#PieColor3	        ff00ff
+#PieColor4	        ffc080
+
+# TableBorder defines the border size of all tables.
+# The default value for TableBorder is 1. The table border may be disabled by
+# using zero (0) for the value. Only values between 0 and 5 are allowed.
+
+#TableBorder     1
+
+# ChartBorder defines the border size of all charts.
+# The default value for ChartBorder is 1. The chart border may be disabled by
+# using zero (0) for the value. Only values between 0 and 5 are allowed.
+
+#ChartBorder     1
+
+# ArchiveReports defines (additionally to at most 120 index months) the number
+# of archived reports (months) that will be shown as links in a separate table on
+# the summary page. If a month's report is not available no link will be shown.
+# The default number is 0 (disabled). The maximum number is 480 (40 years).
+
+#ArchiveReports  0
 
 # End of configuration file...  Have a nice day!
diff -Naur webalizer-2.23-05//wcmgr.c webalizer-2.23-05-RB29//wcmgr.c
--- webalizer-2.23-05//wcmgr.c	2011-01-03 05:52:38.000000000 +0100
+++ webalizer-2.23-05-RB29//wcmgr.c	2011-04-19 18:37:55.000000000 +0200
@@ -839,6 +839,7 @@
             exit(1);
          }
       }
+      fclose(in_fp);
    }
    else fprintf(stderr,"Error: File not found: %s\n",out_file);
    dns_db->close(dns_db,0);
diff -Naur webalizer-2.23-05//webalizer.1 webalizer-2.23-05-RB29//webalizer.1
--- webalizer-2.23-05//webalizer.1	2011-01-03 05:54:51.000000000 +0100
+++ webalizer-2.23-05-RB29//webalizer.1	2011-04-19 18:46:05.229094523 +0200
@@ -1,4 +1,4 @@
-.TH webalizer 1 "12-Jul-2008" "Version 2.20" "The Webalizer"
+.TH webalizer 1 "20-April-2011" "Version RB29 Webalizer Xtended" "The Webalizer"
 .SH NAME
 webalizer - A web server log file analysis tool.
 .SH SYNOPSIS
@@ -478,6 +478,9 @@
 as if they had the same date/time as the last good record.  Normally,
 out of sequence log records are ignored.
 .TP 8
+.B ResponseGraph \fP( \fByes\fP | no )
+Display Status Code Response Graph.
+.TP 8
 .B CountryGraph \fP( \fByes\fP | no )
 Display Country Usage Graph in output report.
 .TP 8
@@ -629,6 +632,20 @@
 .B GeoIPDatabase \fIname\fP
 Allows the use of an alternate GeoIP database \fIname\fP.  If not
 specified, the default database will be used.
+.TP 8
+.B TableBorder \fInum\fP
+Display the table border with size \fInum\fP.  Disable by using
+zero ('\fB0\fP'), default is \fB1\fP, maximum is \fB5\fP.
+.TP 8
+.B ChartBorder \fInum\fP
+Display the chart border with size \fInum\fP.  Disable by using
+zero ('\fB0\fP'), default is \fB1\fP, maximum is \fB5\fP.
+.TP 8
+.B ArchiveReports \fInum\fP
+ArchiveReports defines (additionally to at most 120 index months) the number of
+archived reports (months) that will be shown as links in a separate table on the
+summary page. If a month's report is not available no link will be shown. The 
+default number is \fB0\fP (disabled). The maximum number is \fB480\fP (40 years).
 .PP
 .I Top Table Keywords
 .TP 8
@@ -683,6 +700,13 @@
 .TP 8
 .B AllUsers \fP( yes | \fBno\fP )
 Create separate HTML page with \fBAll\fP Usernames.
+.TP 8
+.B CodeNotFound \fInum\fP
+Display the top \fInum\fP HTTP 404 NOT FOUND errors in the Code 404 error table.
+Use zero (0) to disable the table or one (1) to show all errors.
+.TP 8
+.B AllErrors \fP( \fByes\fP | no )
+Create separate HTML page with \fBAll\fP HTTP 404 NOT FOUND errors.
 .PP
 .I Hide/Ignore/Group/Include Keywords
 .TP 8
@@ -698,6 +722,9 @@
 .B HideAllSites \fP( yes | \fBno\fP )
 Hide all individual sites.  This causes only grouped sites to be displayed.
 .TP 8
+.B HideInOutVolume \fP( yes | \fBno\fP )
+Hide input/output volume.
+.TP 8
 .B HideURL \fIname\fP
 Hide URLs that match \fIname\fP.
 .TP 8
@@ -799,6 +826,32 @@
 Determines if the referrers listed in the top referrers table should be
 displayed as plain text, or as a link to the referrer URL.
 .TP 8
+.B ColorBackground \fP( rrggbb | \fBe8e8e8\fP )
+Sets the page's background-color to the specified html color (no '#').
+.TP 8
+.B ColorText \fP( rrggbb | \fB000000\fP )
+Sets the page's text-color to the specified html color (no '#').
+.TP 8
+.B ColorLink \fP( rrggbb | \fB0000ff\fP )
+Sets the page's link-color to the specified html color (no '#').
+.TP 8
+.B ColorVLink \fP( rrggbb | \fBff0000\fP )
+Sets the page's visited-link-color to the specified html color (no '#').
+.TP 8
+.B ColorALink \fP( rrggbb | \fBff0000\fP )
+Sets the page's activated-link-color to the specified html color (no '#').
+.TP 8
+.B ColorGrp \fP( rrggbb | \fBd0d0e0\fP )
+Sets the table's group-color (see group* keywords) to the specified html
+color (no '#').
+.TP 8
+.B ColorHeadline \fP( rrggbb | \fBc0c0c0\fP )
+Sets the table's headline-color to the specified html color (no '#').
+.TP 8
+.B ColorCounter \fP( rrggbb | \fBc0c0c0\fP )
+Sets the table's counter-color ('Day', 'Hour', '#') to the specified html
+color (no '#').
+.TP 8
 .B ColorHit \fP( rrggbb | \fB00805c\fP )
 Sets the graph's hit-color to the specified html color (no '#').
 .TP 8
@@ -821,6 +874,20 @@
 Sets the 'miscellaneous' color for table headers (not graphs) to
 the specified html color (no '#').
 .TP 8
+.B ChartBackgroundColor \fP( rrggbb | \fBc0c0c0\fP )
+Sets the chart's background-color to the specified html color (no '#').
+.TP 8
+.B ChartLegendColor \fP( rrggbb | \fB000000\fP )
+Sets the chart's legend-color to the specified html color (no '#').
+.TP 8
+.B ChartShadowColor1 \fP( rrggbb | \fBffffff\fP )
+Sets the chart's frist shadow-color (left/top) to the specified html
+color (no '#').
+.TP 8
+.B ChartShadowColor2 \fP( rrggbb | \fB808080\fP )
+Sets the chart's second shadow-color (bottom/right) to the specified html
+color (no '#').
+.TP 8
 .B PieColor1 \fP( rrggbb | \fB800080\fP )
 Sets the pie's first optional color to the specified html color (no '#').
 .TP 8
@@ -901,5 +968,11 @@
 Copyright (C) 1997-2011 by Bradford L. Barrett.  Distributed under
 the GNU GPL.  See the files "\fICOPYING\fP" and "\fICopyright\fP",
 supplied with all distributions for additional information.
+.PP
+Copyright (C) 2005-2011 by Patrick K. Frei (\fIWebalizer Xtended
+[www.patrickfrei.ch/webalizer/]\fP).
 .SH AUTHOR
 Bradford L. Barrett <\fIbrad at mrunix dot net\fP>
+.PP
+Patrick K. Frei <\fIpa_frei@bluewin.ch\fP> (\fIWebalizer Xtended
+[www.patrickfrei.ch/webalizer/]\fP).
diff -Naur webalizer-2.23-05//webalizer.c webalizer-2.23-05-RB29//webalizer.c
--- webalizer-2.23-05//webalizer.c	2011-04-15 07:52:46.000000000 +0200
+++ webalizer-2.23-05-RB29//webalizer.c	2011-04-19 18:37:55.000000000 +0200
@@ -115,6 +115,9 @@
 char    *editlvl     = "05";                  /* edit level               */
 char    *moddate     = "14-Apr-2011";         /* modification date        */
 char    *copyright   = "Copyright 1997-2011 by Bradford L. Barrett";
+char    *version_xt  = "RB29";                /* program version (XT)     */
+char    *moddate_xt  = "20-Apr-2011";         /* modification date (XT)   */
+char    *copyright_xt= "Copyright 2005-2011 by Patrick K. Frei";
 
 int     verbose      = 2;                     /* 2=verbose,1=err, 0=none  */ 
 int     debug_mode   = 0;                     /* debug mode flag          */
@@ -124,6 +127,7 @@
 int     ignore_hist  = 0;                     /* history flag (1=skip)    */
 int     ignore_state = 0;                     /* state flag (1=skip)      */
 int     default_index= 1;                     /* default index. (1=yes)   */
+int     response_graph=1;                     /* response graph display   */
 int     hourly_graph = 1;                     /* hourly graph display     */
 int     hourly_stats = 1;                     /* hourly stats table       */
 int     daily_graph  = 1;                     /* daily graph display      */
@@ -141,11 +145,12 @@
 int     searchcasei  = 1;                     /* case insensitive search  */
 int     visit_timeout= 1800;                  /* visit timeout (seconds)  */
 int     graph_legend = 1;                     /* graph legend (1=yes)     */
-int     graph_lines  = 2;                     /* graph lines (0=none)     */
+int     graph_lines  = 4;                     /* graph lines (0=none)     */
 int     fold_seq_err = 0;                     /* fold seq err (0=no)      */
 int     log_type     = LOG_CLF;               /* log type (default=CLF)   */
 int     group_domains= 0;                     /* Group domains 0=none     */
 int     hide_sites   = 0;                     /* Hide ind. sites (0=no)   */
+int	hide_iovol   = 0;                     /* Hide In/Out volume (0=no)*/
 int     link_referrer= 0;                     /* Link referrers (0=no)    */
 char    *hname       = NULL;                  /* hostname for reports     */
 char    *state_fname = "webalizer.current";   /* run state file name      */
@@ -158,7 +163,10 @@
 char    *blank_str   = "";                    /* blank string             */
 char    *geodb_fname = NULL;                  /* GeoDB database filename  */
 char    *dns_cache   = NULL;                  /* DNS cache file name      */
+char    placeholder = '@';                    /* User agent placeholder   */
 int     dns_children = 0;                     /* DNS children (0=don't do)*/
+int     table_border = 1;                     /* Table border (0-5)       */
+int     chart_border = 1;                     /* chart border (0-5)       */
 int     cache_ips    = 0;                     /* CacheIPs in DB (0=no)    */
 int     cache_ttl    = 7;                     /* DNS Cache TTL (days)     */
 int     geodb        = 0;                     /* Use GeoDB (0=no)         */
@@ -173,6 +181,7 @@
 int     geoip        = 0;                     /* Use GeoIP (0=no)         */
 char    *geoip_db    = NULL;                  /* GeoIP database filename  */
 GeoIP   *geo_fp      = NULL;                  /* GeoIP database handle    */
+char	geo_db_info[256];                     /* GeoIP database info      */
 #endif
 
 int     ntop_sites   = 30;                    /* top n sites to display   */
@@ -186,6 +195,8 @@
 int     ntop_ctrys   = 30;                    /* top n countries   ""     */
 int     ntop_search  = 20;                    /* top n search strings     */
 int     ntop_users   = 20;                    /* top n users to display   */
+int     ntop_notfound= 20;                    /* top n 404 to display     */
+int     narch_reports=  0;                    /* show n archive reports   */
 
 int     all_sites    = 0;                     /* List All sites (0=no)    */
 int     all_urls     = 0;                     /* List All URLs  (0=no)    */
@@ -193,6 +204,7 @@
 int     all_agents   = 0;                     /* List All User Agents     */
 int     all_search   = 0;                     /* List All Search Strings  */
 int     all_users    = 0;                     /* List All Usernames       */
+int     all_errors   = 1;                     /* List All 404 errors      */
 
 int     dump_sites   = 0;                     /* Dump tab delimited sites */
 int     dump_urls    = 0;                     /* URLs                     */
@@ -216,11 +228,15 @@
 int        gz_log=COMP_NONE;                  /* gziped log? (0=no)       */
 
 double     t_xfer=0.0;                        /* monthly total xfer value */
+double     t_ixfer=0.0;                       /* monthly total in xfer    */
+double     t_oxfer=0.0;                       /* monthly total out xfer   */
 u_int64_t  t_hit=0,t_file=0,t_site=0,         /* monthly total vars       */
            t_url=0,t_ref=0,t_agent=0,
            t_page=0, t_visit=0, t_user=0;
 
 double     tm_xfer[31];                       /* daily transfer totals    */
+double     tm_ixfer[31];                      /* daily in xfer totals     */
+double     tm_oxfer[31];                      /* daily out xfer totals    */
 
 u_int64_t  tm_hit[31], tm_file[31],           /* daily total arrays       */
            tm_site[31], tm_page[31],
@@ -234,6 +250,8 @@
            th_page[24];
 
 double     th_xfer[24];
+double     th_ixfer[24];
+double     th_oxfer[24];
 
 int        f_day,l_day;                       /* first/last day vars      */
 
@@ -263,17 +281,45 @@
 char    page_color[]  = "#00e0ff";            /* graph page color         */
 char    visit_color[] = "#ffff00";            /* graph visit color        */
 char    misc_color[]  = "#00e0ff";            /* graph misc color         */
+char    backgnd_color[]  = "#e8e8e8";         /* background color         */
+char    text_color[]     = "#000000";         /* text color               */
+char    link_color[]     = "#0000ff";         /* link color               */
+char    vlink_color[]    = "#ff0000";         /* vlink color              */
+char    alink_color[]    = "#ff0000";         /* alink color              */
+char    grp_color[]      = "#d0d0e0";         /* group color              */
+char    headline_color[] = "#c0c0c0";         /* headline color           */
+char    counter_color[]  = "#c0c0c0";         /* counter color            */
+char    chbg_color[]     = "#c0c0c0";         /* chart background color   */
+char    chlegend_color[] = "#000000";         /* chart legend color       */
+char    chshad_color1[]  = "#ffffff";         /* chart shadow color 1     */
+char    chshad_color2[]  = "#808080";         /* chart shadow color 2     */
 char    pie_color1[]  = "#800080";            /* pie additionnal color 1  */
 char    pie_color2[]  = "#80ffc0";            /* pie additionnal color 2  */
 char    pie_color3[]  = "#ff00ff";            /* pie additionnal color 3  */
 char    pie_color4[]  = "#ffc080";            /* pie additionnal color 4  */
 
+/* human readable size warp buffer */
+char    warpbuf[32][32];
+int     wb_index = -1;
+   
 /*********************************************/
 /* MAIN - start here                         */
 /*********************************************/
 
 int main(int argc, char *argv[])
 {
+   /* Alloc memory for the 404 errors with MAXRESP size */
+   void * tmp_ptr = calloc(MAXRESP, sizeof(struct response_url));
+   if (tmp_ptr) {
+      respnotfound = (struct response_url *) tmp_ptr;
+   } else {
+      fprintf(stderr, "ERROR: Can't allocate enough memory\n");
+      exit(0);
+   }
+   u_long maxresp = MAXRESP;             /* set constant for realloc    */
+   u_long z       = 0;                   /* set generic 404 counter     */
+   int flag       = 0;                   /* set flag for 404 counter    */
+   resp_counter   = 0;                   /* set total 404 counter       */
    int      i;                           /* generic counter             */
    char     *cp1, *cp2, *cp3;            /* generic char pointers       */
    char     host_buf[MAXHOST+1];         /* used to save hostname       */
@@ -469,9 +515,11 @@
    if (verbose>1)
    {
       uname(&system_info);
-      printf("Webalizer V%s-%s (%s %s %s) %s\n", version,editlvl,
-              system_info.sysname, system_info.release,
-              system_info.machine,language);
+      printf("Webalizer Xtended %s (%s) / %s %s %s / %s\n%s\n",
+              version_xt,moddate_xt,system_info.sysname,system_info.release,
+              system_info.machine,language,copyright_xt);
+      printf("Based on Webalizer V%s-%s\n",
+              version,editlvl);
    }
 
 #ifndef USE_DNS
@@ -633,6 +681,16 @@
       else if (verbose>1) printf("%s %s (%s)\n",msg_geo_use,
          GeoIPDBDescription[(int)geo_fp->databaseType],
          (geoip_db==NULL)?msg_geo_dflt:geo_fp->file_path);
+      
+      /* get database information */
+      if (geo_fp!=NULL)
+      {
+      	 cp1=GeoIP_database_info(geo_fp);
+      	 if (verbose>1) printf("%s\n", cp1);
+      	 memset(geo_db_info, 0, sizeof(geo_db_info));
+      	 strncpy(geo_db_info, cp1, sizeof(geo_db_info)-1);
+      	 free(cp1);
+      }
    }
 #endif /* USE_GEOIP */
 
@@ -663,6 +721,11 @@
          fprintf(stderr,"%s (%d)\n",msg_bad_data,i);
          exit(1);
       }
+      if (resp_counter>=MAXRESP) {
+         /* set maxresp to the # of entries in webalizer.current if there */
+         /* are more 404 error entries in it than predefined in MAXRESP   */
+         maxresp=resp_counter;
+      }
    }
 
    /* Allocate memory for our TOP countries array */
@@ -791,6 +854,14 @@
                   cur_year  = rec_year;
                   cur_tstamp= rec_tstamp;
                   f_day=l_day=rec_day;          /* reset first and last day */
+                  for (i=0;i<resp_counter;i++)
+                  {
+                     respnotfound[i].count=0;
+                     respnotfound[i].respurl[0]='\0';
+                  }
+                  z            = 0;        /* reset generic 404 counter     */
+                  flag         = 0;        /* reset flag for 404 counter    */
+                  resp_counter = 0;        /* reset total 404 counter       */
                }
             }
          }
@@ -1071,6 +1142,14 @@
             cur_month = rec_month;            /* update our flags        */
             cur_year  = rec_year;
             f_day=l_day=rec_day;
+            for (i=0;i<resp_counter;i++)
+            {
+               respnotfound[i].count=0;
+               respnotfound[i].respurl[0]='\0';
+            }
+            z            = 0;           /* reset generic 404 counter     */
+            flag         = 0;           /* reset flag for 404 counter    */
+            resp_counter = 0;           /* reset total 404 counter       */
          }
 
          /* save hostname for later */
@@ -1192,6 +1271,45 @@
          }
          response[i].count++;
 
+	 /* Check if response is a 404 error */
+	 if (log_rec.resp_code == RC_NOTFOUND) {
+            if (resp_counter > 0) {
+               for (z=0;z<resp_counter;z++) { /* 404 already exists? */
+                  if (strcmp(respnotfound[z].respurl,log_rec.url) == 0 ) {
+                     respnotfound[z].count++;
+                     flag = 1;     /* set flag for 404 counter */
+                     break;        /* we leave the routine     */
+                  }
+               }
+            }
+            if (flag != 1) { /* 404 does not exist yet */
+	       /* realloc the memory if necessary */
+               if (resp_counter>=maxresp) {
+                  maxresp+=INCRESP;
+                  void * new_ptr = realloc(respnotfound, 
+                        sizeof(struct response_url)*(maxresp));
+                  if (new_ptr) {
+                     respnotfound = (struct response_url *) new_ptr;
+                     strncpy(respnotfound[resp_counter].respurl,log_rec.url, 
+                           sizeof(respnotfound[resp_counter].respurl)-1);
+                     respnotfound[resp_counter].respurl[sizeof(respnotfound[resp_counter].respurl)-1]='\0';
+                     respnotfound[resp_counter].count=0;
+                     resp_counter+=1;
+                  } else {
+                     fprintf(stderr, "ERROR: Can't reallocate enough memory\n");
+                     exit(0);
+                  }
+               } else {
+                  strncpy(respnotfound[resp_counter].respurl,log_rec.url, 
+                        sizeof(respnotfound[resp_counter].respurl)-1);
+                  respnotfound[resp_counter].respurl[sizeof(respnotfound[resp_counter].respurl)-1]='\0';
+		  respnotfound[resp_counter].count=0;
+                  resp_counter+=1;
+               }
+            }
+            flag = 0;                  /* reset flag for 404 counter       */
+	 }
+
          /* now save in the various hash tables... */
          if (log_rec.resp_code==RC_OK || log_rec.resp_code==RC_PARTIALCONTENT)
             i=1; else i=0;
@@ -1202,7 +1320,8 @@
          {
             /* URL hash table */
             if (put_unode(log_rec.url,OBJ_REG,(u_int64_t)1,
-                log_rec.xfer_size,&t_url,(u_int64_t)0,(u_int64_t)0,um_htab))
+                log_rec.xfer_size,log_rec.ixfer_size,log_rec.oxfer_size,
+                &t_url,(u_int64_t)0,(u_int64_t)0,um_htab))
             {
                if (verbose)
                /* Error adding URL node, skipping ... */
@@ -1211,7 +1330,8 @@
 
             /* ident (username) hash table */
             if (put_inode(log_rec.ident,OBJ_REG,
-                1,(u_int64_t)i,log_rec.xfer_size,&t_user,
+                1,(u_int64_t)i,log_rec.xfer_size,
+                log_rec.ixfer_size,log_rec.oxfer_size,&t_user,
                 0,rec_tstamp,im_htab))
             {
                if (verbose)
@@ -1233,7 +1353,8 @@
 
          /* hostname (site) hash table - daily */
          if (put_hnode(log_rec.hostname,OBJ_REG,
-             1,(u_int64_t)i,log_rec.xfer_size,&dt_site,
+             1,(u_int64_t)i,log_rec.xfer_size,
+             log_rec.ixfer_size,log_rec.oxfer_size,&dt_site,
              0,rec_tstamp,"",sd_htab))
          {
             if (verbose)
@@ -1243,7 +1364,8 @@
 
          /* hostname (site) hash table - monthly */
          if (put_hnode(log_rec.hostname,OBJ_REG,
-             1,(u_int64_t)i,log_rec.xfer_size,&t_site,
+             1,(u_int64_t)i,log_rec.xfer_size,
+             log_rec.ixfer_size,log_rec.oxfer_size,&t_site,
              0,rec_tstamp,"",sm_htab))
          {
             if (verbose)
@@ -1265,9 +1387,15 @@
          /* bump monthly/daily/hourly totals        */
          t_hit++; ht_hit++;                         /* daily/hourly hits    */
          t_xfer += log_rec.xfer_size;               /* total xfer size      */
+         t_ixfer+= log_rec.ixfer_size;              /* total in xfer size   */
+         t_oxfer+= log_rec.oxfer_size;              /* total out xfer size  */
          tm_xfer[rec_day-1] += log_rec.xfer_size;   /* daily xfer total     */
+         tm_ixfer[rec_day-1]+= log_rec.ixfer_size;  /* daily in xfer total  */
+         tm_oxfer[rec_day-1]+= log_rec.oxfer_size;  /* daily out xfer total */
          tm_hit[rec_day-1]++;                       /* daily hits total     */
          th_xfer[rec_hour] += log_rec.xfer_size;    /* hourly xfer total    */
+         th_ixfer[rec_hour]+= log_rec.ixfer_size;   /* hourly in xfer total */
+         th_oxfer[rec_hour]+= log_rec.oxfer_size;   /* hourly out xfer total*/
          th_hit[rec_hour]++;                        /* hourly hits total    */
    
          /* if RC_OK, increase file counters */
@@ -1297,6 +1425,7 @@
          if ( (cp1=isinglist(group_urls,log_rec.url))!=NULL)
          {
             if (put_unode(cp1,OBJ_GRP,(u_int64_t)1,log_rec.xfer_size,
+            	log_rec.ixfer_size,log_rec.oxfer_size,
                 &ul_bogus,(u_int64_t)0,(u_int64_t)0,um_htab))
             {
                if (verbose)
@@ -1310,7 +1439,8 @@
          {
             if (put_hnode(cp1,OBJ_GRP,1,
                           (u_int64_t)(log_rec.resp_code==RC_OK)?1:0,
-                          log_rec.xfer_size,&ul_bogus,
+                          log_rec.xfer_size,
+                          log_rec.ixfer_size,log_rec.oxfer_size,&ul_bogus,
                           0,rec_tstamp,"",sm_htab))
             {
                if (verbose)
@@ -1328,8 +1458,8 @@
                {
                   if (put_hnode(cp1,OBJ_GRP,1,
                       (u_int64_t)(log_rec.resp_code==RC_OK)?1:0,
-                      log_rec.xfer_size,&ul_bogus,
-                      0,rec_tstamp,"",sm_htab))
+                      log_rec.xfer_size,log_rec.ixfer_size,log_rec.oxfer_size,
+                      &ul_bogus,0,rec_tstamp,"",sm_htab))
                   {
                      if (verbose)
                      /* Error adding Site node, skipping ... */
@@ -1366,7 +1496,8 @@
          {
             if (put_inode(cp1,OBJ_GRP,1,
                           (u_int64_t)(log_rec.resp_code==RC_OK)?1:0,
-                          log_rec.xfer_size,&ul_bogus,
+                          log_rec.xfer_size,
+                          log_rec.ixfer_size,log_rec.oxfer_size,&ul_bogus,
                           0,rec_tstamp,im_htab))
             {
                if (verbose)
@@ -1628,7 +1759,26 @@
                      "YearTotals",        /* show year subtotals (0=no) 117 */
                      "CountryFlags",      /* show country flags? (0-no) 118 */
                      "FlagDir",           /* directory w/flag images    119 */
-                     "SearchCaseI"        /* srch str case insensitive  120 */
+                     "SearchCaseI",       /* srch str case insensitive  120 */
+                     "CodeNotFound",      /* Top 404 errors             121 */
+                     "AllErrors",         /* List all 404 errors?       122 */
+                     "TableBorder",       /* Size of the table border   123 */
+                     "ChartBorder",       /* Size of the chart border   124 */
+                     "ResponseGraph",     /* Display resp graph (0=no)  125 */
+                     "ColorBackground",   /* Backgnd Col. (def=e8e8e8)  126 */
+                     "ColorText",         /* Text Color   (def=000000)  127 */
+                     "ColorLink",         /* Link Color   (def=0000ff)  128 */
+                     "ColorVLink",        /* VLink Color  (def=ff0000)  129 */
+                     "ColorALink",        /* ALink Color  (def=ff0000)  130 */
+                     "ColorGrp",          /* Grp Color    (def=d0d0e0)  131 */
+                     "ColorHeadline",     /* Headline Col.(def=c0c0c0)  132 */
+                     "ColorCounter",      /* Counter Col. (def=c0c0c0)  133 */
+                     "ChartBackgroundColor",/* Chart Bg.  (def=c0c0c0)  134 */
+		     "ChartLegendColor",  /* Chart Legend (def=000000)  135  */
+                     "ChartShadowColor1", /* Chart Shad 1 (def=ffffff)  136  */
+                     "ChartShadowColor2", /* Chart Shad 2 (def=808080)  137  */
+                     "HideInOutVolume",   /* In/out volume (yes/no)     138  */
+		     "ArchiveReports"     /* Number of archived reports 139 */
                    };
 
    FILE *fp;
@@ -1863,6 +2013,27 @@
         case 119: use_flags=1; flag_dir=save_opt(value); break; /* FlagDir  */
         case 120: searchcasei=
                     (tolower(value[0])=='n')?0:1;  break; /* SearchCaseI    */
+        case 121: ntop_notfound=atoi(value);       break; /* Top 404 errors */
+        case 122: all_errors=(value[0]=='y')?1:0;  break; /* All 404 errors */
+        case 123: table_border=(atoi(value)<0 ||
+                  atoi(value)>5)?1:atoi(value);    break; /* TableBorder    */
+        case 124: chart_border=(atoi(value)<0 ||
+                  atoi(value)>5)?1:atoi(value);    break; /* ChartBorder    */
+        case 125: response_graph=(value[0]=='y')?1:0;break;/* ResponseGraph */
+        case 126: strncpy(backgnd_color+1,value,6); break; /* ColorBackground*/
+        case 127: strncpy(text_color+1,value,6);    break; /* ColorText      */
+        case 128: strncpy(link_color+1,value,6);    break; /* ColorLink      */
+        case 129: strncpy(vlink_color+1,value,6);   break; /* ColorVLink     */
+        case 130: strncpy(alink_color+1,value,6);   break; /* ColorALink     */
+        case 131: strncpy(grp_color+1,value,6);     break; /* ColorGrp       */
+        case 132: strncpy(headline_color+1,value,6);break; /* ColorHeadline  */
+        case 133: strncpy(counter_color+1,value,6); break; /* ColorCounter   */
+        case 134: strncpy(chbg_color+1,value,6);    break; /* ChartBac..Color*/
+        case 135: strncpy(chlegend_color+1,value,6);break; /* ChartLeg..Color*/
+        case 136: strncpy(chshad_color1 +1,value,6);break; /* ChartSh..Color1*/
+        case 137: strncpy(chshad_color2 +1,value,6);break; /* ChartSh..Color2*/
+        case 138: hide_iovol=(value[0]=='y')?1:0;   break; /* Hide In/Out Vol*/
+        case 139: narch_reports=atoi(value);        break; /* Archive reports*/
       }
    }
    fclose(fp);
@@ -1905,22 +2076,22 @@
    for (i=0;i<TOTAL_RC;i++) response[i].count = 0;
    for (i=0;i<31;i++)  /* monthly totals      */
    {
-    tm_xfer[i]=0.0;
+    tm_xfer[i]=tm_ixfer[i]=tm_oxfer[i]=0.0;
     tm_hit[i]=tm_file[i]=tm_site[i]=tm_page[i]=tm_visit[i]=0;
    }
    for (i=0;i<24;i++)  /* hourly totals       */
    {
       th_hit[i]=th_file[i]=th_page[i]=0;
-      th_xfer[i]=0.0;
+      th_xfer[i]=th_ixfer[i]=th_oxfer[i]=0.0;
    }
    for (i=0;ctry[i].desc;i++) /* country totals */
    {
       ctry[i].count=0;
       ctry[i].files=0;
-      ctry[i].xfer=0;
+      ctry[i].xfer=ctry[i].ixfer=ctry[i].oxfer=0;
    }
    t_hit=t_file=t_site=t_url=t_ref=t_agent=t_page=t_visit=t_user=0;
-   t_xfer=0.0;
+   t_xfer=t_ixfer=t_oxfer=0.0;
    mh_hit = dt_site = 0;
    f_day=l_day=1;
 }
@@ -1947,10 +2118,11 @@
    char buf[128]="";
    uname(&system_info);
 
-   printf("Webalizer V%s-%s (%s %s %s) %s\n%s\n",
-      version,editlvl,
-      system_info.sysname,system_info.release,system_info.machine,
-      language,copyright);
+   printf("Webalizer Xtended %s (%s) / %s %s %s / %s\n%s\n",
+           version_xt,moddate_xt,system_info.sysname,system_info.release,
+           system_info.machine,language,copyright_xt);
+   printf("Based on Webalizer V%s-%s\n",
+           version,editlvl);
 
 #ifdef USE_DNS
    strncpy(&buf[strlen(buf)],"DNS/GeoDB ",11);
@@ -2477,3 +2649,32 @@
 
    return(days+5);
 }
+
+/*********************************************/
+/* HR_SIZE - Returns a human readable size   */
+/*********************************************/
+
+const char *hr_size(unsigned long long int size)
+{
+   int base=1024;
+   char suffixes[]="??KBMBGBTBPBEB";
+   float n=size;
+   int usesuf=0;
+
+   if (wb_index<0 || wb_index>31)
+      wb_index=0;
+
+   while (n>=base && usesuf<=10)
+   {
+      n/=base;
+      usesuf+=2;
+   }
+
+   if (usesuf)
+      snprintf(warpbuf[wb_index], 31, \
+               "%.2f&nbsp;%c%c", n, suffixes[usesuf], suffixes[usesuf+1]);
+   else
+      snprintf(warpbuf[wb_index], 31, "%d&nbsp;bytes", (unsigned int) size);
+
+   return warpbuf[wb_index++];
+}
diff -Naur webalizer-2.23-05//webalizer.h webalizer-2.23-05-RB29//webalizer.h
--- webalizer-2.23-05//webalizer.h	2010-10-09 10:06:40.000000000 +0200
+++ webalizer-2.23-05-RB29//webalizer.h	2011-04-19 18:37:55.000000000 +0200
@@ -12,16 +12,18 @@
 #define MAX(a,b) ((a) > (b) ? (a) : (b))
 #endif
 
+#define MAXRESP  1000                  /* Max 404-Not-Found field size     */
+#define INCRESP  1000                  /* Size to increment MAXRESP        */
 #define MAXHASH  4096                  /* Size of our hash tables          */
 #define BUFSIZE  4096                  /* Max buffer size for log record   */
 #define MAXHOST  128                   /* Max hostname buffer size         */
 #define MAXURL   4096                  /* Max HTTP request/URL field size  */
 #define MAXURLH  512                   /* Max URL field size in htab       */
-#define MAXREF   1024                  /* Max referrer field size          */
-#define MAXREFH  256                   /* Max referrer field size in htab  */
-#define MAXAGENT 128                   /* Max user agent field size        */
+#define MAXREF   2048                  /* Max referrer field size          */
+#define MAXREFH  512                   /* Max referrer field size in htab  */
+#define MAXAGENT 512                   /* Max user agent field size        */
 #define MAXCTRY  48                    /* Max country name size            */
-#define MAXSRCH  256                   /* Max size of search string buffer */
+#define MAXSRCH  512                   /* Max size of search string buffer */
 #define MAXSRCHH 128                   /* Max size of search str in htab   */
 #define MAXIDENT 64                    /* Max size of ident string (user)  */
 #define MAXKWORD 32                    /* Max size of config keyword       */
@@ -139,12 +141,23 @@
 struct response_code {     char    *desc;         /* code description     */
                       u_int64_t    count; };      /* hit counter          */
 
+/* Response URL structure */
+struct response_url { char respurl[MAXURLH];       /* resp url struct       */
+			u_long    count; };
+struct response_url * respnotfound;
+struct responsetmp_url { char respurl[MAXURLH];    /* temp resp url struct  */
+			u_long    count; };
+struct responsetmp_url * respnotfoundtmp;
+u_long resp_counter;                               /* total 404 counter     */
+
 /* Country code structure */
 struct	country_code {u_int64_t idx;              /* TLD index number     */
                            char *desc;            /* TLD description      */
                       u_int64_t count;            /* hit counter          */
                       u_int64_t files;            /* file counter         */
-                         double xfer; };          /* xfer amt counter     */
+                         double xfer;             /* xfer amt counter     */
+                         double ixfer;            /* ixfer amt counter    */
+                         double oxfer; };         /* oxfer amt counter    */
 
 typedef struct country_code *CLISTPTR;
 
@@ -154,6 +167,8 @@
                        char   url[MAXURL];        /* raw request field    */
                         int   resp_code;          /* response code        */
                   u_int64_t   xfer_size;          /* xfer size in bytes   */
+                  u_int64_t   ixfer_size;         /* ixfer size in bytes  */
+                  u_int64_t   oxfer_size;         /* oxfer size in bytes  */
                        char   refer[MAXREF];      /* referrer             */
                        char   agent[MAXAGENT];    /* user agent (browser) */
                        char   srchstr[MAXSRCH];   /* search string        */
@@ -165,6 +180,9 @@
 extern char    *editlvl     ;                 /* edit level               */
 extern char    *moddate     ;                 /* modification date        */
 extern char    *copyright   ;
+extern char    *version_xt  ;                 /* program version (XT)     */
+extern char    *moddate_xt  ;                 /* modification date (XT)   */
+extern char    *copyright_xt;                 /* copyright (XT)           */
 
 extern int     verbose      ;                 /* 2=verbose,1=err, 0=none  */ 
 extern int     debug_mode   ;                 /* debug mode flag          */
@@ -191,6 +209,7 @@
 extern int     log_type     ;                 /* (0=clf, 1=ftp, 2=squid)  */
 extern int     group_domains;                 /* Group domains 0=none     */
 extern int     hide_sites   ;                 /* Hide ind. sites (0=no)   */
+extern int     hide_iovol   ;                 /* Hide In/Out volume (0=no)*/
 extern int     graph_mths   ;                 /* # months in index graph  */
 extern int     index_mths   ;                 /* # months in index table  */
 extern int     year_hdrs    ;                 /* Show year headers (0=no) */
@@ -209,6 +228,8 @@
 extern char    *dns_cache   ;                 /* DNS cache file name      */
 extern int     geodb        ;                 /* Use GeoDB flag (0=no)    */
 extern int     dns_children ;                 /* # of DNS children        */
+extern int     table_border ;                 /* table border (0-5)       */
+extern int     chart_border ;                 /* chart border (0-5)       */
 extern int     cache_ips    ;                 /* Cache IP addrs (0=no)    */
 extern int     cache_ttl    ;                 /* Cache entry TTL (days)   */
 extern int     link_referrer;                 /* link referrer (0=no)     */
@@ -226,6 +247,8 @@
 extern int     ntop_ctrys   ;                 /* top n countries   ""     */
 extern int     ntop_search  ;                 /* top n search strings     */
 extern int     ntop_users   ;                 /* top n users to display   */
+extern int     ntop_notfound;                 /* top n 404 to display     */
+extern int     narch_reports;                 /* show n archived reports  */
 
 extern int     all_sites    ;                 /* List All sites (0=no)    */
 extern int     all_urls     ;                 /* List All URLs  (0=no)    */
@@ -233,6 +256,7 @@
 extern int     all_agents   ;                 /* List All User Agents     */
 extern int     all_search   ;                 /* List All Search Strings  */
 extern int     all_users    ;                 /* List All Usernames       */
+extern int     all_errors   ;                 /* List All 404 errors      */
 
 extern int     dump_sites   ;                 /* Dump tab delimited sites */
 extern int     dump_urls    ;                 /* URLs                     */
@@ -252,11 +276,15 @@
                  cur_min, cur_sec;
 
 extern double    t_xfer;                      /* monthly total xfer value */
+extern double    t_ixfer;                     /* monthly total in xfer    */
+extern double    t_oxfer;                     /* monthly total out xfer   */
 extern u_int64_t t_hit, t_file, t_site,       /* monthly total vars       */
                  t_url, t_ref,  t_agent,
                  t_page,t_visit,t_user;
 
 extern double    tm_xfer[31];                 /* daily transfer totals    */
+extern double    tm_ixfer[31];                /* daily in xfer totals     */
+extern double    tm_oxfer[31];                /* daily out xfer totals    */
 
 extern u_int64_t tm_hit[31], tm_file[31],     /* daily total arrays       */
                  tm_site[31],tm_page[31],
@@ -270,6 +298,8 @@
                  th_page[24];
 
 extern double    th_xfer[24];                 /* hourly xfer array        */
+extern double    th_ixfer[24];                /* hourly ixfer array       */
+extern double    th_oxfer[24];                /* hourly oxfer array       */
 
 extern int       f_day,l_day;                 /* first/last day vars      */
 extern int       gz_log;                      /* flag for zipped log      */
@@ -283,6 +313,18 @@
 extern char    page_color[];                  /* graph page color         */
 extern char    visit_color[];                 /* graph visit color        */
 extern char    misc_color[];                  /* graph misc color         */
+extern char    backgnd_color[];               /* background color         */
+extern char    text_color[];                  /* text color               */
+extern char    link_color[];                  /* link color               */
+extern char    vlink_color[];                 /* vlink color              */
+extern char    alink_color[];                 /* alink color              */
+extern char    grp_color[];                   /* group color              */
+extern char    headline_color[];              /* headline color           */
+extern char    counter_color[];               /* counter color            */
+extern char    chbg_color[];                  /* chart background color   */
+extern char    chlegend_color[];              /* chart legend color       */
+extern char    chshad_color1[];               /* chart shadow color 1     */
+extern char    chshad_color2[];               /* chart shadow color 2     */
 extern char    pie_color1[];                  /* pie additionnal color 1  */
 extern char    pie_color2[];                  /* pie additionnal color 2  */
 extern char    pie_color3[];                  /* pie additionnal color 3  */
@@ -298,5 +340,6 @@
 extern u_int64_t jdate(int,int,int);
 extern char      from_hex(char);
 extern int       isipaddr(char *);
+extern const char *hr_size(unsigned long long int size);
 
 #endif  /* _WEBALIZER_H */
